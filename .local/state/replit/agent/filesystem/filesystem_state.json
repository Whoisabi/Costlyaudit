{"file_contents":{"client/src/pages/Landing.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { BarChart3, Cloud, DollarSign, ShieldCheck } from \"lucide-react\";\n\nexport default function Landing() {\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <div className=\"container mx-auto px-6 py-12\">\n        <div className=\"flex flex-col items-center text-center space-y-8\">\n          <div className=\"space-y-4\">\n            <h1 className=\"text-5xl font-semibold text-foreground\">\n              CostlyAgent\n            </h1>\n            <p className=\"text-xl text-muted-foreground max-w-2xl\">\n              Analyze and optimize your AWS infrastructure costs with\n              AI-powered insights using Steampipe and Powerpipe\n            </p>\n          </div>\n\n          <div className=\"flex flex-wrap gap-4 items-center justify-center\">\n            <Button\n              size=\"lg\"\n              onClick={() => (window.location.href = \"/login\")}\n              data-testid=\"button-login\"\n              className=\"text-lg px-8\"\n            >\n              Log In\n            </Button>\n            <Button\n              size=\"lg\"\n              variant=\"outline\"\n              onClick={() => (window.location.href = \"/signup\")}\n              data-testid=\"button-signup\"\n              className=\"text-lg px-8\"\n            >\n              Sign Up\n            </Button>\n          </div>\n\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mt-12 w-full\">\n            <Card>\n              <CardHeader className=\"space-y-2 pb-4\">\n                <div className=\"flex items-center justify-between\">\n                  <CardTitle className=\"text-lg\">Cost Analysis</CardTitle>\n                  <DollarSign className=\"h-5 w-5 text-primary\" />\n                </div>\n              </CardHeader>\n              <CardContent>\n                <CardDescription>\n                  Identify potential savings across 15 benchmarks and 41 cost controls\n                </CardDescription>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader className=\"space-y-2 pb-4\">\n                <div className=\"flex items-center justify-between\">\n                  <CardTitle className=\"text-lg\">Multi-Account</CardTitle>\n                  <Cloud className=\"h-5 w-5 text-primary\" />\n                </div>\n              </CardHeader>\n              <CardContent>\n                <CardDescription>\n                  Manage and analyze multiple AWS accounts from a single dashboard\n                </CardDescription>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader className=\"space-y-2 pb-4\">\n                <div className=\"flex items-center justify-between\">\n                  <CardTitle className=\"text-lg\">Visual Insights</CardTitle>\n                  <BarChart3 className=\"h-5 w-5 text-primary\" />\n                </div>\n              </CardHeader>\n              <CardContent>\n                <CardDescription>\n                  Interactive charts and dashboards for clear cost visualization\n                </CardDescription>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader className=\"space-y-2 pb-4\">\n                <div className=\"flex items-center justify-between\">\n                  <CardTitle className=\"text-lg\">Secure</CardTitle>\n                  <ShieldCheck className=\"h-5 w-5 text-primary\" />\n                </div>\n              </CardHeader>\n              <CardContent>\n                <CardDescription>\n                  Enterprise-grade security with encrypted credential storage\n                </CardDescription>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":3848},"client/src/pages/AwsAccounts.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Plus, Trash2, Edit, Eye, EyeOff } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Input } from \"@/components/ui/input\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport type { AwsAccount } from \"@shared/schema\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { isUnauthorizedError } from \"@/lib/authUtils\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\n\nconst awsRegions = [\n  \"us-east-1\",\n  \"us-east-2\",\n  \"us-west-1\",\n  \"us-west-2\",\n  \"eu-west-1\",\n  \"eu-central-1\",\n  \"ap-southeast-1\",\n  \"ap-northeast-1\",\n];\n\nconst accountFormSchema = z.object({\n  nickname: z.string().min(1, \"Nickname is required\"),\n  accessKeyId: z.string().min(1, \"Access Key ID is required\"),\n  secretAccessKey: z.string().min(1, \"Secret Access Key is required\"),\n  region: z.string().min(1, \"Region is required\"),\n});\n\ntype AccountFormValues = z.infer<typeof accountFormSchema>;\n\nexport default function AwsAccounts() {\n  const { toast } = useToast();\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [editingAccount, setEditingAccount] = useState<AwsAccount | null>(null);\n  const [showSecrets, setShowSecrets] = useState<Record<string, boolean>>({});\n\n  const { data: accounts, isLoading } = useQuery<AwsAccount[]>({\n    queryKey: [\"/api/aws-accounts\"],\n  });\n\n  const form = useForm<AccountFormValues>({\n    resolver: zodResolver(accountFormSchema),\n    defaultValues: {\n      nickname: \"\",\n      accessKeyId: \"\",\n      secretAccessKey: \"\",\n      region: \"us-east-1\",\n    },\n  });\n\n  const createMutation = useMutation({\n    mutationFn: async (data: AccountFormValues) => {\n      await apiRequest(\"POST\", \"/api/aws-accounts\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/aws-accounts\"] });\n      toast({\n        title: \"Success\",\n        description: \"AWS account added successfully\",\n      });\n      setIsDialogOpen(false);\n      form.reset();\n    },\n    onError: (error: Error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/api/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: \"Error\",\n        description: \"Failed to add AWS account\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: async (id: string) => {\n      await apiRequest(\"DELETE\", `/api/aws-accounts/${id}`, {});\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/aws-accounts\"] });\n      toast({\n        title: \"Success\",\n        description: \"AWS account deleted successfully\",\n      });\n    },\n    onError: (error: Error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/api/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: \"Error\",\n        description: \"Failed to delete AWS account\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleSubmit = (data: AccountFormValues) => {\n    createMutation.mutate(data);\n  };\n\n  const handleDelete = (id: string) => {\n    if (confirm(\"Are you sure you want to delete this AWS account?\")) {\n      deleteMutation.mutate(id);\n    }\n  };\n\n  const toggleSecretVisibility = (id: string) => {\n    setShowSecrets((prev) => ({ ...prev, [id]: !prev[id] }));\n  };\n\n  const maskAccessKey = (key: string) => {\n    if (!key) return \"\";\n    return `${key.slice(0, 4)}${\"*\".repeat(key.length - 8)}${key.slice(-4)}`;\n  };\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-semibold\">Connected AWS Accounts</h1>\n          <p className=\"text-sm text-muted-foreground mt-2\">\n            Manage your AWS credentials for cost optimization analysis\n          </p>\n        </div>\n        <Button\n          onClick={() => setIsDialogOpen(true)}\n          data-testid=\"button-add-account\"\n        >\n          <Plus className=\"h-4 w-4 mr-2\" />\n          Add Account\n        </Button>\n      </div>\n\n      {isLoading ? (\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n          {[1, 2].map((i) => (\n            <Card key={i}>\n              <CardHeader className=\"space-y-2\">\n                <Skeleton className=\"h-6 w-40\" />\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <Skeleton className=\"h-4 w-full\" />\n                <Skeleton className=\"h-4 w-3/4\" />\n                <Skeleton className=\"h-4 w-1/2\" />\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n      ) : !accounts || accounts.length === 0 ? (\n        <Card>\n          <CardContent className=\"flex flex-col items-center justify-center py-12\">\n            <p className=\"text-muted-foreground text-center\">\n              No AWS accounts connected yet. Add your first account to get started.\n            </p>\n          </CardContent>\n        </Card>\n      ) : (\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n          {accounts.map((account) => (\n            <Card key={account.id} className=\"hover-elevate\">\n              <CardHeader className=\"flex flex-row items-center justify-between gap-4 space-y-0 pb-4\">\n                <CardTitle className=\"text-lg\">{account.nickname}</CardTitle>\n                <div className=\"flex items-center gap-2\">\n                  <Badge variant={account.isActive ? \"default\" : \"secondary\"} data-testid={`badge-status-${account.id}`}>\n                    {account.isActive ? \"Active\" : \"Inactive\"}\n                  </Badge>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"icon\"\n                    onClick={() => handleDelete(account.id)}\n                    data-testid={`button-delete-${account.id}`}\n                  >\n                    <Trash2 className=\"h-4 w-4 text-destructive\" />\n                  </Button>\n                </div>\n              </CardHeader>\n              <CardContent className=\"space-y-3\">\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-sm text-muted-foreground\">Access Key ID:</span>\n                  <div className=\"flex items-center gap-2\">\n                    <span className=\"text-sm font-mono\" data-testid={`text-access-key-${account.id}`}>\n                      {showSecrets[account.id]\n                        ? account.accessKeyId\n                        : maskAccessKey(account.accessKeyId)}\n                    </span>\n                    <Button\n                      variant=\"ghost\"\n                      size=\"icon\"\n                      onClick={() => toggleSecretVisibility(account.id)}\n                      className=\"h-6 w-6\"\n                      data-testid={`button-toggle-secret-${account.id}`}\n                    >\n                      {showSecrets[account.id] ? (\n                        <EyeOff className=\"h-3 w-3\" />\n                      ) : (\n                        <Eye className=\"h-3 w-3\" />\n                      )}\n                    </Button>\n                  </div>\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-sm text-muted-foreground\">Region:</span>\n                  <span className=\"text-sm\" data-testid={`text-region-${account.id}`}>{account.region}</span>\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-sm text-muted-foreground\">Added:</span>\n                  <span className=\"text-sm\">\n                    {new Date(account.createdAt!).toLocaleDateString()}\n                  </span>\n                </div>\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n      )}\n\n      <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\n        <DialogContent data-testid=\"dialog-add-account\">\n          <DialogHeader>\n            <DialogTitle>Add AWS Account</DialogTitle>\n            <DialogDescription>\n              Enter your AWS credentials to connect a new account\n            </DialogDescription>\n          </DialogHeader>\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(handleSubmit)} className=\"space-y-4\">\n              <FormField\n                control={form.control}\n                name=\"nickname\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Account Nickname</FormLabel>\n                    <FormControl>\n                      <Input\n                        placeholder=\"Production Account\"\n                        {...field}\n                        data-testid=\"input-nickname\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <FormField\n                control={form.control}\n                name=\"accessKeyId\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Access Key ID</FormLabel>\n                    <FormControl>\n                      <Input\n                        placeholder=\"AKIAIOSFODNN7EXAMPLE\"\n                        {...field}\n                        data-testid=\"input-access-key-id\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <FormField\n                control={form.control}\n                name=\"secretAccessKey\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Secret Access Key</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"password\"\n                        placeholder=\"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"\n                        {...field}\n                        data-testid=\"input-secret-access-key\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <FormField\n                control={form.control}\n                name=\"region\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Default Region</FormLabel>\n                    <Select onValueChange={field.onChange} defaultValue={field.value}>\n                      <FormControl>\n                        <SelectTrigger data-testid=\"select-region\">\n                          <SelectValue placeholder=\"Select a region\" />\n                        </SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        {awsRegions.map((region) => (\n                          <SelectItem key={region} value={region}>\n                            {region}\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <DialogFooter>\n                <Button\n                  type=\"button\"\n                  variant=\"outline\"\n                  onClick={() => setIsDialogOpen(false)}\n                  data-testid=\"button-cancel\"\n                >\n                  Cancel\n                </Button>\n                <Button type=\"submit\" disabled={createMutation.isPending} data-testid=\"button-submit\">\n                  {createMutation.isPending ? \"Adding...\" : \"Add Account\"}\n                </Button>\n              </DialogFooter>\n            </form>\n          </Form>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","size_bytes":12812},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","size_bytes":1467},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\" +\n  \" hover-elevate active-elevate-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"bg-primary text-primary-foreground border border-primary-border\",\n        destructive:\n          \"bg-destructive text-destructive-foreground border border-destructive-border\",\n        outline:\n          // Shows the background color of whatever card / sidebar / accent background it is inside of.\n          // Inherits the current text color.\n          \" border [border-color:var(--button-outline)]  shadow-xs active:shadow-none \",\n        secondary: \"border bg-secondary text-secondary-foreground border border-secondary-border \",\n        // Add a transparent border so that when someone toggles a border on later, it doesn't shift layout/size.\n        ghost: \"border border-transparent\",\n      },\n      // Heights are set as \"min\" heights, because sometimes Ai will place large amount of content\n      // inside buttons. With a min-height they will look appropriate with small amounts of content,\n      // but will expand to fit large amounts of content.\n      size: {\n        default: \"min-h-9 px-4 py-2\",\n        sm: \"min-h-8 rounded-md px-3 text-xs\",\n        lg: \"min-h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  },\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  },\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","size_bytes":2359},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","size_bytes":166},"client/src/components/ThemeToggle.tsx":{"content":"import { Moon, Sun } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { useTheme } from \"@/contexts/ThemeContext\";\n\nexport function ThemeToggle() {\n  const { theme, toggleTheme } = useTheme();\n\n  return (\n    <Button\n      variant=\"ghost\"\n      size=\"icon\"\n      onClick={toggleTheme}\n      data-testid=\"button-theme-toggle\"\n    >\n      {theme === \"light\" ? (\n        <Moon className=\"h-5 w-5\" />\n      ) : (\n        <Sun className=\"h-5 w-5\" />\n      )}\n    </Button>\n  );\n}\n","size_bytes":503},"server/vite.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport async function setupVite(app: Express, server: Server) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(import.meta.dirname, \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","size_bytes":2263},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","size_bytes":329},"client/src/lib/authUtils.ts":{"content":"export function isUnauthorizedError(error: Error): boolean {\n  return /^401: .*Unauthorized/.test(error.message);\n}\n","size_bytes":116},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","size_bytes":1584},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","size_bytes":6210},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","size_bytes":2751},"client/src/pages/Dashboard.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Label } from \"@/components/ui/label\";\nimport { DollarSign, AlertTriangle, CheckCircle, XCircle } from \"lucide-react\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport CostSummary from \"@/components/CostSummary\";\nimport CostForecast from \"@/components/CostForecast\";\nimport { AllServicesCosts } from \"@/components/AllServicesCosts\";\nimport { CostRecommendationsPanel } from \"@/components/CostRecommendations\";\nimport {\n  BarChart,\n  Bar,\n  XAxis,\n  YAxis,\n  CartesianGrid,\n  Tooltip,\n  ResponsiveContainer,\n  PieChart,\n  Pie,\n  Cell,\n  Legend,\n} from \"recharts\";\n\ninterface DashboardStats {\n  totalSavings: number;\n  highRiskResources: number;\n  failedControls: number;\n  passedControls: number;\n  savingsByService: { service: string; savings: number }[];\n  controlsByBenchmark: { benchmark: string; passed: number; failed: number }[];\n}\n\nconst COLORS = [\n  \"hsl(var(--chart-1))\",\n  \"hsl(var(--chart-2))\",\n  \"hsl(var(--chart-3))\",\n  \"hsl(var(--chart-4))\",\n  \"hsl(var(--chart-5))\",\n];\n\nexport default function Dashboard() {\n  const [includeCredits, setIncludeCredits] = useState(true);\n\n  const { data: stats, isLoading } = useQuery<DashboardStats>({\n    queryKey: [\"/api/dashboard/stats\"],\n  });\n\n  if (isLoading) {\n    return (\n      <div className=\"p-6 space-y-6\">\n        <div>\n          <h1 className=\"text-3xl font-semibold\">Dashboard</h1>\n          <p className=\"text-sm text-muted-foreground mt-2\">\n            Overview of your AWS cost optimization opportunities\n          </p>\n        </div>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n          {[1, 2, 3, 4].map((i) => (\n            <Card key={i}>\n              <CardHeader className=\"space-y-2 pb-4\">\n                <Skeleton className=\"h-4 w-24\" />\n              </CardHeader>\n              <CardContent>\n                <Skeleton className=\"h-10 w-32\" />\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  const formatCurrency = (cents: number) => {\n    return `$${(cents / 100).toFixed(2)}`;\n  };\n\n  return (\n    <div className=\"p-6 space-y-8\">\n      <div className=\"flex flex-wrap items-center justify-between gap-4\">\n        <div>\n          <h1 className=\"text-3xl font-semibold\">Dashboard</h1>\n          <p className=\"text-sm text-muted-foreground mt-2\">\n            Overview of your AWS cost optimization opportunities\n          </p>\n        </div>\n        <div className=\"flex items-center gap-2\">\n          <Switch\n            id=\"global-credits-toggle\"\n            checked={includeCredits}\n            onCheckedChange={setIncludeCredits}\n            data-testid=\"switch-global-credits\"\n          />\n          <Label htmlFor=\"global-credits-toggle\" className=\"text-sm cursor-pointer\">\n            {includeCredits ? 'With Credits' : 'Without Credits'}\n          </Label>\n        </div>\n      </div>\n\n      {/* AWS Cost Comparison and Forecast */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        <CostSummary \n          includeCredits={includeCredits}\n          onIncludeCreditsChange={setIncludeCredits}\n          showToggle={false}\n        />\n        <CostForecast includeCredits={includeCredits} />\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-4 space-y-0 pb-4\">\n            <CardTitle className=\"text-sm font-medium\">Total Potential Savings</CardTitle>\n            <DollarSign className=\"h-5 w-5 text-primary\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-4xl font-bold\" data-testid=\"text-total-savings\">\n              {formatCurrency(stats?.totalSavings || 0)}\n            </div>\n            <p className=\"text-xs text-muted-foreground mt-1\">per month</p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-4 space-y-0 pb-4\">\n            <CardTitle className=\"text-sm font-medium\">High Risk Resources</CardTitle>\n            <AlertTriangle className=\"h-5 w-5 text-destructive\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-4xl font-bold\" data-testid=\"text-high-risk\">\n              {stats?.highRiskResources || 0}\n            </div>\n            <p className=\"text-xs text-muted-foreground mt-1\">requiring attention</p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-4 space-y-0 pb-4\">\n            <CardTitle className=\"text-sm font-medium\">Failed Controls</CardTitle>\n            <XCircle className=\"h-5 w-5 text-destructive\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-4xl font-bold\" data-testid=\"text-failed-controls\">\n              {stats?.failedControls || 0}\n            </div>\n            <p className=\"text-xs text-muted-foreground mt-1\">out of {(stats?.failedControls || 0) + (stats?.passedControls || 0)}</p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-4 space-y-0 pb-4\">\n            <CardTitle className=\"text-sm font-medium\">Passed Controls</CardTitle>\n            <CheckCircle className=\"h-5 w-5 text-primary\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-4xl font-bold\" data-testid=\"text-passed-controls\">\n              {stats?.passedControls || 0}\n            </div>\n            <p className=\"text-xs text-muted-foreground mt-1\">compliant checks</p>\n          </CardContent>\n        </Card>\n      </div>\n\n      {stats?.savingsByService && stats.savingsByService.length > 0 && (\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n          <Card>\n            <CardHeader>\n              <CardTitle>Savings by Service</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <ResponsiveContainer width=\"100%\" height={300}>\n                <PieChart>\n                  <Pie\n                    data={stats.savingsByService}\n                    cx=\"50%\"\n                    cy=\"50%\"\n                    labelLine={false}\n                    label={({ service, savings }) =>\n                      `${service}: ${formatCurrency(savings)}`\n                    }\n                    outerRadius={80}\n                    fill=\"#8884d8\"\n                    dataKey=\"savings\"\n                  >\n                    {stats.savingsByService.map((entry, index) => (\n                      <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />\n                    ))}\n                  </Pie>\n                  <Tooltip formatter={(value: number) => formatCurrency(value)} />\n                  <Legend />\n                </PieChart>\n              </ResponsiveContainer>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader>\n              <CardTitle>Controls by Benchmark</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <ResponsiveContainer width=\"100%\" height={300}>\n                <BarChart data={stats.controlsByBenchmark}>\n                  <CartesianGrid strokeDasharray=\"3 3\" />\n                  <XAxis dataKey=\"benchmark\" />\n                  <YAxis />\n                  <Tooltip />\n                  <Legend />\n                  <Bar dataKey=\"passed\" fill=\"hsl(var(--chart-1))\" name=\"Passed\" />\n                  <Bar dataKey=\"failed\" fill=\"hsl(var(--destructive))\" name=\"Failed\" />\n                </BarChart>\n              </ResponsiveContainer>\n            </CardContent>\n          </Card>\n        </div>\n      )}\n\n      {(!stats?.savingsByService || stats.savingsByService.length === 0) && (\n        <Card>\n          <CardContent className=\"flex flex-col items-center justify-center py-12\">\n            <p className=\"text-muted-foreground text-center\">\n              No data available. Connect an AWS account and run benchmarks to see insights.\n            </p>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* All Services Costs - shows ALL services with costs, clickable to see resource details */}\n      <AllServicesCosts includeCredits={includeCredits} />\n\n      {/* Cost Optimization Recommendations */}\n      <CostRecommendationsPanel />\n    </div>\n  );\n}\n","size_bytes":8580},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","size_bytes":4120},"server/db.ts":{"content":"import { Pool, neonConfig } from '@neondatabase/serverless';\nimport { drizzle } from 'drizzle-orm/neon-serverless';\nimport ws from \"ws\";\nimport * as schema from \"@shared/schema\";\n\nneonConfig.webSocketConstructor = ws;\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\n    \"DATABASE_URL must be set. Did you forget to provision a database?\",\n  );\n}\n\nexport const pool = new Pool({ connectionString: process.env.DATABASE_URL });\nexport const db = drizzle({ client: pool, schema });\n","size_bytes":483},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","size_bytes":1077},"client/src/hooks/useAuth.ts":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport type { User } from \"@shared/schema\";\n\nexport function useAuth() {\n  const { data: user, isLoading } = useQuery<User>({\n    queryKey: [\"/api/auth/user\"],\n    retry: false,\n  });\n\n  return {\n    user,\n    isLoading,\n    isAuthenticated: !!user,\n  };\n}\n","size_bytes":307},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","size_bytes":1883},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","size_bytes":10481},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","size_bytes":791},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","size_bytes":1383},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","size_bytes":565},"design_guidelines.md":{"content":"# CostlyAgent Design Guidelines\n\n## Design Approach\n\n**Selected System**: Carbon Design System (IBM)\n**Rationale**: Enterprise-grade data visualization platform with complex dashboards, tables, and analytics. Carbon excels at information-dense applications with structured data presentation.\n\n**Design Principles**:\n- Clarity in data presentation\n- Efficient task completion\n- Consistent enterprise-grade patterns\n- Purposeful information hierarchy\n\n---\n\n## Core Design Elements\n\n### A. Typography\n\n**Primary Font**: IBM Plex Sans (via Google Fonts CDN)\n**Monospace**: IBM Plex Mono (for code/SQL editor)\n\n**Hierarchy**:\n- Page Titles: text-3xl font-semibold (30px)\n- Section Headers: text-2xl font-semibold (24px)\n- Card Titles: text-lg font-medium (18px)\n- Body: text-base (16px)\n- Metadata/Labels: text-sm (14px)\n- Captions: text-xs (12px)\n\n### B. Layout System\n\n**Spacing Primitives**: Use Tailwind units of 2, 4, 6, 8, and 12\n- Component padding: p-6\n- Card gaps: gap-6\n- Section spacing: space-y-8\n- Page margins: px-8 py-6\n- Tight spacing: gap-2, gap-4\n\n**Grid System**:\n- Dashboard cards: grid-cols-1 md:grid-cols-2 lg:grid-cols-4\n- Benchmark cards: grid-cols-1 md:grid-cols-2 lg:grid-cols-3\n- Resource tables: Full-width with horizontal scroll\n\n---\n\n## C. Component Library\n\n### 1. Authentication & Credential Management\n\n**Login Page**:\n- Centered card (max-w-md) with shadow-lg\n- Logo at top, form below\n- Single-column layout\n- CTA button full-width\n\n**AWS Credentials Management Page** (Post-Login Priority):\n- Header: \"Connected AWS Accounts\" with primary \"Add Account\" button\n- Account cards in grid (grid-cols-1 lg:grid-cols-2 gap-6)\n- Each card displays: Account nickname, Access Key ID (masked), Region, Status badge (Active/Inactive), Actions (Edit/Delete icons)\n- \"Add Account\" modal: Form with fields for Account Nickname, Access Key ID (input), Secret Access Key (password input), Default Region (dropdown)\n- Account selector dropdown in main nav (fixed top-right) showing active account with avatar/icon\n\n### 2. Navigation\n\n**Top Bar** (h-16, fixed):\n- Logo left, account selector center-right, user menu far-right\n- Shadow-sm border-b\n- Icons: Heroicons outline\n\n**Sidebar** (w-64, sticky):\n- Dashboard, Benchmarks, Controls, Resources, SQL Explorer, Settings sections\n- Active state: border-l-4 with filled background\n- Collapsed state on mobile: Hamburger menu\n\n### 3. Dashboard Components\n\n**KPI Cards** (4-column grid):\n- Large number (text-4xl font-bold)\n- Label below (text-sm)\n- Trend indicator (up/down arrow with percentage)\n- Icon in top-right corner\n- Shadow-sm, rounded-lg, p-6\n\n**Benchmark Cards**:\n- Header: Benchmark name + service icon\n- Circular progress ring (showing % passed)\n- Stats row: \"X/Y controls passed\"\n- Savings badge: \"Est. $XXX/mo savings\"\n- \"View Details\" link bottom-right\n- Hover: shadow-md transition\n\n**Control Detail Page**:\n- Breadcrumb navigation top\n- Two-column layout (8/12 + 4/12):\n  - Left: Control metadata, SQL code block (syntax-highlighted), results table\n  - Right: Severity badge, affected resources count, action buttons (Run Control, Export)\n- Charts below in full-width\n\n### 4. Data Display\n\n**Resource Table**:\n- Sticky header (bg-surface, shadow-sm)\n- Sortable columns with arrows\n- Filter row above table\n- Row actions: overflow menu (3 dots)\n- Pagination bottom (showing X-Y of Z)\n- Alternating row backgrounds for readability\n\n**SQL Query Editor**:\n- Monaco-style code editor (dark theme)\n- Toolbar: Run button, Save, History\n- Split view: Editor top (60%), Results table bottom (40%)\n- Line numbers, syntax highlighting\n\n### 5. Charts (Recharts)\n\n**Types to Use**:\n- Pie Chart: Savings by service\n- Bar Chart: Controls passed/failed by benchmark\n- Line Chart: Cost trends over time\n- Stacked Area: Resource utilization\n\n**Chart Styling**:\n- Consistent palette across all charts\n- Grid lines subtle\n- Tooltips with shadow-lg\n- Legend positioned bottom or right\n- Responsive container\n\n### 6. Forms & Inputs\n\n**Text Inputs**:\n- Border, rounded-md, px-4 py-2\n- Focus: ring-2 transition\n- Label above (text-sm font-medium mb-2)\n- Helper text below (text-xs)\n\n**Buttons**:\n- Primary: Full padding (px-6 py-3), rounded-md, shadow-sm\n- Secondary: Outlined variant\n- Icon buttons: p-2, rounded-md\n- Loading state: Spinner inside button\n\n### 7. Modals & Overlays\n\n**Modal Structure**:\n- Backdrop: Semi-transparent overlay\n- Content: max-w-2xl, rounded-lg, shadow-2xl\n- Header: Border-b with close icon\n- Footer: Border-t with action buttons right-aligned\n\n---\n\n## D. Animations\n\n**Use Sparingly**:\n- Page transitions: None (instant)\n- Card hover: shadow transition (transition-shadow duration-200)\n- Button clicks: Scale feedback (active:scale-95)\n- Loading states: Spinner only\n- Avoid scroll-triggered animations\n\n---\n\n## Images\n\n**Logo**: Place CostlyAgent logo (or AWS cloud icon) in top-left navigation bar\n**Dashboard Icons**: Use Heroicons for services (cloud, database, server icons)\n**Empty States**: Illustration placeholders for \"No accounts connected\" and \"No data available\"\n**No Hero Images**: This is a dashboard application - focus on data, not marketing imagery","size_bytes":5152},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"shadcn-card rounded-xl border bg-card border-card-border text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n));\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n));\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n));\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardDescription,\n  CardContent,\n}\n","size_bytes":1904},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","size_bytes":1139},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","size_bytes":2154},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","size_bytes":3848},"client/src/pages/SqlExplorer.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Play, History, Save } from \"lucide-react\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { isUnauthorizedError } from \"@/lib/authUtils\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\n\ninterface QueryResult {\n  columns: string[];\n  rows: any[];\n  rowCount: number;\n}\n\ninterface QueryHistoryItem {\n  id: string;\n  query: string;\n  executedAt: string;\n}\n\nexport default function SqlExplorer() {\n  const { toast } = useToast();\n  const [query, setQuery] = useState(\"SELECT * FROM aws_ec2_instance LIMIT 10;\");\n  const [showHistory, setShowHistory] = useState(false);\n\n  const { data: history } = useQuery<QueryHistoryItem[]>({\n    queryKey: [\"/api/queries/history\"],\n  });\n\n  const executeMutation = useMutation({\n    mutationFn: async (sql: string) => {\n      const response = await apiRequest(\"POST\", \"/api/queries/execute\", { query: sql });\n      return await response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/queries/history\"] });\n      toast({\n        title: \"Success\",\n        description: \"Query executed successfully\",\n      });\n    },\n    onError: (error: Error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/api/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to execute query\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleExecute = () => {\n    if (!query.trim()) {\n      toast({\n        title: \"Error\",\n        description: \"Please enter a query\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    executeMutation.mutate(query);\n  };\n\n  const handleLoadHistory = (historyQuery: string) => {\n    setQuery(historyQuery);\n    setShowHistory(false);\n  };\n\n  const result = executeMutation.data as QueryResult | undefined;\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div>\n        <h1 className=\"text-3xl font-semibold\">SQL Query Explorer</h1>\n        <p className=\"text-sm text-muted-foreground mt-2\">\n          Execute Steampipe SQL queries against your AWS infrastructure\n        </p>\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n        <div className=\"lg:col-span-2 space-y-6\">\n          <Card>\n            <CardHeader>\n              <div className=\"flex items-center justify-between\">\n                <CardTitle>Query Editor</CardTitle>\n                <div className=\"flex items-center gap-2\">\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => setShowHistory(!showHistory)}\n                    data-testid=\"button-history\"\n                  >\n                    <History className=\"h-4 w-4 mr-2\" />\n                    History\n                  </Button>\n                </div>\n              </div>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <Textarea\n                value={query}\n                onChange={(e) => setQuery(e.target.value)}\n                placeholder=\"SELECT * FROM aws_ec2_instance;\"\n                className=\"font-mono min-h-[200px]\"\n                data-testid=\"textarea-query\"\n              />\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center gap-2\">\n                  <Badge variant=\"secondary\">Steampipe SQL</Badge>\n                </div>\n                <Button\n                  onClick={handleExecute}\n                  disabled={executeMutation.isPending}\n                  data-testid=\"button-execute\"\n                >\n                  <Play className=\"h-4 w-4 mr-2\" />\n                  {executeMutation.isPending ? \"Executing...\" : \"Execute Query\"}\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader>\n              <CardTitle>Results</CardTitle>\n            </CardHeader>\n            <CardContent>\n              {executeMutation.isPending ? (\n                <div className=\"space-y-4\">\n                  {[1, 2, 3].map((i) => (\n                    <Skeleton key={i} className=\"h-12 w-full\" />\n                  ))}\n                </div>\n              ) : result && result.rows && result.rows.length > 0 ? (\n                <div className=\"space-y-4\">\n                  <div className=\"text-sm text-muted-foreground\">\n                    {result.rowCount} row{result.rowCount !== 1 ? \"s\" : \"\"} returned\n                  </div>\n                  <div className=\"overflow-x-auto\">\n                    <Table>\n                      <TableHeader>\n                        <TableRow>\n                          {result.columns.map((col) => (\n                            <TableHead key={col}>{col}</TableHead>\n                          ))}\n                        </TableRow>\n                      </TableHeader>\n                      <TableBody>\n                        {result.rows.map((row, idx) => (\n                          <TableRow key={idx}>\n                            {result.columns.map((col) => (\n                              <TableCell key={col} className=\"font-mono text-xs\">\n                                {typeof row[col] === \"object\"\n                                  ? JSON.stringify(row[col])\n                                  : String(row[col] ?? \"\")}\n                              </TableCell>\n                            ))}\n                          </TableRow>\n                        ))}\n                      </TableBody>\n                    </Table>\n                  </div>\n                </div>\n              ) : (\n                <div className=\"text-center py-12\">\n                  <p className=\"text-muted-foreground\">\n                    {executeMutation.isError\n                      ? \"Query execution failed. Check your SQL syntax.\"\n                      : \"Execute a query to see results\"}\n                  </p>\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </div>\n\n        {showHistory && (\n          <div className=\"lg:col-span-1\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Query History</CardTitle>\n              </CardHeader>\n              <CardContent>\n                {!history || history.length === 0 ? (\n                  <p className=\"text-sm text-muted-foreground text-center py-6\">\n                    No query history yet\n                  </p>\n                ) : (\n                  <div className=\"space-y-2\">\n                    {history.slice(0, 10).map((item) => (\n                      <button\n                        key={item.id}\n                        onClick={() => handleLoadHistory(item.query)}\n                        className=\"w-full text-left p-3 rounded-md hover-elevate active-elevate-2 border\"\n                        data-testid={`button-history-${item.id}`}\n                      >\n                        <p className=\"text-xs font-mono truncate\">{item.query}</p>\n                        <p className=\"text-xs text-muted-foreground mt-1\">\n                          {new Date(item.executedAt).toLocaleString()}\n                        </p>\n                      </button>\n                    ))}\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n","size_bytes":8083},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","size_bytes":1977},"client/src/pages/Home.tsx":{"content":"import { useEffect } from \"react\";\nimport { useLocation } from \"wouter\";\n\nexport default function Home() {\n  const [, setLocation] = useLocation();\n\n  useEffect(() => {\n    setLocation(\"/dashboard\");\n  }, [setLocation]);\n\n  return null;\n}\n","size_bytes":239},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(`\n      after:content-[''] after:block after:absolute after:inset-0 after:rounded-full after:pointer-events-none after:border after:border-black/10 dark:after:border-white/10\n      relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full`,\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","size_bytes":1592},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","size_bytes":4885},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","size_bytes":7609},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","size_bytes":5128},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","size_bytes":261},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","size_bytes":3021},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","size_bytes":1723},"client/src/App.tsx":{"content":"import { Switch, Route } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { SidebarProvider, SidebarTrigger } from \"@/components/ui/sidebar\";\nimport { ThemeProvider } from \"@/contexts/ThemeContext\";\nimport { ThemeToggle } from \"@/components/ThemeToggle\";\nimport { AppSidebar } from \"@/components/AppSidebar\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport NotFound from \"@/pages/not-found\";\nimport Landing from \"@/pages/Landing\";\nimport Login from \"@/pages/Login\";\nimport Signup from \"@/pages/Signup\";\nimport Home from \"@/pages/Home\";\nimport Dashboard from \"@/pages/Dashboard\";\nimport Benchmarks from \"@/pages/Benchmarks\";\nimport Resources from \"@/pages/Resources\";\nimport SqlExplorer from \"@/pages/SqlExplorer\";\nimport AwsAccounts from \"@/pages/AwsAccounts\";\nimport Settings from \"@/pages/Settings\";\n\nfunction Router() {\n  const { isAuthenticated, isLoading } = useAuth();\n\n  if (isLoading || !isAuthenticated) {\n    return (\n      <Switch>\n        <Route path=\"/\" component={Landing} />\n        <Route path=\"/login\" component={Login} />\n        <Route path=\"/signup\" component={Signup} />\n        <Route component={NotFound} />\n      </Switch>\n    );\n  }\n\n  return (\n    <Switch>\n      <Route path=\"/\" component={Home} />\n      <Route path=\"/dashboard\" component={Dashboard} />\n      <Route path=\"/benchmarks\" component={Benchmarks} />\n      <Route path=\"/resources\" component={Resources} />\n      <Route path=\"/sql-explorer\" component={SqlExplorer} />\n      <Route path=\"/aws-accounts\" component={AwsAccounts} />\n      <Route path=\"/settings\" component={Settings} />\n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\nfunction AppContent() {\n  const { isAuthenticated, isLoading } = useAuth();\n\n  const style = {\n    \"--sidebar-width\": \"16rem\",\n    \"--sidebar-width-icon\": \"3rem\",\n  };\n\n  if (isLoading || !isAuthenticated) {\n    return (\n      <>\n        <Toaster />\n        <Router />\n      </>\n    );\n  }\n\n  return (\n    <>\n      <SidebarProvider style={style as React.CSSProperties}>\n        <div className=\"flex h-screen w-full\">\n          <AppSidebar />\n          <div className=\"flex flex-col flex-1 overflow-hidden\">\n            <header className=\"flex items-center justify-between p-4 border-b\">\n              <SidebarTrigger data-testid=\"button-sidebar-toggle\" />\n              <ThemeToggle />\n            </header>\n            <main className=\"flex-1 overflow-y-auto\">\n              <Router />\n            </main>\n          </div>\n        </div>\n      </SidebarProvider>\n      <Toaster />\n    </>\n  );\n}\n\nfunction App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <ThemeProvider>\n        <TooltipProvider>\n          <AppContent />\n        </TooltipProvider>\n      </ThemeProvider>\n    </QueryClientProvider>\n  );\n}\n\nexport default App;\n","size_bytes":2976},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n          await import(\"@replit/vite-plugin-dev-banner\").then((m) =>\n            m.devBanner(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","size_bytes":1080},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","size_bytes":4845},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \".5625rem\", /* 9px */\n        md: \".375rem\", /* 6px */\n        sm: \".1875rem\", /* 3px */\n      },\n      colors: {\n        // Flat / base colors (regular buttons)\n        background: \"hsl(var(--background) / <alpha-value>)\",\n        foreground: \"hsl(var(--foreground) / <alpha-value>)\",\n        border: \"hsl(var(--border) / <alpha-value>)\",\n        input: \"hsl(var(--input) / <alpha-value>)\",\n        card: {\n          DEFAULT: \"hsl(var(--card) / <alpha-value>)\",\n          foreground: \"hsl(var(--card-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--card-border) / <alpha-value>)\",\n        },\n        popover: {\n          DEFAULT: \"hsl(var(--popover) / <alpha-value>)\",\n          foreground: \"hsl(var(--popover-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--popover-border) / <alpha-value>)\",\n        },\n        primary: {\n          DEFAULT: \"hsl(var(--primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--primary-foreground) / <alpha-value>)\",\n          border: \"var(--primary-border)\",\n        },\n        secondary: {\n          DEFAULT: \"hsl(var(--secondary) / <alpha-value>)\",\n          foreground: \"hsl(var(--secondary-foreground) / <alpha-value>)\",\n          border: \"var(--secondary-border)\",\n        },\n        muted: {\n          DEFAULT: \"hsl(var(--muted) / <alpha-value>)\",\n          foreground: \"hsl(var(--muted-foreground) / <alpha-value>)\",\n          border: \"var(--muted-border)\",\n        },\n        accent: {\n          DEFAULT: \"hsl(var(--accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--accent-foreground) / <alpha-value>)\",\n          border: \"var(--accent-border)\",\n        },\n        destructive: {\n          DEFAULT: \"hsl(var(--destructive) / <alpha-value>)\",\n          foreground: \"hsl(var(--destructive-foreground) / <alpha-value>)\",\n          border: \"var(--destructive-border)\",\n        },\n        ring: \"hsl(var(--ring) / <alpha-value>)\",\n        chart: {\n          \"1\": \"hsl(var(--chart-1) / <alpha-value>)\",\n          \"2\": \"hsl(var(--chart-2) / <alpha-value>)\",\n          \"3\": \"hsl(var(--chart-3) / <alpha-value>)\",\n          \"4\": \"hsl(var(--chart-4) / <alpha-value>)\",\n          \"5\": \"hsl(var(--chart-5) / <alpha-value>)\",\n        },\n        sidebar: {\n          ring: \"hsl(var(--sidebar-ring) / <alpha-value>)\",\n          DEFAULT: \"hsl(var(--sidebar) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--sidebar-border) / <alpha-value>)\",\n        },\n        \"sidebar-primary\": {\n          DEFAULT: \"hsl(var(--sidebar-primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-primary-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-primary-border)\",\n        },\n        \"sidebar-accent\": {\n          DEFAULT: \"hsl(var(--sidebar-accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-accent-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-accent-border)\"\n        },\n        status: {\n          online: \"rgb(34 197 94)\",\n          away: \"rgb(245 158 11)\",\n          busy: \"rgb(239 68 68)\",\n          offline: \"rgb(156 163 175)\",\n        },\n      },\n      fontFamily: {\n        sans: [\"var(--font-sans)\"],\n        serif: [\"var(--font-serif)\"],\n        mono: [\"var(--font-mono)\"],\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: { height: \"0\" },\n          to: { height: \"var(--radix-accordion-content-height)\" },\n        },\n        \"accordion-up\": {\n          from: { height: \"var(--radix-accordion-content-height)\" },\n          to: { height: \"0\" },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","size_bytes":4050},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","size_bytes":5741},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","size_bytes":1280},"client/src/components/ui/sidebar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, VariantProps } from \"class-variance-authority\"\nimport { PanelLeftIcon } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nfunction SidebarProvider({\n  defaultOpen = true,\n  open: openProp,\n  onOpenChange: setOpenProp,\n  className,\n  style,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  defaultOpen?: boolean\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n}) {\n  const isMobile = useIsMobile()\n  const [openMobile, setOpenMobile] = React.useState(false)\n\n  // This is the internal state of the sidebar.\n  // We use openProp and setOpenProp for control from outside the component.\n  const [_open, _setOpen] = React.useState(defaultOpen)\n  const open = openProp ?? _open\n  const setOpen = React.useCallback(\n    (value: boolean | ((value: boolean) => boolean)) => {\n      const openState = typeof value === \"function\" ? value(open) : value\n      if (setOpenProp) {\n        setOpenProp(openState)\n      } else {\n        _setOpen(openState)\n      }\n\n      // This sets the cookie to keep the sidebar state.\n      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n    },\n    [setOpenProp, open]\n  )\n\n  // Helper to toggle the sidebar.\n  const toggleSidebar = React.useCallback(() => {\n    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open)\n  }, [isMobile, setOpen, setOpenMobile])\n\n  // Adds a keyboard shortcut to toggle the sidebar.\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (\n        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n        (event.metaKey || event.ctrlKey)\n      ) {\n        event.preventDefault()\n        toggleSidebar()\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown)\n  }, [toggleSidebar])\n\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n  // This makes it easier to style the sidebar with Tailwind classes.\n  const state = open ? \"expanded\" : \"collapsed\"\n\n  const contextValue = React.useMemo<SidebarContextProps>(\n    () => ({\n      state,\n      open,\n      setOpen,\n      isMobile,\n      openMobile,\n      setOpenMobile,\n      toggleSidebar,\n    }),\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n  )\n\n  return (\n    <SidebarContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          data-slot=\"sidebar-wrapper\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH,\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n              ...style,\n            } as React.CSSProperties\n          }\n          className={cn(\n            \"group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full\",\n            className\n          )}\n          {...props}\n        >\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidebarContext.Provider>\n  )\n}\n\nfunction Sidebar({\n  side = \"left\",\n  variant = \"sidebar\",\n  collapsible = \"offcanvas\",\n  className,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  side?: \"left\" | \"right\"\n  variant?: \"sidebar\" | \"floating\" | \"inset\"\n  collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n}) {\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n  if (collapsible === \"none\") {\n    return (\n      <div\n        data-slot=\"sidebar\"\n        className={cn(\n          \"bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n      </div>\n    )\n  }\n\n  if (isMobile) {\n    return (\n      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n        <SheetContent\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar\"\n          data-mobile=\"true\"\n          className=\"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n            } as React.CSSProperties\n          }\n          side={side}\n        >\n          <SheetHeader className=\"sr-only\">\n            <SheetTitle>Sidebar</SheetTitle>\n            <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n          </SheetHeader>\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>\n    )\n  }\n\n  return (\n    <div\n      className=\"group peer text-sidebar-foreground hidden md:block\"\n      data-state={state}\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n      data-variant={variant}\n      data-side={side}\n      data-slot=\"sidebar\"\n    >\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        data-slot=\"sidebar-gap\"\n        className={cn(\n          \"relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear\",\n          \"group-data-[collapsible=offcanvas]:w-0\",\n          \"group-data-[side=right]:rotate-180\",\n          variant === \"floating\" || variant === \"inset\"\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]\"\n        )}\n      />\n      <div\n        data-slot=\"sidebar-container\"\n        className={cn(\n          \"fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex\",\n          side === \"left\"\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n          // Adjust the padding for floating and inset variants.\n          variant === \"floating\" || variant === \"inset\"\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n          className\n        )}\n        {...props}\n      >\n        <div\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar-inner\"\n          className=\"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm\"\n        >\n          {children}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction SidebarTrigger({\n  className,\n  onClick,\n  ...props\n}: React.ComponentProps<typeof Button>) {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      data-sidebar=\"trigger\"\n      data-slot=\"sidebar-trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeftIcon />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n}\n\nfunction SidebarRail({ className, ...props }: React.ComponentProps<\"button\">) {\n  const { toggleSidebar } = useSidebar()\n\n  // Note: Tailwind v3.4 doesn't support \"in-\" selectors. So the rail won't work perfectly.\n  return (\n    <button\n      data-sidebar=\"rail\"\n      data-slot=\"sidebar-rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex\",\n        \"in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInset({ className, ...props }: React.ComponentProps<\"main\">) {\n  return (\n    <main\n      data-slot=\"sidebar-inset\"\n      className={cn(\n        \"bg-background relative flex w-full flex-1 flex-col\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInput({\n  className,\n  ...props\n}: React.ComponentProps<typeof Input>) {\n  return (\n    <Input\n      data-slot=\"sidebar-input\"\n      data-sidebar=\"input\"\n      className={cn(\"bg-background h-8 w-full shadow-none\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-header\"\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-footer\"\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"sidebar-separator\"\n      data-sidebar=\"separator\"\n      className={cn(\"bg-sidebar-border mx-2 w-auto\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-content\"\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group\"\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupLabel({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-label\"\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupAction({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-action\"\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupContent({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group-content\"\n      data-sidebar=\"group-content\"\n      className={cn(\"w-full text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenu({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu\"\n      data-sidebar=\"menu\"\n      className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuItem({ className, ...props }: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-item\"\n      data-sidebar=\"menu-item\"\n      className={cn(\"group/menu-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:p-0!\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction SidebarMenuButton({\n  asChild = false,\n  isActive = false,\n  variant = \"default\",\n  size = \"default\",\n  tooltip,\n  className,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  isActive?: boolean\n  tooltip?: string | React.ComponentProps<typeof TooltipContent>\n} & VariantProps<typeof sidebarMenuButtonVariants>) {\n  const Comp = asChild ? Slot : \"button\"\n  const { isMobile, state } = useSidebar()\n\n  const button = (\n    <Comp\n      data-slot=\"sidebar-menu-button\"\n      data-sidebar=\"menu-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n      {...props}\n    />\n  )\n\n  if (!tooltip) {\n    return button\n  }\n\n  if (typeof tooltip === \"string\") {\n    tooltip = {\n      children: tooltip,\n    }\n  }\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\n      <TooltipContent\n        side=\"right\"\n        align=\"center\"\n        hidden={state !== \"collapsed\" || isMobile}\n        {...tooltip}\n      />\n    </Tooltip>\n  )\n}\n\nfunction SidebarMenuAction({\n  className,\n  asChild = false,\n  showOnHover = false,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  showOnHover?: boolean\n}) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-action\"\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuBadge({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-menu-badge\"\n      data-sidebar=\"menu-badge\"\n      className={cn(\n        \"text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none\",\n        \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSkeleton({\n  className,\n  showIcon = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  showIcon?: boolean\n}) {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      data-slot=\"sidebar-menu-skeleton\"\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[var(--skeleton-width)] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n}\n\nfunction SidebarMenuSub({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu-sub\"\n      data-sidebar=\"menu-sub\"\n      className={cn(\n        \"border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubItem({\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-sub-item\"\n      data-sidebar=\"menu-sub-item\"\n      className={cn(\"group/menu-sub-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubButton({\n  asChild = false,\n  size = \"md\",\n  isActive = false,\n  className,\n  ...props\n}: React.ComponentProps<\"a\"> & {\n  asChild?: boolean\n  size?: \"sm\" | \"md\"\n  isActive?: boolean\n}) {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-sub-button\"\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline outline-2 outline-transparent outline-offset-2 focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","size_bytes":21846},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":711},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","size_bytes":1251},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","size_bytes":7428},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","size_bytes":2695},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","size_bytes":80},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","size_bytes":689},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","size_bytes":4420},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","size_bytes":157},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","size_bytes":2712},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","size_bytes":3895},"client/src/contexts/ThemeContext.tsx":{"content":"import { createContext, useContext, useEffect, useState } from \"react\";\n\ntype Theme = \"light\" | \"dark\";\n\ninterface ThemeContextType {\n  theme: Theme;\n  toggleTheme: () => void;\n}\n\nconst ThemeContext = createContext<ThemeContextType | undefined>(undefined);\n\nexport function ThemeProvider({ children }: { children: React.ReactNode }) {\n  const [theme, setTheme] = useState<Theme>(() => {\n    const stored = localStorage.getItem(\"theme\");\n    return (stored as Theme) || \"light\";\n  });\n\n  useEffect(() => {\n    const root = document.documentElement;\n    root.classList.remove(\"light\", \"dark\");\n    root.classList.add(theme);\n    localStorage.setItem(\"theme\", theme);\n  }, [theme]);\n\n  const toggleTheme = () => {\n    setTheme((prev) => (prev === \"light\" ? \"dark\" : \"light\"));\n  };\n\n  return (\n    <ThemeContext.Provider value={{ theme, toggleTheme }}>\n      {children}\n    </ThemeContext.Provider>\n  );\n}\n\nexport function useTheme() {\n  const context = useContext(ThemeContext);\n  if (!context) {\n    throw new Error(\"useTheme must be used within ThemeProvider\");\n  }\n  return context;\n}\n","size_bytes":1086},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","size_bytes":1753},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","size_bytes":2765},"client/src/pages/Settings.tsx":{"content":"import { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { LogOut } from \"lucide-react\";\n\nexport default function Settings() {\n  const { user } = useAuth();\n\n  const getInitials = () => {\n    if (user?.firstName && user?.lastName) {\n      return `${user.firstName[0]}${user.lastName[0]}`.toUpperCase();\n    }\n    if (user?.email) {\n      return user.email.slice(0, 2).toUpperCase();\n    }\n    return \"U\";\n  };\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div>\n        <h1 className=\"text-3xl font-semibold\">Settings</h1>\n        <p className=\"text-sm text-muted-foreground mt-2\">\n          Manage your account and preferences\n        </p>\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>Profile</CardTitle>\n          <CardDescription>Your account information</CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-6\">\n          <div className=\"flex items-center gap-4\">\n            <Avatar className=\"h-16 w-16\">\n              <AvatarImage src={user?.profileImageUrl || \"\"} />\n              <AvatarFallback>{getInitials()}</AvatarFallback>\n            </Avatar>\n            <div>\n              <p className=\"font-medium\" data-testid=\"text-user-name\">\n                {user?.firstName && user?.lastName\n                  ? `${user.firstName} ${user.lastName}`\n                  : \"User\"}\n              </p>\n              <p className=\"text-sm text-muted-foreground\" data-testid=\"text-user-email\">\n                {user?.email || \"No email\"}\n              </p>\n            </div>\n          </div>\n\n          <div className=\"pt-4 border-t\">\n            <Button\n              variant=\"destructive\"\n              onClick={() => (window.location.href = \"/api/logout\")}\n              data-testid=\"button-logout\"\n            >\n              <LogOut className=\"h-4 w-4 mr-2\" />\n              Log Out\n            </Button>\n          </div>\n        </CardContent>\n      </Card>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>About CostlyAgent</CardTitle>\n          <CardDescription>\n            AWS cost optimization powered by Steampipe and Powerpipe\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"space-y-2 text-sm\">\n            <p>Version: 1.0.0</p>\n            <p className=\"text-muted-foreground\">\n              Analyze your AWS infrastructure for cost optimization opportunities\n              across 15 benchmarks and 41 controls.\n            </p>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":2750},"replit.md":{"content":"# CostlyAgent\n\n## Overview\n\nCostlyAgent is a full-stack web application for analyzing and optimizing AWS infrastructure costs using Steampipe, Powerpipe, and the AWS Thrifty mod. The application provides an interactive dashboard for running cost optimization benchmarks, visualizing data, and identifying potential savings across AWS resources.\n\n**Core Purpose**: Enable users to discover cost optimization opportunities across 15 benchmarks and 41 controls by connecting their AWS accounts and running automated cost analysis scans.\n\n**Key Features**:\n- Multi-account AWS credential management with encrypted storage\n- Real-time benchmark and control execution\n- Interactive data visualization dashboards\n- SQL query explorer for custom Steampipe queries\n- Resource drill-down with savings recommendations\n- User authentication via Replit OAuth\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Frontend Architecture\n\n**Technology Stack**:\n- React 18 with TypeScript\n- Vite for build tooling and development server\n- Wouter for client-side routing\n- TanStack Query for server state management\n- shadcn/ui component library with Radix UI primitives\n\n**Design System**:\n- Based on Carbon Design System (IBM) for enterprise-grade data presentation\n- IBM Plex Sans typography via Google Fonts\n- Tailwind CSS for styling with custom theme configuration\n- Dark/light theme support with context-based theme provider\n- Custom color tokens defined in CSS variables\n\n**State Management**:\n- TanStack Query (React Query) for API data fetching and caching\n- React Context for theme state\n- Form state managed via react-hook-form with zod validation\n\n**Component Organization**:\n- Page components in `client/src/pages/`\n- Reusable UI components in `client/src/components/ui/`\n- Custom hooks in `client/src/hooks/`\n- Shared utilities in `client/src/lib/`\n\n### Backend Architecture\n\n**Technology Stack**:\n- Node.js with Express.js server\n- TypeScript with ES modules\n- Drizzle ORM for database operations\n- Neon serverless PostgreSQL driver\n\n**API Structure**:\n- RESTful API endpoints under `/api` prefix\n- Authentication middleware protecting all routes except `/api/login`\n- Session-based authentication using express-session with PostgreSQL session store\n\n**Key API Endpoints**:\n- `/api/auth/user` - Fetch authenticated user profile\n- `/api/aws-accounts` - CRUD operations for AWS account credentials\n- `/api/dashboard/stats` - Dashboard statistics and metrics\n- `/api/benchmarks` - Benchmark execution and results\n- `/api/resources` - Resource listing and details\n- `/api/queries/*` - SQL query execution and history\n\n**Authentication Flow**:\n- OpenID Connect (OIDC) integration with Replit Auth\n- Passport.js strategy for OAuth handling\n- Session management with PostgreSQL-backed session store\n- User profile data synchronized to local database\n\n**Security Measures**:\n- AWS credentials encrypted using AES-256-CBC\n- Encryption key derived from SESSION_SECRET environment variable\n- Credentials never returned in plaintext via API (masked as \"***ENCRYPTED***\")\n- Session cookies with httpOnly and secure flags\n- CSRF protection via session secret\n\n### Data Storage Solutions\n\n**Database**: PostgreSQL (via Neon serverless)\n\n**Schema Design** (defined in `shared/schema.ts`):\n\n1. **sessions** - Express session storage (required for auth)\n   - Primary key: sid (session ID)\n   - Contains serialized session data and expiration\n\n2. **users** - User profiles from Replit OAuth\n   - Fields: email, firstName, lastName, profileImageUrl\n   - Timestamps: createdAt, updatedAt\n\n3. **awsAccounts** - AWS account credentials per user\n   - Foreign key to users table with cascade delete\n   - Encrypted secretAccessKey field\n   - Fields: nickname, accessKeyId, region, isActive\n   - Supports multi-account management per user\n\n4. **benchmarkResults** - Results from benchmark executions\n   - Stores benchmark outcomes and metadata\n\n5. **controlResults** - Individual control check results\n   - Granular results from AWS Thrifty controls\n\n6. **queryHistory** - SQL query execution history\n   - Tracks user queries for audit and reuse\n\n**ORM Layer**:\n- Drizzle ORM for type-safe database queries\n- Schema validation using drizzle-zod\n- Migration management via drizzle-kit\n\n### External Dependencies\n\n**Third-Party Services**:\n\n1. **Replit Authentication**\n   - OpenID Connect provider for user authentication\n   - Issuer URL: `https://replit.com/oidc` (configurable via ISSUER_URL)\n   - Provides user profile data (email, name, avatar)\n\n2. **Neon Database**\n   - Serverless PostgreSQL hosting\n   - WebSocket-based connection pooling\n   - Connection string via DATABASE_URL environment variable\n\n**External Tools** (Referenced but not yet integrated):\n\n1. **Steampipe**\n   - CLI tool for querying cloud infrastructure as SQL\n   - Expected to be executed programmatically from backend\n   - AWS plugin integration for account scanning\n\n2. **Powerpipe**\n   - Dashboard and benchmark execution engine\n   - AWS Thrifty mod for cost optimization checks\n   - Expected integration: 15 benchmarks, 41 controls\n\n**Required Environment Variables**:\n- `DATABASE_URL` - PostgreSQL connection string\n- `SESSION_SECRET` - Secret for session encryption and AWS credential encryption\n- `REPL_ID` - Replit application identifier\n- `ISSUER_URL` - OAuth issuer URL (optional, defaults to Replit)\n\n**NPM Dependencies**:\n- `@neondatabase/serverless` - Neon PostgreSQL driver\n- `drizzle-orm` - Database ORM\n- `express` - Web server framework\n- `passport` & `openid-client` - OAuth authentication\n- `connect-pg-simple` - PostgreSQL session store\n- `@radix-ui/*` - UI primitive components\n- `@tanstack/react-query` - Data fetching library\n- `recharts` - Data visualization library\n- `react-hook-form` & `zod` - Form handling and validation\n- `tailwindcss` - Utility-first CSS framework\n\n**Design Assets**:\n- Google Fonts CDN for IBM Plex Sans and IBM Plex Mono\n- Custom favicon in `/favicon.png`","size_bytes":6007},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","size_bytes":710},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","size_bytes":1527},"client/src/index.css":{"content":"@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n/* LIGHT MODE */\n:root {\n  --button-outline: rgba(0,0,0, .10);\n  --badge-outline: rgba(0,0,0, .05);\n  --opaque-button-border-intensity: -8;\n  --elevate-1: rgba(0,0,0, .03);\n  --elevate-2: rgba(0,0,0, .08);\n  --background: 0 0% 100%;\n  --foreground: 220 13% 13%;\n  --border: 220 13% 91%;\n  --card: 0 0% 98%;\n  --card-foreground: 220 13% 13%;\n  --card-border: 220 13% 94%;\n  --sidebar: 220 6% 96%;\n  --sidebar-foreground: 220 13% 13%;\n  --sidebar-border: 220 6% 92%;\n  --sidebar-primary: 217 91% 60%;\n  --sidebar-primary-foreground: 0 0% 98%;\n  --sidebar-accent: 220 8% 90%;\n  --sidebar-accent-foreground: 220 13% 13%;\n  --sidebar-ring: 217 91% 60%;\n  --popover: 220 6% 95%;\n  --popover-foreground: 220 13% 13%;\n  --popover-border: 220 6% 91%;\n  --primary: 217 91% 60%;\n  --primary-foreground: 0 0% 98%;\n  --secondary: 220 8% 92%;\n  --secondary-foreground: 220 13% 13%;\n  --muted: 220 8% 94%;\n  --muted-foreground: 220 9% 46%;\n  --accent: 220 10% 93%;\n  --accent-foreground: 220 13% 13%;\n  --destructive: 0 84% 60%;\n  --destructive-foreground: 0 0% 98%;\n  --input: 220 13% 80%;\n  --ring: 217 91% 60%;\n  --chart-1: 217 91% 60%;\n  --chart-2: 173 58% 39%;\n  --chart-3: 197 37% 24%;\n  --chart-4: 43 74% 66%;\n  --chart-5: 27 87% 67%;\n  --font-sans: IBM Plex Sans, sans-serif;\n  --font-serif: Georgia, serif;\n  --font-mono: IBM Plex Mono, monospace;\n  --radius: .5rem;\n  --shadow-2xs: 0px 2px 0px 0px hsl(220 13% 13% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(220 13% 13% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(220 13% 13% / 0.00), 0px 1px 2px -1px hsl(220 13% 13% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(220 13% 13% / 0.00), 0px 1px 2px -1px hsl(220 13% 13% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(220 13% 13% / 0.00), 0px 2px 4px -1px hsl(220 13% 13% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(220 13% 13% / 0.00), 0px 4px 6px -1px hsl(220 13% 13% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(220 13% 13% / 0.00), 0px 8px 10px -1px hsl(220 13% 13% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(220 13% 13% / 0.00);\n  --tracking-normal: 0em;\n  --spacing: 0.25rem;\n\n/* Fallback for older browsers */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n.dark {\n  --button-outline: rgba(255,255,255, .10);\n  --badge-outline: rgba(255,255,255, .05);\n  --opaque-button-border-intensity: 9;\n  --elevate-1: rgba(255,255,255, .04);\n  --elevate-2: rgba(255,255,255, .09);\n  --background: 220 13% 9%;\n  --foreground: 0 0% 98%;\n  --border: 220 13% 18%;\n  --card: 220 13% 11%;\n  --card-foreground: 0 0% 98%;\n  --card-border: 220 13% 15%;\n  --sidebar: 220 6% 13%;\n  --sidebar-foreground: 0 0% 98%;\n  --sidebar-border: 220 6% 17%;\n  --sidebar-primary: 217 91% 60%;\n  --sidebar-primary-foreground: 0 0% 98%;\n  --sidebar-accent: 220 8% 16%;\n  --sidebar-accent-foreground: 0 0% 98%;\n  --sidebar-ring: 217 91% 60%;\n  --popover: 220 6% 15%;\n  --popover-foreground: 0 0% 98%;\n  --popover-border: 220 6% 19%;\n  --primary: 217 91% 60%;\n  --primary-foreground: 0 0% 98%;\n  --secondary: 220 8% 18%;\n  --secondary-foreground: 0 0% 98%;\n  --muted: 220 8% 17%;\n  --muted-foreground: 220 9% 65%;\n  --accent: 220 10% 16%;\n  --accent-foreground: 0 0% 98%;\n  --destructive: 0 84% 60%;\n  --destructive-foreground: 0 0% 98%;\n  --input: 220 13% 30%;\n  --ring: 217 91% 60%;\n  --chart-1: 217 91% 70%;\n  --chart-2: 173 58% 65%;\n  --chart-3: 197 37% 55%;\n  --chart-4: 43 74% 70%;\n  --chart-5: 27 87% 72%;\n  --shadow-2xs: 0px 2px 0px 0px hsl(220 13% 98% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(220 13% 98% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(220 13% 98% / 0.00), 0px 1px 2px -1px hsl(220 13% 98% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(220 13% 98% / 0.00), 0px 1px 2px -1px hsl(220 13% 98% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(220 13% 98% / 0.00), 0px 2px 4px -1px hsl(220 13% 98% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(220 13% 98% / 0.00), 0px 4px 6px -1px hsl(220 13% 98% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(220 13% 98% / 0.00), 0px 8px 10px -1px hsl(220 13% 98% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(220 13% 98% / 0.00);\n\n/* Fallback for older browsers */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n  }\n}\n\n/**\n * Using the elevate system.\n * Automatic contrast adjustment.\n *\n * <element className=\"hover-elevate\" />\n * <element className=\"active-elevate-2\" />\n *\n * // Using the tailwind utility when a data attribute is \"on\"\n * <element className=\"toggle-elevate data-[state=on]:toggle-elevated\" />\n * // Or manually controlling the toggle state\n * <element className=\"toggle-elevate toggle-elevated\" />\n *\n * Elevation systems have to handle many states.\n * - not-hovered, vs. hovered vs. active  (three mutually exclusive states)\n * - toggled or not\n * - focused or not (this is not handled with these utilities)\n *\n * Even without handling focused or not, this is six possible combinations that\n * need to be distinguished from eachother visually.\n */\n@layer utilities {\n\n  /* Hide ugly search cancel button in Chrome until we can style it properly */\n  input[type=\"search\"]::-webkit-search-cancel-button {\n    @apply hidden;\n  }\n\n  /* Placeholder styling for contentEditable div */\n  [contenteditable][data-placeholder]:empty::before {\n    content: attr(data-placeholder);\n    color: hsl(var(--muted-foreground));\n    pointer-events: none;\n  }\n\n  /* .no-default-hover-elevate/no-default-active-elevate is an escape hatch so consumers of\n   * buttons/badges can remove the automatic brightness adjustment on interactions\n   * and program their own. */\n  .no-default-hover-elevate {}\n\n  .no-default-active-elevate {}\n\n\n  /**\n   * Toggleable backgrounds go behind the content. Hoverable/active goes on top.\n   * This way they can stack/compound. Both will overlap the parent's borders!\n   * So borders will be automatically adjusted both on toggle, and hover/active,\n   * and they will be compounded.\n   */\n  .toggle-elevate::before,\n  .toggle-elevate-2::before {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    /*border-radius: inherit;   match rounded corners */\n    border-radius: inherit;\n    z-index: -1;\n    /* sits behind content but above backdrop */\n  }\n\n  .toggle-elevate.toggle-elevated::before {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.toggle-elevate::before {\n    inset: -1px;\n  }\n\n  /* Does not work on elements with overflow:hidden! */\n  .hover-elevate:not(.no-default-hover-elevate),\n  .active-elevate:not(.no-default-active-elevate),\n  .hover-elevate-2:not(.no-default-hover-elevate),\n  .active-elevate-2:not(.no-default-active-elevate) {\n    position: relative;\n    z-index: 0;\n  }\n\n  .hover-elevate:not(.no-default-hover-elevate)::after,\n  .active-elevate:not(.no-default-active-elevate)::after,\n  .hover-elevate-2:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:not(.no-default-active-elevate)::after {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    /*border-radius: inherit;   match rounded corners */\n    border-radius: inherit;\n    z-index: 999;\n    /* sits in front of content */\n  }\n\n  .hover-elevate:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-1);\n  }\n\n  .hover-elevate-2:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate-2:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate-2:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after {\n    inset: -1px;\n  }\n}\n","size_bytes":10730},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","size_bytes":772},"client/src/components/AppSidebar.tsx":{"content":"import {\n  Database,\n  Home,\n  LayoutDashboard,\n  Settings,\n  CheckSquare,\n  Search,\n  Cloud,\n} from \"lucide-react\";\nimport {\n  Sidebar,\n  SidebarContent,\n  SidebarGroup,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarMenu,\n  SidebarMenuButton,\n  SidebarMenuItem,\n} from \"@/components/ui/sidebar\";\nimport { Link, useLocation } from \"wouter\";\n\nconst menuItems = [\n  {\n    title: \"Dashboard\",\n    url: \"/dashboard\",\n    icon: LayoutDashboard,\n  },\n  {\n    title: \"Benchmarks\",\n    url: \"/benchmarks\",\n    icon: CheckSquare,\n  },\n  {\n    title: \"Resources\",\n    url: \"/resources\",\n    icon: Database,\n  },\n  {\n    title: \"SQL Explorer\",\n    url: \"/sql-explorer\",\n    icon: Search,\n  },\n  {\n    title: \"AWS Accounts\",\n    url: \"/aws-accounts\",\n    icon: Cloud,\n  },\n  {\n    title: \"Settings\",\n    url: \"/settings\",\n    icon: Settings,\n  },\n];\n\nexport function AppSidebar() {\n  const [location] = useLocation();\n\n  return (\n    <Sidebar>\n      <SidebarContent>\n        <SidebarGroup>\n          <SidebarGroupLabel>CostlyAgent</SidebarGroupLabel>\n          <SidebarGroupContent>\n            <SidebarMenu>\n              {menuItems.map((item) => (\n                <SidebarMenuItem key={item.title}>\n                  <SidebarMenuButton asChild isActive={location === item.url}>\n                    <Link href={item.url} data-testid={`link-${item.title.toLowerCase().replace(' ', '-')}`}>\n                      <item.icon className=\"h-4 w-4\" />\n                      <span>{item.title}</span>\n                    </Link>\n                  </SidebarMenuButton>\n                </SidebarMenuItem>\n              ))}\n            </SidebarMenu>\n          </SidebarGroupContent>\n        </SidebarGroup>\n      </SidebarContent>\n    </Sidebar>\n  );\n}\n","size_bytes":1739},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","size_bytes":1209},"shared/schema.ts":{"content":"import { sql } from 'drizzle-orm';\nimport {\n  index,\n  jsonb,\n  pgTable,\n  timestamp,\n  varchar,\n  text,\n  integer,\n  boolean,\n} from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\n// Session storage table for user authentication\nexport const sessions = pgTable(\n  \"sessions\",\n  {\n    sid: varchar(\"sid\").primaryKey(),\n    sess: jsonb(\"sess\").notNull(),\n    expire: timestamp(\"expire\").notNull(),\n  },\n  (table) => [index(\"IDX_session_expire\").on(table.expire)],\n);\n\n// User storage table with email/password authentication\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  email: varchar(\"email\", { length: 255 }).notNull().unique(),\n  password: text(\"password\").notNull(), // hashed with bcrypt\n  firstName: varchar(\"first_name\", { length: 255 }),\n  lastName: varchar(\"last_name\", { length: 255 }),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertUserSchema = createInsertSchema(users).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const signupSchema = z.object({\n  email: z.string().email(\"Invalid email address\"),\n  password: z.string().min(8, \"Password must be at least 8 characters\"),\n  firstName: z.string().min(1, \"First name is required\").optional(),\n  lastName: z.string().min(1, \"Last name is required\").optional(),\n});\n\nexport const loginSchema = z.object({\n  email: z.string().email(\"Invalid email address\"),\n  password: z.string().min(1, \"Password is required\"),\n});\n\nexport type InsertUser = z.infer<typeof insertUserSchema>;\nexport type SignupInput = z.infer<typeof signupSchema>;\nexport type LoginInput = z.infer<typeof loginSchema>;\nexport type User = typeof users.$inferSelect;\nexport type UserWithoutPassword = Omit<User, 'password'>;\n\n// AWS Accounts table for storing user's AWS credentials\nexport const awsAccounts = pgTable(\"aws_accounts\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id, { onDelete: \"cascade\" }),\n  nickname: varchar(\"nickname\", { length: 255 }).notNull(),\n  accessKeyId: varchar(\"access_key_id\", { length: 255 }).notNull(),\n  secretAccessKey: text(\"secret_access_key\").notNull(), // encrypted\n  region: varchar(\"region\", { length: 50 }).notNull().default('us-east-1'),\n  isActive: boolean(\"is_active\").notNull().default(true),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertAwsAccountSchema = createInsertSchema(awsAccounts).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport type InsertAwsAccount = z.infer<typeof insertAwsAccountSchema>;\nexport type AwsAccount = typeof awsAccounts.$inferSelect;\n\n// Benchmark results table\nexport const benchmarkResults = pgTable(\"benchmark_results\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  awsAccountId: varchar(\"aws_account_id\").notNull().references(() => awsAccounts.id, { onDelete: \"cascade\" }),\n  benchmarkId: varchar(\"benchmark_id\", { length: 255 }).notNull(),\n  benchmarkName: varchar(\"benchmark_name\", { length: 255 }).notNull(),\n  controlsPassed: integer(\"controls_passed\").notNull().default(0),\n  controlsFailed: integer(\"controls_failed\").notNull().default(0),\n  estimatedSavings: integer(\"estimated_savings\").notNull().default(0), // in cents\n  resultJson: jsonb(\"result_json\"),\n  executedAt: timestamp(\"executed_at\").defaultNow(),\n});\n\nexport type BenchmarkResult = typeof benchmarkResults.$inferSelect;\n\n// Control results table - stores individual resource checks from benchmarks\nexport const controlResults = pgTable(\"control_results\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  benchmarkResultId: varchar(\"benchmark_result_id\").notNull().references(() => benchmarkResults.id, { onDelete: \"cascade\" }),\n  awsAccountId: varchar(\"aws_account_id\").notNull().references(() => awsAccounts.id, { onDelete: \"cascade\" }),\n  controlId: varchar(\"control_id\", { length: 255 }).notNull(),\n  controlName: text(\"control_name\").notNull(),\n  resourceId: varchar(\"resource_id\", { length: 255 }), // AWS resource ID (instance-id, bucket name, etc.)\n  resourceType: varchar(\"resource_type\", { length: 100 }), // EC2, S3, RDS, etc.\n  passed: boolean(\"passed\").notNull().default(false),\n  reason: text(\"reason\"), // Why this check failed/passed\n  estimatedSavings: integer(\"estimated_savings\").notNull().default(0), // in cents\n  executedAt: timestamp(\"executed_at\").defaultNow(),\n});\n\nexport type ControlResult = typeof controlResults.$inferSelect;\n\n// Query history table\nexport const queryHistory = pgTable(\"query_history\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id, { onDelete: \"cascade\" }),\n  awsAccountId: varchar(\"aws_account_id\").references(() => awsAccounts.id, { onDelete: \"set null\" }),\n  query: text(\"query\").notNull(),\n  resultJson: jsonb(\"result_json\"),\n  executedAt: timestamp(\"executed_at\").defaultNow(),\n});\n\nexport type QueryHistory = typeof queryHistory.$inferSelect;\n\n// AWS Cost Explorer types\nexport const monthlyCostSchema = z.object({\n  amount: z.number(), // in cents\n  startDate: z.string(),\n  endDate: z.string(),\n});\n\nexport const serviceCostSchema = z.object({\n  service: z.string(),\n  amount: z.number(), // in cents\n});\n\nexport const costSummarySchema = z.object({\n  currentMonth: monthlyCostSchema,\n  previousMonth: monthlyCostSchema,\n  percentageChange: z.number(),\n  costDifference: z.number(), // in cents\n  topServices: z.array(serviceCostSchema),\n});\n\nexport type MonthlyCost = z.infer<typeof monthlyCostSchema>;\nexport type ServiceCost = z.infer<typeof serviceCostSchema>;\nexport type CostSummary = z.infer<typeof costSummarySchema>;\n\n// Extended service breakdown with full details\nexport const serviceBreakdownSchema = z.object({\n  serviceCode: z.string(), // e.g., \"AmazonEC2\"\n  serviceName: z.string(), // e.g., \"Amazon Elastic Compute Cloud\"\n  amount: z.number(), // in cents\n  region: z.string().optional(), // Primary region (if applicable)\n  resourceCount: z.number().optional(), // Number of resources\n});\n\nexport type ServiceBreakdown = z.infer<typeof serviceBreakdownSchema>;\n\n// Resource cost details for drill-down\nexport const resourceCostDetailSchema = z.object({\n  resourceId: z.string(), // AWS resource ID (e.g., i-1234567890abcdef0)\n  resourceName: z.string().optional(), // Name tag or identifier\n  resourceType: z.string(), // e.g., \"EC2 Instance\", \"RDS Database\"\n  region: z.string(), // AWS region\n  usageType: z.string(), // e.g., \"BoxUsage:t2.micro\"\n  amount: z.number(), // in cents\n  tags: z.record(z.string()).optional(), // Resource tags\n});\n\nexport type ResourceCostDetail = z.infer<typeof resourceCostDetailSchema>;\n\n// Service resources response (grouped by region)\nexport const serviceResourcesSchema = z.object({\n  serviceCode: z.string(),\n  serviceName: z.string(),\n  totalAmount: z.number(), // in cents\n  byRegion: z.array(z.object({\n    region: z.string(),\n    amount: z.number(), // in cents\n    resources: z.array(resourceCostDetailSchema),\n  })),\n});\n\nexport type ServiceResources = z.infer<typeof serviceResourcesSchema>;\n\n// AWS Recommendations types\nexport const reservedInstanceRecommendationSchema = z.object({\n  serviceCode: z.string(), // e.g., \"AmazonEC2\"\n  instanceType: z.string(), // e.g., \"t3.medium\"\n  region: z.string(),\n  paymentOption: z.string(), // e.g., \"NO_UPFRONT\", \"PARTIAL_UPFRONT\", \"ALL_UPFRONT\"\n  term: z.string(), // e.g., \"ONE_YEAR\", \"THREE_YEARS\"\n  estimatedMonthlySavings: z.number(), // in cents\n  estimatedSavingsPercentage: z.number(),\n  upfrontCost: z.number(), // in cents\n  recommendedQuantity: z.number(),\n});\n\nexport type ReservedInstanceRecommendation = z.infer<typeof reservedInstanceRecommendationSchema>;\n\nexport const savingsPlanRecommendationSchema = z.object({\n  planType: z.string(), // \"COMPUTE_SP\" or \"EC2_INSTANCE_SP\"\n  paymentOption: z.string(),\n  term: z.string(),\n  hourlyCommitment: z.number(), // in cents per hour\n  estimatedMonthlySavings: z.number(), // in cents\n  estimatedSavingsPercentage: z.number(),\n  upfrontCost: z.number(), // in cents\n});\n\nexport type SavingsPlanRecommendation = z.infer<typeof savingsPlanRecommendationSchema>;\n\nexport const rightsizingRecommendationSchema = z.object({\n  resourceId: z.string(),\n  resourceName: z.string().optional(),\n  currentInstanceType: z.string(),\n  recommendedInstanceType: z.string(),\n  region: z.string(),\n  estimatedMonthlySavings: z.number(), // in cents\n  estimatedSavingsPercentage: z.number(),\n  reason: z.string(), // Explanation for the recommendation\n  cpuUtilization: z.number().optional(), // Average CPU utilization percentage\n  memoryUtilization: z.number().optional(),\n});\n\nexport type RightsizingRecommendation = z.infer<typeof rightsizingRecommendationSchema>;\n\n// Combined recommendations response\nexport const costRecommendationsSchema = z.object({\n  reservedInstances: z.array(reservedInstanceRecommendationSchema),\n  savingsPlans: z.array(savingsPlanRecommendationSchema),\n  rightsizing: z.array(rightsizingRecommendationSchema),\n  totalEstimatedMonthlySavings: z.number(), // in cents\n});\n\nexport type CostRecommendations = z.infer<typeof costRecommendationsSchema>;\n\n// Cost Forecast types\nexport const forecastPeriodSchema = z.object({\n  amount: z.number(), // in cents\n  startDate: z.string(),\n  endDate: z.string(),\n  confidence: z.object({\n    lower: z.number(), // lower bound in cents\n    upper: z.number(), // upper bound in cents\n  }).optional(),\n});\n\nexport const costForecastSchema = z.object({\n  nextMonth: forecastPeriodSchema,\n  next3Months: forecastPeriodSchema.optional(),\n  yearToDateActual: z.number(), // in cents\n  yearToDateForecast: z.number(), // in cents\n});\n\nexport type ForecastPeriod = z.infer<typeof forecastPeriodSchema>;\nexport type CostForecast = z.infer<typeof costForecastSchema>;\n","size_bytes":10036},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","size_bytes":1642},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","size_bytes":140},"client/src/pages/Resources.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport { Search, ExternalLink } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\n\ninterface Resource {\n  id: string;\n  resourceId: string;\n  resourceType: string;\n  service: string;\n  region: string;\n  status: string;\n  reason: string;\n  savingsPotential: number;\n  awsConsoleUrl: string;\n}\n\nexport default function Resources() {\n  const [searchTerm, setSearchTerm] = useState(\"\");\n\n  const { data: resources, isLoading } = useQuery<Resource[]>({\n    queryKey: [\"/api/resources\"],\n  });\n\n  const filteredResources = resources?.filter((resource) =>\n    Object.values(resource).some((value) =>\n      String(value).toLowerCase().includes(searchTerm.toLowerCase())\n    )\n  );\n\n  const formatCurrency = (cents: number) => {\n    return `$${(cents / 100).toFixed(2)}`;\n  };\n\n  const getStatusColor = (status: string) => {\n    switch (status.toLowerCase()) {\n      case \"failed\":\n        return \"destructive\";\n      case \"warning\":\n        return \"secondary\";\n      case \"passed\":\n        return \"default\";\n      default:\n        return \"secondary\";\n    }\n  };\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div>\n        <h1 className=\"text-3xl font-semibold\">Resource Explorer</h1>\n        <p className=\"text-sm text-muted-foreground mt-2\">\n          Browse and analyze affected AWS resources\n        </p>\n      </div>\n\n      <div className=\"flex items-center gap-4\">\n        <div className=\"relative flex-1 max-w-md\">\n          <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n          <Input\n            placeholder=\"Search resources...\"\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n            className=\"pl-10\"\n            data-testid=\"input-search\"\n          />\n        </div>\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>Affected Resources</CardTitle>\n        </CardHeader>\n        <CardContent>\n          {isLoading ? (\n            <div className=\"space-y-4\">\n              {[1, 2, 3, 4, 5].map((i) => (\n                <Skeleton key={i} className=\"h-16 w-full\" />\n              ))}\n            </div>\n          ) : !filteredResources || filteredResources.length === 0 ? (\n            <div className=\"text-center py-12\">\n              <p className=\"text-muted-foreground\">\n                {searchTerm\n                  ? \"No resources found matching your search.\"\n                  : \"No resources available. Run benchmarks to populate this list.\"}\n              </p>\n            </div>\n          ) : (\n            <div className=\"overflow-x-auto\">\n              <Table>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead>Resource ID</TableHead>\n                    <TableHead>Type</TableHead>\n                    <TableHead>Service</TableHead>\n                    <TableHead>Region</TableHead>\n                    <TableHead>Status</TableHead>\n                    <TableHead>Reason</TableHead>\n                    <TableHead className=\"text-right\">Savings</TableHead>\n                    <TableHead></TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {filteredResources.map((resource) => (\n                    <TableRow key={resource.id} data-testid={`row-resource-${resource.id}`}>\n                      <TableCell className=\"font-mono text-sm\" data-testid={`text-resource-id-${resource.id}`}>\n                        {resource.resourceId}\n                      </TableCell>\n                      <TableCell>{resource.resourceType}</TableCell>\n                      <TableCell>\n                        <Badge variant=\"secondary\">{resource.service}</Badge>\n                      </TableCell>\n                      <TableCell>{resource.region}</TableCell>\n                      <TableCell>\n                        <Badge variant={getStatusColor(resource.status)}>\n                          {resource.status}\n                        </Badge>\n                      </TableCell>\n                      <TableCell className=\"max-w-xs truncate\">\n                        {resource.reason}\n                      </TableCell>\n                      <TableCell className=\"text-right font-semibold text-primary\">\n                        {formatCurrency(resource.savingsPotential)}/mo\n                      </TableCell>\n                      <TableCell>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"icon\"\n                          onClick={() => window.open(resource.awsConsoleUrl, \"_blank\")}\n                          data-testid={`button-console-${resource.id}`}\n                        >\n                          <ExternalLink className=\"h-4 w-4\" />\n                        </Button>\n                      </TableCell>\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":5444},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","size_bytes":756},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","size_bytes":1056},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","size_bytes":8605},"server/replitAuth.ts":{"content":"import * as client from \"openid-client\";\nimport { Strategy, type VerifyFunction } from \"openid-client/passport\";\n\nimport passport from \"passport\";\nimport session from \"express-session\";\nimport type { Express, RequestHandler } from \"express\";\nimport memoize from \"memoizee\";\nimport connectPg from \"connect-pg-simple\";\nimport { storage } from \"./storage\";\n\nconst getOidcConfig = memoize(\n  async () => {\n    return await client.discovery(\n      new URL(process.env.ISSUER_URL ?? \"https://replit.com/oidc\"),\n      process.env.REPL_ID!\n    );\n  },\n  { maxAge: 3600 * 1000 }\n);\n\nexport function getSession() {\n  const sessionTtl = 7 * 24 * 60 * 60 * 1000; // 1 week\n  const pgStore = connectPg(session);\n  const sessionStore = new pgStore({\n    conString: process.env.DATABASE_URL,\n    createTableIfMissing: false,\n    ttl: sessionTtl,\n    tableName: \"sessions\",\n  });\n  return session({\n    secret: process.env.SESSION_SECRET!,\n    store: sessionStore,\n    resave: false,\n    saveUninitialized: false,\n    cookie: {\n      httpOnly: true,\n      secure: true,\n      maxAge: sessionTtl,\n    },\n  });\n}\n\nfunction updateUserSession(\n  user: any,\n  tokens: client.TokenEndpointResponse & client.TokenEndpointResponseHelpers\n) {\n  user.claims = tokens.claims();\n  user.access_token = tokens.access_token;\n  user.refresh_token = tokens.refresh_token;\n  user.expires_at = user.claims?.exp;\n}\n\nasync function upsertUser(\n  claims: any,\n) {\n  await storage.upsertUser({\n    id: claims[\"sub\"],\n    email: claims[\"email\"],\n    firstName: claims[\"first_name\"],\n    lastName: claims[\"last_name\"],\n    profileImageUrl: claims[\"profile_image_url\"],\n  });\n}\n\nexport async function setupAuth(app: Express) {\n  app.set(\"trust proxy\", 1);\n  app.use(getSession());\n  app.use(passport.initialize());\n  app.use(passport.session());\n\n  const config = await getOidcConfig();\n\n  const verify: VerifyFunction = async (\n    tokens: client.TokenEndpointResponse & client.TokenEndpointResponseHelpers,\n    verified: passport.AuthenticateCallback\n  ) => {\n    const user = {};\n    updateUserSession(user, tokens);\n    await upsertUser(tokens.claims());\n    verified(null, user);\n  };\n\n  // Keep track of registered strategies\n  const registeredStrategies = new Set<string>();\n\n  // Helper function to ensure strategy exists for a domain\n  const ensureStrategy = (domain: string) => {\n    const strategyName = `replitauth:${domain}`;\n    if (!registeredStrategies.has(strategyName)) {\n      const strategy = new Strategy(\n        {\n          name: strategyName,\n          config,\n          scope: \"openid email profile offline_access\",\n          callbackURL: `https://${domain}/api/callback`,\n        },\n        verify,\n      );\n      passport.use(strategy);\n      registeredStrategies.add(strategyName);\n    }\n  };\n\n  passport.serializeUser((user: Express.User, cb) => cb(null, user));\n  passport.deserializeUser((user: Express.User, cb) => cb(null, user));\n\n  app.get(\"/api/login\", (req, res, next) => {\n    ensureStrategy(req.hostname);\n    passport.authenticate(`replitauth:${req.hostname}`, {\n      prompt: \"login consent\",\n      scope: [\"openid\", \"email\", \"profile\", \"offline_access\"],\n    })(req, res, next);\n  });\n\n  app.get(\"/api/callback\", (req, res, next) => {\n    ensureStrategy(req.hostname);\n    passport.authenticate(`replitauth:${req.hostname}`, {\n      successReturnToOrRedirect: \"/\",\n      failureRedirect: \"/api/login\",\n    })(req, res, next);\n  });\n\n  app.get(\"/api/logout\", (req, res) => {\n    req.logout(() => {\n      res.redirect(\n        client.buildEndSessionUrl(config, {\n          client_id: process.env.REPL_ID!,\n          post_logout_redirect_uri: `${req.protocol}://${req.hostname}`,\n        }).href\n      );\n    });\n  });\n}\n\nexport const isAuthenticated: RequestHandler = async (req, res, next) => {\n  const user = req.user as any;\n\n  if (!req.isAuthenticated() || !user.expires_at) {\n    return res.status(401).json({ message: \"Unauthorized\" });\n  }\n\n  const now = Math.floor(Date.now() / 1000);\n  if (now <= user.expires_at) {\n    return next();\n  }\n\n  const refreshToken = user.refresh_token;\n  if (!refreshToken) {\n    res.status(401).json({ message: \"Unauthorized\" });\n    return;\n  }\n\n  try {\n    const config = await getOidcConfig();\n    const tokenResponse = await client.refreshTokenGrant(config, refreshToken);\n    updateUserSession(user, tokenResponse);\n    return next();\n  } catch (error) {\n    res.status(401).json({ message: \"Unauthorized\" });\n    return;\n  }\n};\n","size_bytes":4472},"client/src/pages/Benchmarks.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport { Play, CheckCircle2, XCircle, ChevronRight, AlertTriangle } from \"lucide-react\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { isUnauthorizedError } from \"@/lib/authUtils\";\n\ninterface Benchmark {\n  id: string;\n  name: string;\n  description: string;\n  totalControls: number;\n  passedControls: number;\n  failedControls: number;\n  estimatedSavings: number;\n  service: string;\n}\n\nconst benchmarkMetadata: Record<string, { name: string; description: string; totalControls: number; service: string }> = {\n  \"ec2\": {\n    name: \"EC2 Cost Optimization\",\n    description: \"Identify underutilized and idle EC2 instances\",\n    totalControls: 8,\n    service: \"EC2\",\n  },\n  \"ebs\": {\n    name: \"EBS Volume Optimization\",\n    description: \"Find unused and unattached EBS volumes\",\n    totalControls: 5,\n    service: \"EBS\",\n  },\n  \"rds\": {\n    name: \"RDS Database Optimization\",\n    description: \"Optimize RDS instance sizes and storage\",\n    totalControls: 6,\n    service: \"RDS\",\n  },\n  \"s3\": {\n    name: \"S3 Storage Optimization\",\n    description: \"Identify opportunities for S3 storage class optimization\",\n    totalControls: 4,\n    service: \"S3\",\n  },\n  \"elb\": {\n    name: \"Load Balancer Optimization\",\n    description: \"Find unused and idle load balancers\",\n    totalControls: 3,\n    service: \"ELB\",\n  },\n  \"lambda\": {\n    name: \"Lambda Function Optimization\",\n    description: \"Optimize Lambda memory and execution time\",\n    totalControls: 4,\n    service: \"Lambda\",\n  },\n  \"cloudfront\": {\n    name: \"CloudFront Distribution Optimization\",\n    description: \"Optimize CloudFront configurations and caching\",\n    totalControls: 2,\n    service: \"CloudFront\",\n  },\n  \"elasticache\": {\n    name: \"ElastiCache Optimization\",\n    description: \"Identify underutilized ElastiCache clusters\",\n    totalControls: 3,\n    service: \"ElastiCache\",\n  },\n  \"redshift\": {\n    name: \"Redshift Optimization\",\n    description: \"Optimize Redshift cluster sizing and usage\",\n    totalControls: 2,\n    service: \"Redshift\",\n  },\n};\n\n// Normalize benchmark IDs to lowercase for consistent comparison\nconst normalizeId = (id: string) => id.toLowerCase();\n\ninterface ResourceDetail {\n  id: string;\n  resourceId: string;\n  resourceType: string;\n  controlName: string;\n  passed: boolean;\n  reason: string;\n  estimatedSavings: number;\n  executedAt: string;\n}\n\nexport default function Benchmarks() {\n  const { toast } = useToast();\n  const [selectedBenchmarkId, setSelectedBenchmarkId] = useState<string | null>(null);\n  const [showResourcesDialog, setShowResourcesDialog] = useState(false);\n\n  const { data: apiResults, isLoading } = useQuery<Array<{\n    id: string;\n    awsAccountId: string;\n    benchmarkId: string;\n    benchmarkName: string;\n    controlsPassed: number;\n    controlsFailed: number;\n    estimatedSavings: number;\n    executedAt: string;\n  }>>({\n    queryKey: [\"/api/benchmarks/results\"],\n  });\n\n  // Fetch resource details when a benchmark is selected\n  // The queryKey array gets joined with \"/\" by the default queryFn\n  const { data: resourceDetails, isLoading: isLoadingResources } = useQuery<ResourceDetail[]>({\n    queryKey: [\"/api/benchmarks\", selectedBenchmarkId, \"resources\"],\n    enabled: !!selectedBenchmarkId && showResourcesDialog,\n  });\n\n  // Merge API results with metadata, showing all available benchmarks\n  const benchmarks: (Benchmark & { resultId?: string })[] = Object.keys(benchmarkMetadata).map((benchmarkId) => {\n    const metadata = benchmarkMetadata[benchmarkId];\n    const apiResult = apiResults?.find(r => normalizeId(r.benchmarkId) === normalizeId(benchmarkId));\n    \n    return {\n      id: benchmarkId,\n      name: metadata.name,\n      description: metadata.description,\n      totalControls: metadata.totalControls,\n      service: metadata.service,\n      passedControls: apiResult?.controlsPassed || 0,\n      failedControls: apiResult?.controlsFailed || 0,\n      estimatedSavings: apiResult?.estimatedSavings || 0,\n      resultId: apiResult?.id, // Store the actual result ID for fetching resources\n    };\n  });\n\n  const runBenchmarkMutation = useMutation({\n    mutationFn: async (benchmarkId: string) => {\n      await apiRequest(\"POST\", \"/api/benchmarks/run\", { benchmarkId, useSteampipe: false });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/benchmarks/results\"] });\n      toast({\n        title: \"Success\",\n        description: \"Benchmark executed successfully\",\n      });\n    },\n    onError: (error: Error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/api/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: \"Error\",\n        description: \"Failed to run benchmark\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const formatCurrency = (cents: number) => {\n    return `$${(cents / 100).toFixed(2)}`;\n  };\n\n  const getProgressPercentage = (passed: number, total: number) => {\n    if (total === 0) return 0;\n    return Math.round((passed / total) * 100);\n  };\n\n  const handleViewResources = (benchmarkResultId: string, benchmarkName: string) => {\n    setSelectedBenchmarkId(benchmarkResultId);\n    setShowResourcesDialog(true);\n  };\n\n  const selectedBenchmarkName = selectedBenchmarkId\n    ? apiResults?.find(r => r.id === selectedBenchmarkId)?.benchmarkName\n    : null;\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div>\n        <h1 className=\"text-3xl font-semibold\">Benchmarks</h1>\n        <p className=\"text-sm text-muted-foreground mt-2\">\n          Run cost optimization benchmarks using AWS Cost Explorer for accurate savings calculations based on your actual billing data\n        </p>\n      </div>\n\n      {isLoading ? (\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n          {[1, 2, 3, 4, 5, 6].map((i) => (\n            <Card key={i}>\n              <CardHeader className=\"space-y-2\">\n                <Skeleton className=\"h-6 w-40\" />\n                <Skeleton className=\"h-4 w-full\" />\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <Skeleton className=\"h-4 w-full\" />\n                <Skeleton className=\"h-20 w-full\" />\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n      ) : (\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n          {benchmarks.map((benchmark) => {\n            const progress = getProgressPercentage(\n              benchmark.passedControls,\n              benchmark.totalControls\n            );\n\n            return (\n              <Card key={benchmark.id} className=\"hover-elevate\">\n                <CardHeader className=\"space-y-2 pb-4\">\n                  <div className=\"flex items-start justify-between gap-2\">\n                    <div className=\"space-y-1\">\n                      <CardTitle className=\"text-lg\">{benchmark.name}</CardTitle>\n                      <Badge variant=\"secondary\" data-testid={`badge-service-${benchmark.id}`}>\n                        {benchmark.service}\n                      </Badge>\n                    </div>\n                  </div>\n                  <p className=\"text-sm text-muted-foreground\">\n                    {benchmark.description}\n                  </p>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className=\"space-y-2\">\n                    <div className=\"flex items-center justify-between text-sm\">\n                      <span className=\"text-muted-foreground\">Progress</span>\n                      <span className=\"font-medium\">{progress}%</span>\n                    </div>\n                    <Progress value={progress} />\n                  </div>\n\n                  <div className=\"flex items-center justify-between text-sm\">\n                    <span className=\"flex items-center gap-1 text-muted-foreground\">\n                      <CheckCircle2 className=\"h-3 w-3\" />\n                      Passed\n                    </span>\n                    <span className=\"font-medium\" data-testid={`text-passed-${benchmark.id}`}>\n                      {benchmark.passedControls}/{benchmark.totalControls}\n                    </span>\n                  </div>\n\n                  <div className=\"flex items-center justify-between text-sm\">\n                    <span className=\"flex items-center gap-1 text-muted-foreground\">\n                      <XCircle className=\"h-3 w-3\" />\n                      Failed\n                    </span>\n                    <span className=\"font-medium text-destructive\" data-testid={`text-failed-${benchmark.id}`}>\n                      {benchmark.failedControls}\n                    </span>\n                  </div>\n\n                  <div className=\"flex items-center justify-between pt-2 border-t\">\n                    <span className=\"text-sm text-muted-foreground\">Est. Savings</span>\n                    <span className=\"text-sm text-muted-foreground italic\" data-testid={`text-savings-${benchmark.id}`}>\n                      {benchmark.estimatedSavings === 0 ? \"TBD\" : formatCurrency(benchmark.estimatedSavings) + \"/mo\"}\n                    </span>\n                  </div>\n\n                  <div className=\"flex gap-2\">\n                    <Button\n                      className=\"flex-1\"\n                      variant=\"outline\"\n                      onClick={() => runBenchmarkMutation.mutate(benchmark.id)}\n                      disabled={runBenchmarkMutation.isPending}\n                      data-testid={`button-run-${benchmark.id}`}\n                    >\n                      <Play className=\"h-4 w-4 mr-2\" />\n                      {runBenchmarkMutation.isPending ? \"Running...\" : \"Run\"}\n                    </Button>\n                    {benchmark.resultId && (\n                      <Button\n                        className=\"flex-1\"\n                        variant=\"default\"\n                        onClick={() => handleViewResources(benchmark.resultId!, benchmark.name)}\n                        data-testid={`button-view-resources-${benchmark.id}`}\n                      >\n                        View Resources\n                        <ChevronRight className=\"h-4 w-4 ml-2\" />\n                      </Button>\n                    )}\n                  </div>\n                </CardContent>\n              </Card>\n            );\n          })}\n        </div>\n      )}\n\n      {/* Resource Details Dialog */}\n      <Dialog open={showResourcesDialog} onOpenChange={(open) => {\n        setShowResourcesDialog(open);\n        if (!open && selectedBenchmarkId) {\n          // Clear query data to prevent stale UI\n          queryClient.setQueryData([\"/api/benchmarks\", selectedBenchmarkId, \"resources\"], undefined);\n          // Clear selected benchmark after clearing data\n          setSelectedBenchmarkId(null);\n        }\n      }}>\n        <DialogContent className=\"max-w-4xl max-h-[80vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle>{selectedBenchmarkName || \"Benchmark\"} - Resources</DialogTitle>\n            <DialogDescription>\n              Detailed resource-level cost optimization opportunities\n            </DialogDescription>\n          </DialogHeader>\n\n          {isLoadingResources ? (\n            <div className=\"space-y-4\">\n              <Skeleton className=\"h-12 w-full\" />\n              <Skeleton className=\"h-12 w-full\" />\n              <Skeleton className=\"h-12 w-full\" />\n            </div>\n          ) : !resourceDetails || !Array.isArray(resourceDetails) || resourceDetails.length === 0 ? (\n            <div className=\"text-center py-8 text-muted-foreground\">\n              <CheckCircle2 className=\"h-12 w-12 mx-auto mb-4 text-green-600\" />\n              <p className=\"text-lg font-medium\">All checks passed!</p>\n              <p className=\"text-sm\">No cost optimization opportunities found.</p>\n            </div>\n          ) : (\n            <div className=\"space-y-4\">\n              <div className=\"rounded-md border\">\n                <Table>\n                  <TableHeader>\n                    <TableRow>\n                      <TableHead>Resource ID</TableHead>\n                      <TableHead>Type</TableHead>\n                      <TableHead>Issue</TableHead>\n                      <TableHead className=\"text-right\">Est. Savings/mo</TableHead>\n                    </TableRow>\n                  </TableHeader>\n                  <TableBody>\n                    {resourceDetails.map((resource) => (\n                      <TableRow key={resource.id} data-testid={`row-resource-${resource.id}`}>\n                        <TableCell className=\"font-mono text-sm\" data-testid={`cell-resource-id-${resource.id}`}>\n                          {resource.resourceId}\n                        </TableCell>\n                        <TableCell>\n                          <Badge variant=\"secondary\">{resource.resourceType}</Badge>\n                        </TableCell>\n                        <TableCell className=\"max-w-md\">\n                          <div className=\"flex items-start gap-2\">\n                            <AlertTriangle className=\"h-4 w-4 text-yellow-600 dark:text-yellow-500 mt-0.5 flex-shrink-0\" />\n                            <span className=\"text-sm\">{resource.reason}</span>\n                          </div>\n                        </TableCell>\n                        <TableCell className=\"text-right text-sm text-muted-foreground italic\">\n                          {resource.estimatedSavings === 0 ? \"TBD\" : formatCurrency(resource.estimatedSavings)}\n                        </TableCell>\n                      </TableRow>\n                    ))}\n                  </TableBody>\n                </Table>\n              </div>\n            </div>\n          )}\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","size_bytes":14603},"server/storage.ts":{"content":"import {\n  users,\n  awsAccounts,\n  benchmarkResults,\n  controlResults,\n  queryHistory,\n  type User,\n  type UpsertUser,\n  type AwsAccount,\n  type InsertAwsAccount,\n  type BenchmarkResult,\n  type ControlResult,\n  type QueryHistory,\n} from \"@shared/schema\";\nimport { db } from \"./db\";\nimport { eq, desc, and } from \"drizzle-orm\";\nimport { randomBytes, createCipheriv, createDecipheriv } from \"crypto\";\n\n// Encryption for AWS credentials\nconst ALGORITHM = \"aes-256-cbc\";\nconst ENCRYPTION_KEY = process.env.SESSION_SECRET \n  ? Buffer.from(process.env.SESSION_SECRET.padEnd(32, '0').slice(0, 32))\n  : Buffer.alloc(32);\n\nfunction encrypt(text: string): string {\n  const iv = randomBytes(16);\n  const cipher = createCipheriv(ALGORITHM, ENCRYPTION_KEY, iv);\n  let encrypted = cipher.update(text, \"utf8\", \"hex\");\n  encrypted += cipher.final(\"hex\");\n  return `${iv.toString(\"hex\")}:${encrypted}`;\n}\n\nfunction decrypt(text: string): string {\n  const [ivHex, encryptedHex] = text.split(\":\");\n  const iv = Buffer.from(ivHex, \"hex\");\n  const decipher = createDecipheriv(ALGORITHM, ENCRYPTION_KEY, iv);\n  let decrypted = decipher.update(encryptedHex, \"hex\", \"utf8\");\n  decrypted += decipher.final(\"utf8\");\n  return decrypted;\n}\n\n// Type for AWS account without decrypted secret\nexport type AwsAccountDisplay = Omit<AwsAccount, 'secretAccessKey'> & {\n  secretAccessKey: string; // Will be \"***ENCRYPTED***\"\n};\n\n// Type for individual resource check from AWS service\nexport interface ResourceCheck {\n  id: string;\n  name: string;\n  passed: boolean;\n  resourceId?: string;\n  estimatedSavings: number;\n  reason?: string;\n}\n\nexport interface IStorage {\n  // User operations\n  getUser(id: string): Promise<User | undefined>;\n  getUserByEmail(email: string): Promise<User | undefined>;\n  createUser(userData: { email: string; password: string; firstName?: string; lastName?: string }): Promise<User>;\n  upsertUser(user: UpsertUser): Promise<User>;\n\n  // AWS Account operations (internal - with decrypted secrets for backend use)\n  getAwsAccounts(userId: string): Promise<AwsAccount[]>;\n  getAwsAccount(id: string): Promise<AwsAccount | undefined>;\n  createAwsAccount(account: InsertAwsAccount): Promise<AwsAccount>;\n  deleteAwsAccount(id: string, userId: string): Promise<boolean>;\n  \n  // AWS Account operations (for API responses - secrets masked)\n  getAwsAccountsForDisplay(userId: string): Promise<AwsAccountDisplay[]>;\n  createAwsAccountForDisplay(account: InsertAwsAccount): Promise<AwsAccountDisplay>;\n\n  // Benchmark operations\n  saveBenchmarkResult(\n    result: Omit<BenchmarkResult, \"id\" | \"executedAt\">, \n    checks: ResourceCheck[]\n  ): Promise<BenchmarkResult>;\n  getBenchmarkResults(awsAccountId: string): Promise<BenchmarkResult[]>;\n\n  // Control operations\n  saveControlResult(result: Omit<ControlResult, \"id\" | \"executedAt\">): Promise<ControlResult>;\n  getControlResults(awsAccountId: string): Promise<ControlResult[]>;\n  getControlResultsByBenchmark(benchmarkResultId: string): Promise<ControlResult[]>;\n\n  // Query history operations\n  saveQuery(userId: string, awsAccountId: string | null, query: string, resultJson: any): Promise<QueryHistory>;\n  getQueryHistory(userId: string): Promise<QueryHistory[]>;\n}\n\nexport class DatabaseStorage implements IStorage {\n  // User operations\n  async getUser(id: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.id, id));\n    return user;\n  }\n\n  async getUserByEmail(email: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.email, email));\n    return user;\n  }\n\n  async createUser(userData: { email: string; password: string; firstName?: string; lastName?: string }): Promise<User> {\n    const [user] = await db\n      .insert(users)\n      .values(userData)\n      .returning();\n    return user;\n  }\n\n  async upsertUser(userData: UpsertUser): Promise<User> {\n    const [user] = await db\n      .insert(users)\n      .values(userData)\n      .onConflictDoUpdate({\n        target: users.id,\n        set: {\n          ...userData,\n          updatedAt: new Date(),\n        },\n      })\n      .returning();\n    return user;\n  }\n\n  // AWS Account operations\n  async getAwsAccounts(userId: string): Promise<AwsAccount[]> {\n    const accounts = await db\n      .select()\n      .from(awsAccounts)\n      .where(eq(awsAccounts.userId, userId))\n      .orderBy(desc(awsAccounts.createdAt));\n\n    // Decrypt secret access keys before returning\n    return accounts.map(account => ({\n      ...account,\n      secretAccessKey: decrypt(account.secretAccessKey),\n    }));\n  }\n\n  async getAwsAccount(id: string): Promise<AwsAccount | undefined> {\n    const [account] = await db\n      .select()\n      .from(awsAccounts)\n      .where(eq(awsAccounts.id, id));\n\n    if (!account) return undefined;\n\n    return {\n      ...account,\n      secretAccessKey: decrypt(account.secretAccessKey),\n    };\n  }\n\n  async createAwsAccount(accountData: InsertAwsAccount): Promise<AwsAccount> {\n    const [account] = await db\n      .insert(awsAccounts)\n      .values({\n        ...accountData,\n        secretAccessKey: encrypt(accountData.secretAccessKey),\n      })\n      .returning();\n\n    return {\n      ...account,\n      secretAccessKey: decrypt(account.secretAccessKey),\n    };\n  }\n\n  async deleteAwsAccount(id: string, userId: string): Promise<boolean> {\n    const result = await db\n      .delete(awsAccounts)\n      .where(\n        and(\n          eq(awsAccounts.id, id),\n          eq(awsAccounts.userId, userId)\n        )\n      )\n      .returning();\n    \n    return result.length > 0;\n  }\n\n  // AWS Account operations for display (secrets masked)\n  async getAwsAccountsForDisplay(userId: string): Promise<AwsAccountDisplay[]> {\n    const accounts = await db\n      .select()\n      .from(awsAccounts)\n      .where(eq(awsAccounts.userId, userId))\n      .orderBy(desc(awsAccounts.createdAt));\n\n    // Return without decrypting - just mask the encrypted value\n    return accounts.map(account => ({\n      ...account,\n      secretAccessKey: \"***ENCRYPTED***\",\n    }));\n  }\n\n  async createAwsAccountForDisplay(accountData: InsertAwsAccount): Promise<AwsAccountDisplay> {\n    const [account] = await db\n      .insert(awsAccounts)\n      .values({\n        ...accountData,\n        secretAccessKey: encrypt(accountData.secretAccessKey),\n      })\n      .returning();\n\n    return {\n      ...account,\n      secretAccessKey: \"***ENCRYPTED***\",\n    };\n  }\n\n  // Benchmark operations\n  async saveBenchmarkResult(\n    result: Omit<BenchmarkResult, \"id\" | \"executedAt\">,\n    checks: ResourceCheck[]\n  ): Promise<BenchmarkResult> {\n    const [saved] = await db\n      .insert(benchmarkResults)\n      .values(result)\n      .returning();\n    \n    // Save individual resource checks as control results\n    if (checks.length > 0) {\n      const controlResultsToInsert = checks.map(check => ({\n        benchmarkResultId: saved.id,\n        awsAccountId: result.awsAccountId,\n        controlId: check.id,\n        controlName: check.name,\n        resourceId: check.resourceId || null,\n        resourceType: result.benchmarkId.toUpperCase(),\n        passed: check.passed,\n        reason: check.reason,\n        estimatedSavings: check.estimatedSavings,\n      }));\n      \n      await db.insert(controlResults).values(controlResultsToInsert);\n    }\n    \n    return saved;\n  }\n\n  async getBenchmarkResults(awsAccountId: string): Promise<BenchmarkResult[]> {\n    return await db\n      .select()\n      .from(benchmarkResults)\n      .where(eq(benchmarkResults.awsAccountId, awsAccountId))\n      .orderBy(desc(benchmarkResults.executedAt));\n  }\n\n  // Control operations\n  async saveControlResult(result: Omit<ControlResult, \"id\" | \"executedAt\">): Promise<ControlResult> {\n    const [saved] = await db\n      .insert(controlResults)\n      .values(result)\n      .returning();\n    return saved;\n  }\n\n  async getControlResults(awsAccountId: string): Promise<ControlResult[]> {\n    return await db\n      .select()\n      .from(controlResults)\n      .where(eq(controlResults.awsAccountId, awsAccountId))\n      .orderBy(desc(controlResults.executedAt));\n  }\n\n  async getControlResultsByBenchmark(benchmarkResultId: string): Promise<ControlResult[]> {\n    return await db\n      .select()\n      .from(controlResults)\n      .where(eq(controlResults.benchmarkResultId, benchmarkResultId))\n      .orderBy(desc(controlResults.executedAt));\n  }\n\n  // Query history operations\n  async saveQuery(userId: string, awsAccountId: string | null, query: string, resultJson: any): Promise<QueryHistory> {\n    const [saved] = await db\n      .insert(queryHistory)\n      .values({\n        userId,\n        awsAccountId,\n        query,\n        resultJson,\n      })\n      .returning();\n    return saved;\n  }\n\n  async getQueryHistory(userId: string): Promise<QueryHistory[]> {\n    return await db\n      .select()\n      .from(queryHistory)\n      .where(eq(queryHistory.userId, userId))\n      .orderBy(desc(queryHistory.executedAt))\n      .limit(50);\n  }\n}\n\nexport const storage = new DatabaseStorage();\n","size_bytes":9021},"server/routes.ts":{"content":"import type { Express } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { storage } from \"./storage\";\nimport { setupAuth, isAuthenticated, hashPassword, verifyPassword } from \"./customAuth\";\nimport { \n  insertAwsAccountSchema, \n  costSummarySchema, \n  signupSchema,\n  loginSchema,\n  type CostSummary,\n  type ServiceBreakdown,\n  type ServiceResources,\n  type CostRecommendations,\n} from \"@shared/schema\";\nimport { z } from \"zod\";\nimport { AwsService } from \"./aws-service\";\nimport { steampipeService } from \"./steampipe-service\";\nimport { PricingService } from \"./pricing-service\";\n\n/**\n * Parse AWS ARN to extract resource ID for Cost Explorer queries\n * Cost Explorer expects just the resource ID (not the full ARN or namespace prefix)\n * \n * Examples:\n * Slash-delimited (EC2, ELB, etc.):\n *   - arn:aws:ec2:region:account:instance/i-123  i-123\n *   - arn:aws:ec2:region:account:snapshot/snap-123  snap-123\n *   - arn:aws:elasticloadbalancing:region:account:loadbalancer/app/my-lb/123  app/my-lb/123\n * \n * Colon-delimited (RDS, Lambda, etc.):\n *   - arn:aws:rds:region:account:db:mydb  mydb\n *   - arn:aws:lambda:region:account:function:myfunc  myfunc\n *   - arn:aws:rds:region:account:snapshot:rds:mydb-snap  rds:mydb-snap\n */\nfunction parseResourceIdFromArn(arn: string): string {\n  // If not an ARN, return as-is (might already be a resource ID)\n  if (!arn.startsWith('arn:')) {\n    return arn;\n  }\n\n  // Parse ARN: arn:aws:service:region:account:resource\n  const parts = arn.split(':');\n  if (parts.length < 6) {\n    return arn; // Invalid ARN, return as-is\n  }\n\n  // The resource part is everything after the 5th colon\n  const resourcePart = parts.slice(5).join(':');\n\n  // For slash-delimited resources (EC2, EBS, ELB, DynamoDB, etc.)\n  // Format: resource-type/resource-id or resource-type/segment1/segment2/...\n  // Examples:\n  //   - instance/i-123  i-123\n  //   - snapshot/snap-123  snap-123  \n  //   - loadbalancer/app/my-lb/123  app/my-lb/123 (multi-segment)\n  if (resourcePart.includes('/')) {\n    const firstSlashIndex = resourcePart.indexOf('/');\n    // Return everything after the first slash (preserves multi-segment IDs)\n    return resourcePart.substring(firstSlashIndex + 1);\n  }\n  \n  // For colon-delimited resources (RDS, Lambda, etc.)\n  // Format: resource-type:resource-id\n  // Examples:\n  //   - db:mydb  mydb\n  //   - function:myfunc  myfunc\n  //   - snapshot:rds:mydb-snapshot  rds:mydb-snapshot (multi-colon, keep rest)\n  if (resourcePart.includes(':')) {\n    const firstColonIndex = resourcePart.indexOf(':');\n    // Return everything after the first colon (preserves multi-colon IDs)\n    return resourcePart.substring(firstColonIndex + 1);\n  }\n  \n  // For resources without delimiters, return as-is\n  return resourcePart;\n}\n\n/**\n * Determine Cost Explorer service name from ARN\n * Maps AWS resource ARNs to official Cost Explorer SERVICE dimension values\n */\nfunction getCostExplorerServiceFromArn(arn: string): string | null {\n  if (!arn.startsWith('arn:')) {\n    return null; // Not an ARN, can't determine service\n  }\n\n  // Parse ARN: arn:aws:service:region:account:resource-type/resource-id\n  const parts = arn.split(':');\n  if (parts.length < 6) {\n    return null;\n  }\n\n  const service = parts[2]; // e.g., \"ec2\", \"rds\", \"s3\"\n  const resourcePart = parts.slice(5).join(':'); // Everything after account ID\n\n  // For EC2 service, determine if it's compute or other based on resource type\n  if (service === 'ec2') {\n    if (resourcePart.startsWith('instance/')) {\n      return 'Amazon Elastic Compute Cloud - Compute';\n    } else if (resourcePart.startsWith('volume/') || resourcePart.startsWith('snapshot/')) {\n      return 'EC2 - Other'; // EBS volumes and snapshots\n    } else if (resourcePart.startsWith('elastic-ip/') || resourcePart.startsWith('address/')) {\n      return 'EC2 - Other'; // Elastic IPs\n    } else {\n      return 'Amazon Elastic Compute Cloud - Compute'; // Default to compute\n    }\n  }\n\n  // Service name mappings\n  const serviceMap: Record<string, string | null> = {\n    'rds': 'Amazon Relational Database Service',\n    'elasticache': 'Amazon ElastiCache',\n    'redshift': 'Amazon Redshift',\n    'lambda': 'AWS Lambda',\n    'elasticloadbalancing': 'Amazon Elastic Load Balancing',\n    's3': null, // Not supported for resource-level queries\n    'dynamodb': null, // Not supported for resource-level queries\n  };\n\n  return serviceMap[service] || null;\n}\n\n// Simple in-memory cache for cost data (to avoid excessive Cost Explorer API calls)\ninterface CostCache {\n  data: CostSummary;\n  timestamp: number;\n  userId: string;\n  includeCredits: boolean;\n}\n\nconst costCache: Map<string, CostCache> = new Map();\nconst CACHE_TTL = 6 * 60 * 60 * 1000; // 6 hours in milliseconds\n\nfunction getCachedCost(userId: string, accountId: string, includeCredits: boolean): CostSummary | null {\n  const cacheKey = `${userId}-${accountId}-${includeCredits}`;\n  const cached = costCache.get(cacheKey);\n  \n  if (cached && Date.now() - cached.timestamp < CACHE_TTL) {\n    return cached.data;\n  }\n  \n  // Remove expired cache\n  if (cached) {\n    costCache.delete(cacheKey);\n  }\n  \n  return null;\n}\n\nfunction setCachedCost(userId: string, accountId: string, includeCredits: boolean, data: CostSummary): void {\n  const cacheKey = `${userId}-${accountId}-${includeCredits}`;\n  costCache.set(cacheKey, {\n    data,\n    timestamp: Date.now(),\n    userId,\n    includeCredits,\n  });\n}\n\nfunction invalidateCostCache(userId: string, accountId: string): void {\n  const keys = Array.from(costCache.keys());\n  keys.forEach(key => {\n    if (key.startsWith(`${userId}-${accountId}-`)) {\n      costCache.delete(key);\n    }\n  });\n}\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n  // Auth middleware\n  setupAuth(app);\n\n  // Auth routes\n  app.post('/api/auth/signup', async (req, res) => {\n    try {\n      const input = signupSchema.parse(req.body);\n      \n      // Check if user already exists\n      const existingUser = await storage.getUserByEmail(input.email);\n      if (existingUser) {\n        return res.status(400).json({ message: \"Email already registered\" });\n      }\n      \n      // Hash password and create user\n      const hashedPassword = await hashPassword(input.password);\n      const user = await storage.createUser({\n        email: input.email,\n        password: hashedPassword,\n        firstName: input.firstName,\n        lastName: input.lastName,\n      });\n      \n      // Create session\n      req.session.userId = user.id;\n      \n      // Return user without password\n      const { password: _, ...userWithoutPassword } = user;\n      res.json(userWithoutPassword);\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ message: \"Invalid input\", errors: error.errors });\n      }\n      console.error(\"Error during signup:\", error);\n      res.status(500).json({ message: \"Failed to create account\" });\n    }\n  });\n\n  app.post('/api/auth/login', async (req, res) => {\n    try {\n      const input = loginSchema.parse(req.body);\n      \n      // Find user by email\n      const user = await storage.getUserByEmail(input.email);\n      if (!user) {\n        return res.status(401).json({ message: \"Invalid email or password\" });\n      }\n      \n      // Verify password\n      const isValid = await verifyPassword(input.password, user.password);\n      if (!isValid) {\n        return res.status(401).json({ message: \"Invalid email or password\" });\n      }\n      \n      // Create session\n      req.session.userId = user.id;\n      \n      // Return user without password\n      const { password: _, ...userWithoutPassword } = user;\n      res.json(userWithoutPassword);\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ message: \"Invalid input\", errors: error.errors });\n      }\n      console.error(\"Error during login:\", error);\n      res.status(500).json({ message: \"Login failed\" });\n    }\n  });\n\n  app.post('/api/auth/logout', (req, res) => {\n    req.session.destroy((err) => {\n      if (err) {\n        return res.status(500).json({ message: \"Failed to logout\" });\n      }\n      res.json({ message: \"Logged out successfully\" });\n    });\n  });\n\n  app.get('/api/auth/user', isAuthenticated, async (req, res) => {\n    try {\n      // User is already attached to req by isAuthenticated middleware\n      res.json(req.user);\n    } catch (error) {\n      console.error(\"Error fetching user:\", error);\n      res.status(500).json({ message: \"Failed to fetch user\" });\n    }\n  });\n\n  // AWS Accounts routes\n  app.get(\"/api/aws-accounts\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const accounts = await storage.getAwsAccountsForDisplay(userId);\n      res.json(accounts);\n    } catch (error) {\n      console.error(\"Error fetching AWS accounts:\", error);\n      res.status(500).json({ message: \"Failed to fetch AWS accounts\" });\n    }\n  });\n\n  app.post(\"/api/aws-accounts\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const accountData = insertAwsAccountSchema.parse({\n        ...req.body,\n        userId,\n      });\n      \n      const account = await storage.createAwsAccountForDisplay(accountData);\n      \n      // Invalidate cost cache when new account is added\n      invalidateCostCache(userId, account.id);\n      \n      res.json(account);\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        res.status(400).json({ message: \"Invalid input\", errors: error.errors });\n        return;\n      }\n      console.error(\"Error creating AWS account:\", error);\n      res.status(500).json({ message: \"Failed to create AWS account\" });\n    }\n  });\n\n  app.delete(\"/api/aws-accounts/:id\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const deleted = await storage.deleteAwsAccount(req.params.id, userId);\n      \n      if (!deleted) {\n        res.status(404).json({ message: \"AWS account not found or access denied\" });\n        return;\n      }\n      \n      // Invalidate cost cache for this account\n      invalidateCostCache(userId, req.params.id);\n      \n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error deleting AWS account:\", error);\n      res.status(500).json({ message: \"Failed to delete AWS account\" });\n    }\n  });\n\n  // Dashboard stats route\n  app.get(\"/api/dashboard/stats\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const accounts = await storage.getAwsAccounts(userId);\n      \n      if (accounts.length === 0) {\n        res.json({\n          totalSavings: 0,\n          highRiskResources: 0,\n          failedControls: 0,\n          passedControls: 0,\n          savingsByService: [],\n          controlsByBenchmark: [],\n        });\n        return;\n      }\n\n      // Aggregate data from all accounts\n      let totalSavings = 0;\n      let totalFailedControls = 0;\n      let totalPassedControls = 0;\n      const savingsByService: Record<string, number> = {};\n\n      for (const account of accounts) {\n        const benchmarks = await storage.getBenchmarkResults(account.id);\n        for (const benchmark of benchmarks) {\n          totalSavings += benchmark.estimatedSavings;\n          totalFailedControls += benchmark.controlsFailed;\n          totalPassedControls += benchmark.controlsPassed;\n          \n          savingsByService[benchmark.benchmarkName] = \n            (savingsByService[benchmark.benchmarkName] || 0) + benchmark.estimatedSavings;\n        }\n      }\n\n      const savingsByServiceArray = Object.entries(savingsByService).map(([service, savings]) => ({\n        service,\n        savings,\n      }));\n\n      res.json({\n        totalSavings,\n        highRiskResources: totalFailedControls,\n        failedControls: totalFailedControls,\n        passedControls: totalPassedControls,\n        savingsByService: savingsByServiceArray,\n        controlsByBenchmark: [],\n      });\n    } catch (error) {\n      console.error(\"Error fetching dashboard stats:\", error);\n      res.status(500).json({ message: \"Failed to fetch dashboard stats\" });\n    }\n  });\n\n  // Benchmarks routes\n  app.get(\"/api/benchmarks/results\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const accounts = await storage.getAwsAccounts(userId);\n      \n      let allResults: any[] = [];\n      for (const account of accounts) {\n        const results = await storage.getBenchmarkResults(account.id);\n        allResults = [...allResults, ...results];\n      }\n      \n      res.json(allResults);\n    } catch (error) {\n      console.error(\"Error fetching benchmark results:\", error);\n      res.status(500).json({ message: \"Failed to fetch benchmark results\" });\n    }\n  });\n\n  app.post(\"/api/benchmarks/run\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const { benchmarkId, useSteampipe } = req.body;\n      \n      // Validate benchmarkId\n      const validBenchmarks = ['ec2', 'rds', 's3', 'dynamodb', 'elasticache', 'redshift', 'lambda'];\n      if (!benchmarkId || !validBenchmarks.includes(benchmarkId)) {\n        res.status(400).json({ \n          message: \"Invalid benchmark ID\", \n          validBenchmarks \n        });\n        return;\n      }\n      \n      const accounts = await storage.getAwsAccounts(userId);\n      if (accounts.length === 0) {\n        res.status(400).json({ message: \"No AWS accounts connected. Please add an AWS account first.\" });\n        return;\n      }\n\n      const account = accounts[0];\n      \n      // Validate credentials exist\n      if (!account.accessKeyId || !account.secretAccessKey) {\n        res.status(400).json({ message: \"AWS credentials are missing or invalid\" });\n        return;\n      }\n      \n      // Use Steampipe if requested (for accurate savings calculation)\n      if (useSteampipe) {\n        try {\n          const steampipeResult = await steampipeService.runBenchmark(\n            `aws_thrifty.benchmark.${benchmarkId}`,\n            account.accessKeyId,\n            account.secretAccessKey,\n            account.region\n          );\n\n          // Create pricing service to calculate savings\n          const pricingService = new PricingService({\n            accessKeyId: account.accessKeyId,\n            secretAccessKey: account.secretAccessKey,\n            region: account.region,\n          });\n\n          // Count resources by service for better cost distribution\n          const resourceCountByService: Record<string, number> = {};\n          for (const control of steampipeResult.controls) {\n            if (control.status !== 'ok') {\n              const serviceCode = getCostExplorerServiceFromArn(control.resource);\n              if (serviceCode) {\n                resourceCountByService[serviceCode] = (resourceCountByService[serviceCode] || 0) + 1;\n              }\n            }\n          }\n\n          // Calculate savings for each control\n          const checksWithSavings = await Promise.all(\n            steampipeResult.controls.map(async (control) => {\n              let estimatedSavings = 0;\n\n              if (control.status !== 'ok') {\n                try {\n                  // Extract resource ID from ARN\n                  const resourceId = parseResourceIdFromArn(control.resource);\n                  \n                  // Determine Cost Explorer service name from ARN\n                  const serviceCode = getCostExplorerServiceFromArn(control.resource);\n                  \n                  // Skip if service not supported for resource-level queries\n                  if (!serviceCode) {\n                    console.warn(`Cost Explorer resource-level data not available for ${control.resource}`);\n                    estimatedSavings = 0;\n                  } else {\n                    // Pass resource count for this service to enable accurate cost distribution\n                    const resourceCount = resourceCountByService[serviceCode];\n                    estimatedSavings = await pricingService.calculateSavingsForControlWithService(\n                      control.name,\n                      resourceId,\n                      serviceCode,\n                      resourceCount\n                    );\n                  }\n                } catch (error) {\n                  console.error(`Error calculating savings for ${control.name}:`, error);\n                }\n              }\n\n              return {\n                id: control.name,\n                name: control.name,\n                passed: control.status === 'ok',\n                resourceId: control.resource,\n                estimatedSavings,\n                reason: control.reason,\n              };\n            })\n          );\n\n          const controlsPassed = steampipeResult.summary.status.ok;\n          const controlsFailed = \n            steampipeResult.summary.status.alarm + \n            steampipeResult.summary.status.error;\n\n          // Calculate total savings\n          const totalSavings = checksWithSavings.reduce(\n            (sum, check) => sum + check.estimatedSavings,\n            0\n          );\n\n          // Save the benchmark result\n          await storage.saveBenchmarkResult({\n            awsAccountId: account.id,\n            benchmarkId: benchmarkId,\n            benchmarkName: steampipeResult.title,\n            controlsPassed,\n            controlsFailed,\n            estimatedSavings: totalSavings,\n            resultJson: { \n              steampipe: true,\n              checks: checksWithSavings,\n              rawResult: steampipeResult \n            },\n          }, checksWithSavings);\n\n          res.json({ \n            success: true, \n            result: {\n              benchmarkId,\n              benchmarkName: steampipeResult.title,\n              checks: checksWithSavings,\n              controlsPassed,\n              controlsFailed,\n              estimatedSavings: totalSavings,\n            }\n          });\n          return;\n        } catch (steampipeError: any) {\n          console.error('Steampipe benchmark failed, falling back to AWS SDK:', steampipeError);\n          // Fall through to use AWS SDK if Steampipe fails\n        }\n      }\n      \n      // Use real AWS scanning with decrypted credentials\n      const awsService = new AwsService({\n        accessKeyId: account.accessKeyId,\n        secretAccessKey: account.secretAccessKey,\n        region: account.region,\n      });\n\n      // Run the actual benchmark against real AWS resources\n      const result = await awsService.runBenchmark(benchmarkId);\n      \n      // Save the benchmark result to database (including individual resource checks)\n      await storage.saveBenchmarkResult({\n        awsAccountId: account.id,\n        benchmarkId: result.benchmarkId,\n        benchmarkName: result.benchmarkName,\n        controlsPassed: result.controlsPassed,\n        controlsFailed: result.controlsFailed,\n        estimatedSavings: result.estimatedSavings,\n        resultJson: { checks: result.checks },\n      }, result.checks);\n\n      res.json({ success: true, result });\n    } catch (error: any) {\n      console.error(\"Error running benchmark:\", error);\n      \n      // Provide more specific error messages for AWS credential issues\n      if (error.name === 'CredentialsError' || error.name === 'InvalidClientTokenId') {\n        res.status(401).json({ \n          message: \"AWS credentials are invalid or expired. Please update your credentials.\" \n        });\n        return;\n      }\n      \n      if (error.name === 'UnauthorizedException' || error.name === 'AccessDeniedException') {\n        res.status(403).json({ \n          message: \"AWS credentials do not have sufficient permissions to run this benchmark.\" \n        });\n        return;\n      }\n      \n      if (error.message?.includes('Unknown benchmark')) {\n        res.status(400).json({ message: error.message });\n        return;\n      }\n      \n      res.status(500).json({ \n        message: \"Failed to run benchmark. Please check your AWS credentials and try again.\" \n      });\n    }\n  });\n\n  // Get detailed resource checks for a specific benchmark (only failed checks)\n  app.get(\"/api/benchmarks/:id/resources\", isAuthenticated, async (req: any, res) => {\n    try {\n      const benchmarkResultId = req.params.id;\n      const resources = await storage.getControlResultsByBenchmark(benchmarkResultId);\n      \n      // Only return failed checks (optimization opportunities)\n      // Treat undefined/null as failed (optimization opportunities)\n      const failedResources = resources\n        .filter(control => control.passed !== true)\n        .map(control => ({\n          id: control.id,\n          resourceId: control.resourceId || 'N/A',\n          resourceType: control.resourceType || 'Unknown',\n          controlName: control.controlName,\n          passed: control.passed,\n          reason: control.reason || `Resource optimization opportunity: ${control.controlName}`,\n          estimatedSavings: control.estimatedSavings,\n          executedAt: control.executedAt,\n        }));\n      \n      res.json(failedResources);\n    } catch (error) {\n      console.error(\"Error fetching benchmark resources:\", error);\n      res.status(500).json({ message: \"Failed to fetch benchmark resources\" });\n    }\n  });\n\n  // Get active AWS services (to show only relevant benchmarks)\n  app.get(\"/api/benchmarks/active-services\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const accounts = await storage.getAwsAccounts(userId);\n      \n      if (accounts.length === 0) {\n        res.json({ services: [] });\n        return;\n      }\n\n      const account = accounts[0];\n      \n      // Validate credentials exist\n      if (!account.accessKeyId || !account.secretAccessKey) {\n        res.json({ services: [], error: \"AWS credentials are missing\" });\n        return;\n      }\n      \n      const awsService = new AwsService({\n        accessKeyId: account.accessKeyId,\n        secretAccessKey: account.secretAccessKey,\n        region: account.region,\n      });\n\n      const activeServices = await awsService.getActiveServices();\n      res.json({ services: activeServices });\n    } catch (error: any) {\n      console.error(\"Error fetching active services:\", error);\n      \n      // Provide helpful error messages\n      if (error.name === 'CredentialsError' || error.name === 'InvalidClientTokenId') {\n        res.json({ \n          services: [], \n          error: \"AWS credentials are invalid or expired\" \n        });\n        return;\n      }\n      \n      res.json({ \n        services: [], \n        error: \"Failed to detect active services\" \n      });\n    }\n  });\n\n  // Cost Summary route - returns current vs previous month cost comparison\n  app.get(\"/api/costs/summary\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const includeCredits = req.query.includeCredits !== 'false'; // Default to true\n      \n      const accounts = await storage.getAwsAccounts(userId);\n      if (accounts.length === 0) {\n        res.status(400).json({ \n          message: \"No AWS accounts connected. Please add an AWS account first.\" \n        });\n        return;\n      }\n\n      const account = accounts[0];\n      \n      // Check cache first (with account ID)\n      const cachedData = getCachedCost(userId, account.id, includeCredits);\n      if (cachedData) {\n        res.json(cachedData);\n        return;\n      }\n      \n      // Validate credentials exist\n      if (!account.accessKeyId || !account.secretAccessKey) {\n        res.status(400).json({ \n          message: \"AWS credentials are missing or invalid\" \n        });\n        return;\n      }\n      \n      const awsService = new AwsService({\n        accessKeyId: account.accessKeyId,\n        secretAccessKey: account.secretAccessKey,\n        region: account.region,\n      });\n\n      const costSummary = await awsService.getCostSummary(includeCredits);\n      \n      // Validate response against schema before caching\n      const validatedCostSummary = costSummarySchema.parse(costSummary);\n      \n      // Cache the validated result (with account ID)\n      setCachedCost(userId, account.id, includeCredits, validatedCostSummary);\n      \n      res.json(validatedCostSummary);\n    } catch (error: any) {\n      console.error(\"Error fetching cost summary:\", error);\n      \n      // Provide helpful error messages\n      if (error.name === 'AccessDeniedException' || error.message?.includes('permission')) {\n        res.status(403).json({ \n          message: \"AWS credentials do not have permission to access Cost Explorer. Please ensure your IAM user has ce:GetCostAndUsage permission.\" \n        });\n        return;\n      }\n      \n      if (error.name === 'DataUnavailableException' || error.message?.includes('not available')) {\n        res.status(503).json({ \n          message: \"Cost Explorer data is not available yet. It may take 24 hours for data to appear after enabling Cost Explorer.\" \n        });\n        return;\n      }\n      \n      res.status(500).json({ \n        message: error.message || \"Failed to fetch cost summary\" \n      });\n    }\n  });\n\n  // All Services Costs route - returns ALL services with costs (not just top 5)\n  app.get(\"/api/costs/services\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const includeCredits = req.query.includeCredits !== 'false';\n      \n      const accounts = await storage.getAwsAccounts(userId);\n      if (accounts.length === 0) {\n        res.status(400).json({ \n          message: \"No AWS accounts connected. Please add an AWS account first.\",\n          action: \"Go to AWS Accounts page to connect your first account.\"\n        });\n        return;\n      }\n\n      // TODO: Add multi-account support - currently showing costs for first account only\n      // Future enhancement: aggregate costs across all accounts or allow account selection\n      const account = accounts[0];\n      \n      if (!account.accessKeyId || !account.secretAccessKey) {\n        res.status(400).json({ \n          message: \"AWS credentials are missing or invalid\" \n        });\n        return;\n      }\n      \n      const awsService = new AwsService({\n        accessKeyId: account.accessKeyId,\n        secretAccessKey: account.secretAccessKey,\n        region: account.region,\n      });\n\n      const services: ServiceBreakdown[] = await awsService.getAllServicesCosts(includeCredits);\n      res.json(services);\n    } catch (error: any) {\n      console.error(\"Error fetching services costs:\", error);\n      \n      if (error.name === 'AccessDeniedException' || error.message?.includes('permission')) {\n        res.status(403).json({ \n          message: \"AWS credentials do not have permission to access Cost Explorer.\",\n          action: \"Add the 'ce:GetCostAndUsage' permission to your IAM user or role in the AWS Console.\"\n        });\n        return;\n      }\n      \n      res.status(500).json({ \n        message: error.message || \"Failed to fetch services costs\" \n      });\n    }\n  });\n\n  // Service Resources route - returns detailed resource breakdown for a specific service\n  app.get(\"/api/costs/services/:serviceCode/resources\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const { serviceCode } = req.params;\n      const includeCredits = req.query.includeCredits !== 'false';\n      \n      const accounts = await storage.getAwsAccounts(userId);\n      if (accounts.length === 0) {\n        res.status(400).json({ \n          message: \"No AWS accounts connected. Please add an AWS account first.\" \n        });\n        return;\n      }\n\n      const account = accounts[0];\n      \n      if (!account.accessKeyId || !account.secretAccessKey) {\n        res.status(400).json({ \n          message: \"AWS credentials are missing or invalid\" \n        });\n        return;\n      }\n      \n      const awsService = new AwsService({\n        accessKeyId: account.accessKeyId,\n        secretAccessKey: account.secretAccessKey,\n        region: account.region,\n      });\n\n      const serviceResources: ServiceResources = await awsService.getServiceResourceCosts(\n        decodeURIComponent(serviceCode),\n        includeCredits\n      );\n      res.json(serviceResources);\n    } catch (error: any) {\n      console.error(\"Error fetching service resources:\", error);\n      \n      if (error.name === 'AccessDeniedException' || error.message?.includes('permission')) {\n        res.status(403).json({ \n          message: \"AWS credentials do not have permission to access Cost Explorer.\",\n          action: \"Add the 'ce:GetCostAndUsage' permission to your IAM user or role in the AWS Console.\"\n        });\n        return;\n      }\n      \n      res.status(500).json({ \n        message: error.message || \"Failed to fetch service resources\" \n      });\n    }\n  });\n\n  // Cost Recommendations route - returns RI, Savings Plans, and Rightsizing recommendations\n  app.get(\"/api/costs/recommendations\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      \n      const accounts = await storage.getAwsAccounts(userId);\n      if (accounts.length === 0) {\n        res.status(400).json({ \n          message: \"No AWS accounts connected. Please add an AWS account first.\" \n        });\n        return;\n      }\n\n      const account = accounts[0];\n      \n      if (!account.accessKeyId || !account.secretAccessKey) {\n        res.status(400).json({ \n          message: \"AWS credentials are missing or invalid\" \n        });\n        return;\n      }\n      \n      const awsService = new AwsService({\n        accessKeyId: account.accessKeyId,\n        secretAccessKey: account.secretAccessKey,\n        region: account.region,\n      });\n\n      const recommendations: CostRecommendations = await awsService.getCostRecommendations();\n      res.json(recommendations);\n    } catch (error: any) {\n      console.error(\"Error fetching cost recommendations:\", error);\n      \n      if (error.name === 'AccessDeniedException' || error.message?.includes('permission')) {\n        res.status(403).json({ \n          message: \"AWS credentials do not have permission to access Cost Explorer recommendations. Ensure your IAM user has ce:GetReservationPurchaseRecommendation, ce:GetSavingsPlansPurchaseRecommendation, and ce:GetRightsizingRecommendation permissions.\" \n        });\n        return;\n      }\n      \n      res.status(500).json({ \n        message: error.message || \"Failed to fetch cost recommendations\" \n      });\n    }\n  });\n\n  // Cost Forecast route - returns forecasted costs for upcoming months\n  app.get(\"/api/costs/forecast\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      \n      // Validate includeCredits parameter\n      const includeCreditsParam = req.query.includeCredits;\n      const includeCredits = includeCreditsParam === undefined || includeCreditsParam === 'true';\n      \n      const accounts = await storage.getAwsAccounts(userId);\n      if (accounts.length === 0) {\n        res.status(200).json({ \n          nextMonth: { amount: 0, startDate: new Date().toISOString(), endDate: new Date().toISOString() },\n          next3Months: { amount: 0 },\n          yearToDateActual: 0,\n          yearToDateForecast: 0\n        });\n        return;\n      }\n\n      const account = accounts[0];\n      \n      if (!account.accessKeyId || !account.secretAccessKey) {\n        res.status(200).json({ \n          nextMonth: { amount: 0, startDate: new Date().toISOString(), endDate: new Date().toISOString() },\n          next3Months: { amount: 0 },\n          yearToDateActual: 0,\n          yearToDateForecast: 0\n        });\n        return;\n      }\n      \n      const awsService = new AwsService({\n        accessKeyId: account.accessKeyId,\n        secretAccessKey: account.secretAccessKey,\n        region: account.region,\n      });\n\n      const forecast = await awsService.getCostForecast(includeCredits);\n      res.json(forecast);\n    } catch (error: any) {\n      console.error(\"Error fetching cost forecast:\", error);\n      \n      if (error.name === 'AccessDeniedException' || error.message?.includes('permission')) {\n        res.status(403).json({ \n          message: \"AWS credentials do not have permission to access Cost Explorer forecasts. Ensure your IAM user has ce:GetCostForecast permission.\" \n        });\n        return;\n      }\n      \n      res.status(500).json({ \n        message: error.message || \"Failed to fetch cost forecast\" \n      });\n    }\n  });\n\n  // Resources route - returns all resources with cost optimization recommendations\n  app.get(\"/api/resources\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const accounts = await storage.getAwsAccounts(userId);\n      \n      let allResources: any[] = [];\n      for (const account of accounts) {\n        const controls = await storage.getControlResults(account.id);\n        const resources = controls\n          .filter(control => !control.passed) // Only show failed checks (optimization opportunities)\n          .map(control => ({\n            id: control.id,\n            resourceId: control.resourceId || 'N/A',\n            resourceType: control.resourceType || 'Unknown',\n            controlName: control.controlName,\n            service: control.resourceType || 'Unknown',\n            region: account.region,\n            status: control.passed ? 'passed' : 'failed',\n            reason: control.reason || `Resource optimization opportunity: ${control.controlName}`,\n            savingsPotential: control.estimatedSavings,\n            awsConsoleUrl: control.resourceId \n              ? `https://console.aws.amazon.com`\n              : undefined,\n          }));\n        allResources = [...allResources, ...resources];\n      }\n      \n      res.json(allResources);\n    } catch (error) {\n      console.error(\"Error fetching resources:\", error);\n      res.status(500).json({ message: \"Failed to fetch resources\" });\n    }\n  });\n\n  // SQL Query routes\n  app.get(\"/api/queries/history\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const history = await storage.getQueryHistory(userId);\n      res.json(history);\n    } catch (error) {\n      console.error(\"Error fetching query history:\", error);\n      res.status(500).json({ message: \"Failed to fetch query history\" });\n    }\n  });\n\n  app.post(\"/api/queries/execute\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const { query } = req.body;\n      \n      if (!query || typeof query !== \"string\") {\n        res.status(400).json({ message: \"Invalid query\" });\n        return;\n      }\n\n      const accounts = await storage.getAwsAccounts(userId);\n      \n      // Simulate query execution (in real implementation, call Steampipe)\n      const mockResult = {\n        columns: [\"id\", \"name\", \"status\", \"region\"],\n        rows: [\n          { id: \"i-1234567\", name: \"web-server-1\", status: \"running\", region: \"us-east-1\" },\n          { id: \"i-7654321\", name: \"web-server-2\", status: \"stopped\", region: \"us-west-2\" },\n        ],\n        rowCount: 2,\n      };\n\n      await storage.saveQuery(\n        userId,\n        accounts.length > 0 ? accounts[0].id : null,\n        query,\n        mockResult\n      );\n\n      res.json(mockResult);\n    } catch (error) {\n      console.error(\"Error executing query:\", error);\n      res.status(500).json({ message: \"Failed to execute query\" });\n    }\n  });\n\n  const httpServer = createServer(app);\n  return httpServer;\n}\n","size_bytes":35505},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    // h-9 to match icon buttons and default buttons.\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","size_bytes":844},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  // Whitespace-nowrap: Badges should never wrap.\n  \"whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\" +\n  \" hover-elevate \" ,\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground shadow-xs\",\n        secondary: \"border-transparent bg-secondary text-secondary-foreground\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground shadow-xs\",\n\n        outline: \" border [border-color:var(--badge-outline)] shadow-xs\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  },\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  );\n}\n\nexport { Badge, badgeVariants }\n","size_bytes":1202},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","size_bytes":4281},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","size_bytes":325},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { setupVite, serveStatic, log } from \"./vite\";\n\nconst app = express();\n\ndeclare module 'http' {\n  interface IncomingMessage {\n    rawBody: unknown\n  }\n}\napp.use(express.json({\n  verify: (req, _res, buf) => {\n    req.rawBody = buf;\n  }\n}));\napp.use(express.urlencoded({ extended: false }));\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"\";\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  const server = await registerRoutes(app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    // Only send response if headers haven't been sent yet\n    if (!res.headersSent) {\n      res.status(status).json({ message });\n    }\n    \n    console.error(\"Error:\", err);\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (app.get(\"env\") === \"development\") {\n    await setupVite(app, server);\n  } else {\n    serveStatic(app);\n  }\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || '5000', 10);\n  server.listen({\n    port,\n    host: \"0.0.0.0\",\n    reusePort: true,\n  }, () => {\n    log(`serving on port ${port}`);\n  });\n})();\n","size_bytes":2329},"server/aws-service.ts":{"content":"import { \n  EC2Client, \n  DescribeInstancesCommand, \n  DescribeVolumesCommand,\n  DescribeSnapshotsCommand,\n  DescribeAddressesCommand \n} from \"@aws-sdk/client-ec2\";\nimport { \n  RDSClient, \n  DescribeDBInstancesCommand, \n  DescribeDBSnapshotsCommand \n} from \"@aws-sdk/client-rds\";\nimport { \n  S3Client, \n  ListBucketsCommand,\n  GetBucketVersioningCommand,\n  GetBucketLifecycleConfigurationCommand \n} from \"@aws-sdk/client-s3\";\nimport { \n  DynamoDBClient, \n  ListTablesCommand,\n  DescribeTableCommand \n} from \"@aws-sdk/client-dynamodb\";\nimport { \n  ElastiCacheClient, \n  DescribeCacheClustersCommand \n} from \"@aws-sdk/client-elasticache\";\nimport { \n  RedshiftClient, \n  DescribeClustersCommand \n} from \"@aws-sdk/client-redshift\";\nimport { \n  LambdaClient, \n  ListFunctionsCommand \n} from \"@aws-sdk/client-lambda\";\nimport {\n  CostExplorerClient,\n  GetCostAndUsageCommand,\n  GetCostAndUsageWithResourcesCommand,\n  GetReservationPurchaseRecommendationCommand,\n  GetSavingsPlansPurchaseRecommendationCommand,\n  GetRightsizingRecommendationCommand,\n} from \"@aws-sdk/client-cost-explorer\";\nimport type { \n  CostSummary, \n  MonthlyCost, \n  ServiceCost,\n  ServiceBreakdown,\n  ServiceResources,\n  CostRecommendations,\n} from \"@shared/schema\";\n\nexport interface AwsCredentials {\n  accessKeyId: string;\n  secretAccessKey: string;\n  region: string;\n}\n\nexport interface BenchmarkCheck {\n  id: string;\n  name: string;\n  passed: boolean;\n  resourceId?: string;\n  estimatedSavings: number; // in cents\n  reason?: string;\n}\n\nexport interface BenchmarkResult {\n  benchmarkId: string;\n  benchmarkName: string;\n  checks: BenchmarkCheck[];\n  controlsPassed: number;\n  controlsFailed: number;\n  estimatedSavings: number;\n}\n\n/**\n * AWS Service for scanning and analyzing AWS infrastructure\n * Based on AWS Thrifty mod benchmarks\n */\nexport class AwsService {\n  private ec2Client: EC2Client;\n  private rdsClient: RDSClient;\n  private s3Client: S3Client;\n  private dynamodbClient: DynamoDBClient;\n  private elasticacheClient: ElastiCacheClient;\n  private redshiftClient: RedshiftClient;\n  private lambdaClient: LambdaClient;\n  private costExplorerClient: CostExplorerClient;\n\n  constructor(credentials: AwsCredentials) {\n    const config = {\n      region: credentials.region,\n      credentials: {\n        accessKeyId: credentials.accessKeyId,\n        secretAccessKey: credentials.secretAccessKey,\n      },\n    };\n\n    this.ec2Client = new EC2Client(config);\n    this.rdsClient = new RDSClient(config);\n    this.s3Client = new S3Client(config);\n    this.dynamodbClient = new DynamoDBClient(config);\n    this.elasticacheClient = new ElastiCacheClient(config);\n    this.redshiftClient = new RedshiftClient(config);\n    this.lambdaClient = new LambdaClient(config);\n    // Cost Explorer must use us-east-1 region\n    this.costExplorerClient = new CostExplorerClient({\n      region: 'us-east-1',\n      credentials: {\n        accessKeyId: credentials.accessKeyId,\n        secretAccessKey: credentials.secretAccessKey,\n      },\n    });\n  }\n\n  /**\n   * Calculate estimated monthly savings for a resource based on actual Cost Explorer data\n   * @param resourceId - The AWS resource ID\n   * @param serviceCode - The Cost Explorer service code (e.g., \"Amazon Elastic Compute Cloud - Compute\")\n   * @param savingsPercentage - Percentage of cost that would be saved (0-100)\n   * @param fallbackCentsPerMonth - Fallback monthly cost in cents if Cost Explorer has no data\n   * @returns Estimated monthly savings in cents\n   */\n  private async calculateSavings(\n    resourceId: string | undefined,\n    serviceCode: string,\n    savingsPercentage: number,\n    fallbackCentsPerMonth: number = 0\n  ): Promise<number> {\n    if (!resourceId) return fallbackCentsPerMonth;\n\n    try {\n      // Get actual daily cost from Cost Explorer (last 7 days)\n      const dailyCostCents = await this.getResourceCost(resourceId, serviceCode, 7);\n      \n      if (dailyCostCents !== null && dailyCostCents > 0) {\n        // Convert daily cost to monthly (30 days) and apply savings percentage\n        const monthlyCostCents = dailyCostCents * 30;\n        return Math.round(monthlyCostCents * (savingsPercentage / 100));\n      }\n      \n      // Fall back to estimate if no Cost Explorer data\n      return fallbackCentsPerMonth;\n    } catch (error) {\n      console.error(`Error calculating savings for ${resourceId}:`, error);\n      return fallbackCentsPerMonth;\n    }\n  }\n\n  /**\n   * Run EC2 benchmark checks with accurate cost calculations\n   */\n  async runEC2Benchmark(): Promise<BenchmarkResult> {\n    const checks: BenchmarkCheck[] = [];\n\n    try {\n      // Check for stopped instances\n      const instancesResponse = await this.ec2Client.send(new DescribeInstancesCommand({}));\n      const instances = instancesResponse.Reservations?.flatMap(r => r.Instances || []) || [];\n      \n      for (const instance of instances) {\n        if (instance.State?.Name === 'stopped') {\n          // Stopped instances incur EBS volume costs - save 100% by terminating\n          const estimatedSavings = await this.calculateSavings(\n            instance.InstanceId,\n            'Amazon Elastic Compute Cloud - Compute',\n            100,\n            500 // Fallback: Save $5/month by terminating stopped instance\n          );\n          \n          checks.push({\n            id: `ec2-stopped-${instance.InstanceId}`,\n            name: 'EC2 instance should not be stopped for more than 30 days',\n            passed: false,\n            resourceId: instance.InstanceId,\n            estimatedSavings,\n            reason: `Instance ${instance.InstanceId} is stopped but still incurring charges for EBS volumes`,\n          });\n        }\n      }\n\n      // Check for unattached volumes\n      const volumesResponse = await this.ec2Client.send(new DescribeVolumesCommand({}));\n      const volumes = volumesResponse.Volumes || [];\n      \n      for (const volume of volumes) {\n        if (volume.State === 'available') {\n          // Unattached volumes can be deleted - save 100%\n          // Fallback estimate: $0.10/GB-month for gp3 volumes\n          const fallbackCost = (volume.Size || 0) * 10; // cents\n          const estimatedSavings = await this.calculateSavings(\n            volume.VolumeId,\n            'EC2 - Other',\n            100,\n            fallbackCost\n          );\n          \n          checks.push({\n            id: `ec2-volume-${volume.VolumeId}`,\n            name: 'EBS volumes should be attached to instances',\n            passed: false,\n            resourceId: volume.VolumeId,\n            estimatedSavings,\n            reason: `Volume ${volume.VolumeId} (${volume.Size}GB) is unattached and incurring costs`,\n          });\n        }\n      }\n\n      // Check for old snapshots\n      const snapshotsResponse = await this.ec2Client.send(new DescribeSnapshotsCommand({ OwnerIds: ['self'] }));\n      const snapshots = snapshotsResponse.Snapshots || [];\n      const oldSnapshotDate = new Date();\n      oldSnapshotDate.setDate(oldSnapshotDate.getDate() - 90); // 90 days ago\n      \n      for (const snapshot of snapshots) {\n        if (snapshot.StartTime && snapshot.StartTime < oldSnapshotDate) {\n          // Old snapshots can be deleted - save 100%\n          // Fallback estimate: $0.05/GB-month for snapshots\n          const fallbackCost = (snapshot.VolumeSize || 0) * 5; // cents\n          const estimatedSavings = await this.calculateSavings(\n            snapshot.SnapshotId,\n            'EC2 - Other',\n            100,\n            fallbackCost\n          );\n          \n          checks.push({\n            id: `ec2-snapshot-${snapshot.SnapshotId}`,\n            name: 'EBS snapshots should not be older than 90 days',\n            passed: false,\n            resourceId: snapshot.SnapshotId,\n            estimatedSavings,\n            reason: `Snapshot ${snapshot.SnapshotId} is older than 90 days`,\n          });\n        }\n      }\n\n      // Check for unattached elastic IPs\n      const addressesResponse = await this.ec2Client.send(new DescribeAddressesCommand({}));\n      const addresses = addressesResponse.Addresses || [];\n      \n      for (const address of addresses) {\n        if (!address.AssociationId) {\n          // Unattached EIPs cost $0.005/hour = $3.60/month\n          const estimatedSavings = await this.calculateSavings(\n            address.AllocationId,\n            'EC2 - Other',\n            100,\n            360 // $3.60/month in cents\n          );\n          \n          checks.push({\n            id: `ec2-eip-${address.AllocationId}`,\n            name: 'Elastic IPs should be attached to instances',\n            passed: false,\n            resourceId: address.AllocationId,\n            estimatedSavings,\n            reason: `Elastic IP ${address.PublicIp} is unattached and incurring charges`,\n          });\n        }\n      }\n\n    } catch (error: any) {\n      console.error('Error running EC2 benchmark:', error);\n      // Re-throw AWS SDK errors so routes can handle them appropriately\n      if (error.name === 'CredentialsError' || error.name === 'InvalidClientTokenId' || \n          error.name === 'UnauthorizedException' || error.name === 'AccessDeniedException') {\n        throw error;\n      }\n      // For other errors, log but continue with empty results (service may not be in use)\n    }\n\n    const controlsPassed = checks.filter(c => c.passed).length;\n    const controlsFailed = checks.filter(c => !c.passed).length;\n    const estimatedSavings = checks.reduce((sum, c) => sum + c.estimatedSavings, 0);\n\n    return {\n      benchmarkId: 'ec2',\n      benchmarkName: 'EC2',\n      checks,\n      controlsPassed,\n      controlsFailed,\n      estimatedSavings,\n    };\n  }\n\n  /**\n   * Run RDS benchmark checks with accurate cost calculations\n   */\n  async runRDSBenchmark(): Promise<BenchmarkResult> {\n    const checks: BenchmarkCheck[] = [];\n\n    try {\n      const response = await this.rdsClient.send(new DescribeDBInstancesCommand({}));\n      const instances = response.DBInstances || [];\n\n      for (const instance of instances) {\n        // Check for stopped instances\n        if (instance.DBInstanceStatus === 'stopped') {\n          // Stopped RDS instances still incur storage costs - save 100% by deleting snapshots and terminating\n          const estimatedSavings = await this.calculateSavings(\n            instance.DBInstanceIdentifier,\n            'Amazon Relational Database Service',\n            100,\n            2000 // Fallback: Save $20/month by terminating stopped RDS instance\n          );\n          \n          checks.push({\n            id: `rds-stopped-${instance.DBInstanceIdentifier}`,\n            name: 'RDS instances should not be stopped for extended periods',\n            passed: false,\n            resourceId: instance.DBInstanceIdentifier,\n            estimatedSavings,\n            reason: `RDS instance ${instance.DBInstanceIdentifier} is stopped`,\n          });\n        }\n\n        // Check for old generation instance types\n        if (instance.DBInstanceClass?.includes('.t2.') || instance.DBInstanceClass?.includes('.m3.')) {\n          // Upgrading to new generation can save ~30-40% on compute costs\n          const estimatedSavings = await this.calculateSavings(\n            instance.DBInstanceIdentifier,\n            'Amazon Relational Database Service',\n            35, // 35% savings by upgrading to newer generation\n            1050 // Fallback: Save $10.50/month by upgrading ($30/month instance * 35%)\n          );\n          \n          checks.push({\n            id: `rds-old-gen-${instance.DBInstanceIdentifier}`,\n            name: 'RDS instances should use current generation instance types',\n            passed: false,\n            resourceId: instance.DBInstanceIdentifier,\n            estimatedSavings,\n            reason: `RDS instance ${instance.DBInstanceIdentifier} uses old generation instance type ${instance.DBInstanceClass}`,\n          });\n        }\n      }\n\n      // Check for old snapshots\n      const snapshotsResponse = await this.rdsClient.send(new DescribeDBSnapshotsCommand({ SnapshotType: 'manual' }));\n      const snapshots = snapshotsResponse.DBSnapshots || [];\n      const oldSnapshotDate = new Date();\n      oldSnapshotDate.setDate(oldSnapshotDate.getDate() - 90);\n      \n      for (const snapshot of snapshots) {\n        if (snapshot.SnapshotCreateTime && snapshot.SnapshotCreateTime < oldSnapshotDate) {\n          // Old snapshots can be deleted - save 100%\n          // Fallback estimate: $0.095/GB-month for RDS snapshots\n          const fallbackCost = (snapshot.AllocatedStorage || 0) * 10; // cents (roughly $0.10/GB)\n          const estimatedSavings = await this.calculateSavings(\n            snapshot.DBSnapshotIdentifier,\n            'Amazon Relational Database Service',\n            100,\n            fallbackCost\n          );\n          \n          checks.push({\n            id: `rds-snapshot-${snapshot.DBSnapshotIdentifier}`,\n            name: 'RDS snapshots should not be older than 90 days',\n            passed: false,\n            resourceId: snapshot.DBSnapshotIdentifier,\n            estimatedSavings,\n            reason: `RDS snapshot ${snapshot.DBSnapshotIdentifier} is older than 90 days`,\n          });\n        }\n      }\n\n    } catch (error) {\n      console.error('Error running RDS benchmark:', error);\n    }\n\n    const controlsPassed = checks.filter(c => c.passed).length;\n    const controlsFailed = checks.filter(c => !c.passed).length;\n    const estimatedSavings = checks.reduce((sum, c) => sum + c.estimatedSavings, 0);\n\n    return {\n      benchmarkId: 'rds',\n      benchmarkName: 'RDS',\n      checks,\n      controlsPassed,\n      controlsFailed,\n      estimatedSavings,\n    };\n  }\n\n  /**\n   * Run S3 benchmark checks\n   */\n  async runS3Benchmark(): Promise<BenchmarkResult> {\n    const checks: BenchmarkCheck[] = [];\n\n    try {\n      const response = await this.s3Client.send(new ListBucketsCommand({}));\n      const buckets = response.Buckets || [];\n\n      for (const bucket of buckets) {\n        if (!bucket.Name) continue;\n\n        try {\n          // Check for versioning\n          const versioningResponse = await this.s3Client.send(\n            new GetBucketVersioningCommand({ Bucket: bucket.Name })\n          );\n          \n          if (versioningResponse.Status === 'Enabled' && !versioningResponse.MFADelete) {\n            // S3 versioning without lifecycle can waste storage - estimate 30% savings\n            const estimatedSavings = await this.calculateSavings(\n              bucket.Name,\n              'Amazon Simple Storage Service', // S3 doesn't support resource-level cost queries, uses fallback\n              30,\n              300 // Fallback: Save $3/month with lifecycle policies ($10/month bucket * 30%)\n            );\n            \n            checks.push({\n              id: `s3-versioning-${bucket.Name}`,\n              name: 'S3 buckets with versioning should have lifecycle policies',\n              passed: false,\n              resourceId: bucket.Name,\n              estimatedSavings,\n              reason: `Bucket ${bucket.Name} has versioning enabled without lifecycle management`,\n            });\n          }\n\n          // Check for lifecycle policies\n          try {\n            await this.s3Client.send(\n              new GetBucketLifecycleConfigurationCommand({ Bucket: bucket.Name })\n            );\n          } catch (error: any) {\n            if (error.name === 'NoSuchLifecycleConfiguration') {\n              // Lifecycle policies can save 20-40% by moving to cheaper storage classes\n              const estimatedSavings = await this.calculateSavings(\n                bucket.Name,\n                'Amazon Simple Storage Service',\n                25,\n                200 // Fallback: Save $2/month with lifecycle policies ($8/month bucket * 25%)\n              );\n              \n              checks.push({\n                id: `s3-lifecycle-${bucket.Name}`,\n                name: 'S3 buckets should have lifecycle policies to optimize costs',\n                passed: false,\n                resourceId: bucket.Name,\n                estimatedSavings,\n                reason: `Bucket ${bucket.Name} does not have lifecycle policies configured`,\n              });\n            }\n          }\n        } catch (error) {\n          // Skip buckets we can't access\n          console.error(`Error checking bucket ${bucket.Name}:`, error);\n        }\n      }\n\n    } catch (error) {\n      console.error('Error running S3 benchmark:', error);\n    }\n\n    const controlsPassed = checks.filter(c => c.passed).length;\n    const controlsFailed = checks.filter(c => !c.passed).length;\n    const estimatedSavings = checks.reduce((sum, c) => sum + c.estimatedSavings, 0);\n\n    return {\n      benchmarkId: 's3',\n      benchmarkName: 'S3',\n      checks,\n      controlsPassed,\n      controlsFailed,\n      estimatedSavings,\n    };\n  }\n\n  /**\n   * Run DynamoDB benchmark checks\n   */\n  async runDynamoDBBenchmark(): Promise<BenchmarkResult> {\n    const checks: BenchmarkCheck[] = [];\n\n    try {\n      const response = await this.dynamodbClient.send(new ListTablesCommand({}));\n      const tableNames = response.TableNames || [];\n\n      for (const tableName of tableNames) {\n        const tableResponse = await this.dynamodbClient.send(\n          new DescribeTableCommand({ TableName: tableName })\n        );\n        const table = tableResponse.Table;\n\n        if (table?.BillingModeSummary?.BillingMode === 'PROVISIONED') {\n          const readCapacity = table.ProvisionedThroughput?.ReadCapacityUnits || 0;\n          const writeCapacity = table.ProvisionedThroughput?.WriteCapacityUnits || 0;\n          \n          if (readCapacity > 10 || writeCapacity > 10) {\n            // Switching to on-demand can save 20-40% for variable workloads\n            // Estimate: $0.00065 per WCU-hour, $0.00013 per RCU-hour for provisioned\n            const monthlyCost = ((writeCapacity * 0.00065 + readCapacity * 0.00013) * 730 * 100);\n            const estimatedSavings = await this.calculateSavings(\n              tableName,\n              'Amazon DynamoDB', // DynamoDB doesn't support resource-level cost queries, uses fallback\n              30,\n              Math.round(monthlyCost * 0.3) // Save 30%\n            );\n            \n            checks.push({\n              id: `dynamodb-capacity-${tableName}`,\n              name: 'DynamoDB tables should use on-demand billing for variable workloads',\n              passed: false,\n              resourceId: tableName,\n              estimatedSavings,\n              reason: `Table ${tableName} uses provisioned capacity (${readCapacity} RCU, ${writeCapacity} WCU)`,\n            });\n          }\n        }\n      }\n\n    } catch (error) {\n      console.error('Error running DynamoDB benchmark:', error);\n    }\n\n    const controlsPassed = checks.filter(c => c.passed).length;\n    const controlsFailed = checks.filter(c => !c.passed).length;\n    const estimatedSavings = checks.reduce((sum, c) => sum + c.estimatedSavings, 0);\n\n    return {\n      benchmarkId: 'dynamodb',\n      benchmarkName: 'DynamoDB',\n      checks,\n      controlsPassed,\n      controlsFailed,\n      estimatedSavings,\n    };\n  }\n\n  /**\n   * Run ElastiCache benchmark checks\n   */\n  async runElastiCacheBenchmark(): Promise<BenchmarkResult> {\n    const checks: BenchmarkCheck[] = [];\n\n    try {\n      const response = await this.elasticacheClient.send(new DescribeCacheClustersCommand({}));\n      const clusters = response.CacheClusters || [];\n\n      for (const cluster of clusters) {\n        // Check for old generation node types\n        if (cluster.CacheNodeType?.includes('.t2.') || cluster.CacheNodeType?.includes('.m3.')) {\n          // Upgrading to new generation can save ~30-40%\n          const estimatedSavings = await this.calculateSavings(\n            cluster.CacheClusterId,\n            'Amazon ElastiCache',\n            35,\n            1750 // Fallback: Save $17.50/month by upgrading ($50/month cluster * 35%)\n          );\n          \n          checks.push({\n            id: `elasticache-old-gen-${cluster.CacheClusterId}`,\n            name: 'ElastiCache clusters should use current generation node types',\n            passed: false,\n            resourceId: cluster.CacheClusterId,\n            estimatedSavings,\n            reason: `Cluster ${cluster.CacheClusterId} uses old generation node type ${cluster.CacheNodeType}`,\n          });\n        }\n      }\n\n    } catch (error) {\n      console.error('Error running ElastiCache benchmark:', error);\n    }\n\n    const controlsPassed = checks.filter(c => c.passed).length;\n    const controlsFailed = checks.filter(c => !c.passed).length;\n    const estimatedSavings = checks.reduce((sum, c) => sum + c.estimatedSavings, 0);\n\n    return {\n      benchmarkId: 'elasticache',\n      benchmarkName: 'ElastiCache',\n      checks,\n      controlsPassed,\n      controlsFailed,\n      estimatedSavings,\n    };\n  }\n\n  /**\n   * Run Redshift benchmark checks\n   */\n  async runRedshiftBenchmark(): Promise<BenchmarkResult> {\n    const checks: BenchmarkCheck[] = [];\n\n    try {\n      const response = await this.redshiftClient.send(new DescribeClustersCommand({}));\n      const clusters = response.Clusters || [];\n\n      for (const cluster of clusters) {\n        // Check for paused clusters\n        if (cluster.ClusterStatus === 'paused') {\n          // Paused Redshift clusters save compute costs but still incur storage - save 100% if deleted\n          const estimatedSavings = await this.calculateSavings(\n            cluster.ClusterIdentifier,\n            'Amazon Redshift',\n            100,\n            15000 // Fallback: Save $150/month by deleting paused Redshift cluster\n          );\n          \n          checks.push({\n            id: `redshift-paused-${cluster.ClusterIdentifier}`,\n            name: 'Redshift clusters should not be paused for extended periods',\n            passed: false,\n            resourceId: cluster.ClusterIdentifier,\n            estimatedSavings,\n            reason: `Cluster ${cluster.ClusterIdentifier} is paused`,\n          });\n        }\n\n        // Check for old generation node types\n        if (cluster.NodeType?.includes('dc1.') || cluster.NodeType?.includes('ds1.')) {\n          // Upgrading to new generation can save ~30-50%\n          const estimatedSavings = await this.calculateSavings(\n            cluster.ClusterIdentifier,\n            'Amazon Redshift',\n            40,\n            20000 // Fallback: Save $200/month by upgrading ($500/month cluster * 40%)\n          );\n          \n          checks.push({\n            id: `redshift-old-gen-${cluster.ClusterIdentifier}`,\n            name: 'Redshift clusters should use current generation node types',\n            passed: false,\n            resourceId: cluster.ClusterIdentifier,\n            estimatedSavings,\n            reason: `Cluster ${cluster.ClusterIdentifier} uses old generation node type ${cluster.NodeType}`,\n          });\n        }\n      }\n\n    } catch (error) {\n      console.error('Error running Redshift benchmark:', error);\n    }\n\n    const controlsPassed = checks.filter(c => c.passed).length;\n    const controlsFailed = checks.filter(c => !c.passed).length;\n    const estimatedSavings = checks.reduce((sum, c) => sum + c.estimatedSavings, 0);\n\n    return {\n      benchmarkId: 'redshift',\n      benchmarkName: 'Redshift',\n      checks,\n      controlsPassed,\n      controlsFailed,\n      estimatedSavings,\n    };\n  }\n\n  /**\n   * Run Lambda benchmark checks\n   */\n  async runLambdaBenchmark(): Promise<BenchmarkResult> {\n    const checks: BenchmarkCheck[] = [];\n\n    try {\n      const response = await this.lambdaClient.send(new ListFunctionsCommand({}));\n      const functions = response.Functions || [];\n\n      for (const func of functions) {\n        // Check for over-provisioned memory\n        if (func.MemorySize && func.MemorySize > 3008) {\n          // Over-provisioned Lambda can waste 20-30% of costs\n          const estimatedSavings = await this.calculateSavings(\n            func.FunctionName,\n            'AWS Lambda',\n            25,\n            125 // Fallback: Save $1.25/month by rightsizing ($5/month function * 25%)\n          );\n          \n          checks.push({\n            id: `lambda-memory-${func.FunctionName}`,\n            name: 'Lambda functions should not be over-provisioned',\n            passed: false,\n            resourceId: func.FunctionName,\n            estimatedSavings,\n            reason: `Function ${func.FunctionName} has ${func.MemorySize}MB memory which may be over-provisioned`,\n          });\n        }\n\n        // Check for old runtime versions\n        if (func.Runtime?.includes('nodejs12') || func.Runtime?.includes('python3.6') || func.Runtime?.includes('python3.7')) {\n          // Old runtimes are security/compatibility issues, not direct cost issues\n          checks.push({\n            id: `lambda-runtime-${func.FunctionName}`,\n            name: 'Lambda functions should use supported runtime versions',\n            passed: false,\n            resourceId: func.FunctionName,\n            estimatedSavings: 0, // Security/compatibility issue, not cost\n            reason: `Function ${func.FunctionName} uses deprecated runtime ${func.Runtime}`,\n          });\n        }\n      }\n\n    } catch (error) {\n      console.error('Error running Lambda benchmark:', error);\n    }\n\n    const controlsPassed = checks.filter(c => c.passed).length;\n    const controlsFailed = checks.filter(c => !c.passed).length;\n    const estimatedSavings = checks.reduce((sum, c) => sum + c.estimatedSavings, 0);\n\n    return {\n      benchmarkId: 'lambda',\n      benchmarkName: 'Lambda',\n      checks,\n      controlsPassed,\n      controlsFailed,\n      estimatedSavings,\n    };\n  }\n\n  /**\n   * Run a specific benchmark by ID\n   */\n  async runBenchmark(benchmarkId: string): Promise<BenchmarkResult> {\n    switch (benchmarkId) {\n      case 'ec2':\n        return this.runEC2Benchmark();\n      case 'rds':\n        return this.runRDSBenchmark();\n      case 's3':\n        return this.runS3Benchmark();\n      case 'dynamodb':\n        return this.runDynamoDBBenchmark();\n      case 'elasticache':\n        return this.runElastiCacheBenchmark();\n      case 'redshift':\n        return this.runRedshiftBenchmark();\n      case 'lambda':\n        return this.runLambdaBenchmark();\n      default:\n        throw new Error(`Unknown benchmark: ${benchmarkId}`);\n    }\n  }\n\n  /**\n   * Check which services are actually in use\n   */\n  async getActiveServices(): Promise<string[]> {\n    const activeServices: string[] = [];\n\n    try {\n      const instances = await this.ec2Client.send(new DescribeInstancesCommand({}));\n      if (instances.Reservations && instances.Reservations.length > 0) {\n        activeServices.push('ec2');\n      }\n    } catch (error) {\n      // Service not available or no permissions\n    }\n\n    try {\n      const dbInstances = await this.rdsClient.send(new DescribeDBInstancesCommand({}));\n      if (dbInstances.DBInstances && dbInstances.DBInstances.length > 0) {\n        activeServices.push('rds');\n      }\n    } catch (error) {\n      // Service not available or no permissions\n    }\n\n    try {\n      const buckets = await this.s3Client.send(new ListBucketsCommand({}));\n      if (buckets.Buckets && buckets.Buckets.length > 0) {\n        activeServices.push('s3');\n      }\n    } catch (error) {\n      // Service not available or no permissions\n    }\n\n    try {\n      const tables = await this.dynamodbClient.send(new ListTablesCommand({}));\n      if (tables.TableNames && tables.TableNames.length > 0) {\n        activeServices.push('dynamodb');\n      }\n    } catch (error) {\n      // Service not available or no permissions\n    }\n\n    try {\n      const clusters = await this.elasticacheClient.send(new DescribeCacheClustersCommand({}));\n      if (clusters.CacheClusters && clusters.CacheClusters.length > 0) {\n        activeServices.push('elasticache');\n      }\n    } catch (error) {\n      // Service not available or no permissions\n    }\n\n    try {\n      const redshiftClusters = await this.redshiftClient.send(new DescribeClustersCommand({}));\n      if (redshiftClusters.Clusters && redshiftClusters.Clusters.length > 0) {\n        activeServices.push('redshift');\n      }\n    } catch (error) {\n      // Service not available or no permissions\n    }\n\n    try {\n      const functions = await this.lambdaClient.send(new ListFunctionsCommand({}));\n      if (functions.Functions && functions.Functions.length > 0) {\n        activeServices.push('lambda');\n      }\n    } catch (error) {\n      // Service not available or no permissions\n    }\n\n    return activeServices;\n  }\n\n  /**\n   * Get cost summary for current and previous month with optional credit exclusion\n   * @param includeCredits - If false, excludes AWS credits and refunds from cost calculation\n   */\n  async getCostSummary(includeCredits: boolean = true): Promise<CostSummary> {\n    const today = new Date();\n    \n    // Calculate date ranges\n    const currentMonthStart = new Date(today.getFullYear(), today.getMonth(), 1);\n    const nextMonthStart = new Date(today.getFullYear(), today.getMonth() + 1, 1);\n    const previousMonthStart = new Date(today.getFullYear(), today.getMonth() - 1, 1);\n    \n    // Format dates as YYYY-MM-DD\n    const formatDate = (date: Date) => date.toISOString().split('T')[0];\n    \n    // Build filter to exclude credits/refunds if needed\n    const filter = includeCredits ? undefined : {\n      Not: {\n        Dimensions: {\n          Key: 'RECORD_TYPE' as const,\n          Values: ['Credit', 'Refund', 'Tax']\n        }\n      }\n    } as any;\n\n    try {\n      // Get current and previous month costs in one call\n      const costResponse = await this.costExplorerClient.send(\n        new GetCostAndUsageCommand({\n          TimePeriod: {\n            Start: formatDate(previousMonthStart),\n            End: formatDate(nextMonthStart),\n          },\n          Granularity: 'MONTHLY',\n          Metrics: ['AmortizedCost'],\n          Filter: filter,\n        })\n      );\n\n      // Get costs by service for current month\n      const serviceCostResponse = await this.costExplorerClient.send(\n        new GetCostAndUsageCommand({\n          TimePeriod: {\n            Start: formatDate(currentMonthStart),\n            End: formatDate(nextMonthStart),\n          },\n          Granularity: 'MONTHLY',\n          Metrics: ['AmortizedCost'],\n          GroupBy: [\n            {\n              Type: 'DIMENSION',\n              Key: 'SERVICE',\n            },\n          ],\n          Filter: filter,\n        })\n      );\n\n      // Extract cost data\n      const results = costResponse.ResultsByTime || [];\n      const previousMonthData = results[0];\n      const currentMonthData = results[1];\n\n      const previousAmount = parseFloat(previousMonthData?.Total?.AmortizedCost?.Amount || '0');\n      const currentAmount = parseFloat(currentMonthData?.Total?.AmortizedCost?.Amount || '0');\n\n      // Calculate percentage change\n      const costDifference = currentAmount - previousAmount;\n      const percentageChange = previousAmount > 0 \n        ? ((costDifference / previousAmount) * 100) \n        : 0;\n\n      // Extract top 5 services by cost\n      const serviceGroups = serviceCostResponse.ResultsByTime?.[0]?.Groups || [];\n      const topServices: ServiceCost[] = serviceGroups\n        .map(group => ({\n          service: group.Keys?.[0] || 'Unknown',\n          amount: parseFloat(group.Metrics?.AmortizedCost?.Amount || '0'),\n        }))\n        .filter(service => service.amount > 0.01) // Filter out negligible costs\n        .sort((a, b) => b.amount - a.amount)\n        .slice(0, 5);\n\n      return {\n        currentMonth: {\n          amount: Math.round(currentAmount * 100), // Convert to cents\n          startDate: formatDate(currentMonthStart),\n          endDate: formatDate(today),\n        },\n        previousMonth: {\n          amount: Math.round(previousAmount * 100), // Convert to cents\n          startDate: formatDate(previousMonthStart),\n          endDate: formatDate(currentMonthStart),\n        },\n        percentageChange: Math.round(percentageChange * 100) / 100, // Round to 2 decimals\n        costDifference: Math.round(costDifference * 100), // Convert to cents\n        topServices: topServices.map(s => ({\n          service: s.service,\n          amount: Math.round(s.amount * 100), // Convert to cents\n        })),\n      };\n    } catch (error: any) {\n      console.error('Error fetching cost data from AWS Cost Explorer:', error);\n      \n      // Provide helpful error messages\n      if (error.name === 'AccessDeniedException') {\n        throw new Error('AWS credentials do not have permission to access Cost Explorer. Please ensure your IAM user has ce:GetCostAndUsage permission.');\n      }\n      \n      if (error.name === 'DataUnavailableException') {\n        throw new Error('Cost Explorer data is not available yet. It may take 24 hours for data to appear after enabling Cost Explorer.');\n      }\n      \n      throw new Error(`Failed to fetch cost data: ${error.message}`);\n    }\n  }\n\n  /**\n   * Get cost forecast for upcoming months\n   * @param includeCredits - If false, excludes AWS credits and refunds from forecast\n   */\n  async getCostForecast(includeCredits: boolean = true): Promise<import('@shared/schema').CostForecast> {\n    const today = new Date();\n    \n    // Calculate date ranges\n    const yearStart = new Date(today.getFullYear(), 0, 1);\n    const currentMonthStart = new Date(today.getFullYear(), today.getMonth(), 1);\n    const nextMonthStart = new Date(today.getFullYear(), today.getMonth() + 1, 1);\n    const next2MonthStart = new Date(today.getFullYear(), today.getMonth() + 2, 1);\n    const next3MonthStart = new Date(today.getFullYear(), today.getMonth() + 3, 1);\n    const next4MonthStart = new Date(today.getFullYear(), today.getMonth() + 4, 1);\n    \n    const formatDate = (date: Date) => date.toISOString().split('T')[0];\n    \n    const filter = includeCredits ? undefined : {\n      Not: {\n        Dimensions: {\n          Key: 'RECORD_TYPE' as const,\n          Values: ['Credit', 'Refund', 'Tax']\n        }\n      }\n    } as any;\n\n    try {\n      // Import GetCostForecastCommand\n      const { GetCostForecastCommand } = await import('@aws-sdk/client-cost-explorer');\n      \n      // Get forecast for next month\n      const nextMonthForecast = await this.costExplorerClient.send(\n        new GetCostForecastCommand({\n          TimePeriod: {\n            Start: formatDate(nextMonthStart),\n            End: formatDate(next2MonthStart),\n          },\n          Metric: 'AMORTIZED_COST',\n          Granularity: 'MONTHLY',\n          Filter: filter,\n          PredictionIntervalLevel: 80, // 80% confidence interval\n        })\n      );\n\n      // Get forecast for next 3 months\n      const next3MonthsForecast = await this.costExplorerClient.send(\n        new GetCostForecastCommand({\n          TimePeriod: {\n            Start: formatDate(nextMonthStart),\n            End: formatDate(next4MonthStart),\n          },\n          Metric: 'AMORTIZED_COST',\n          Granularity: 'MONTHLY',\n          Filter: filter,\n          PredictionIntervalLevel: 80,\n        })\n      );\n\n      // Get year-to-date actual costs\n      const ytdActual = await this.costExplorerClient.send(\n        new GetCostAndUsageCommand({\n          TimePeriod: {\n            Start: formatDate(yearStart),\n            End: formatDate(today),\n          },\n          Granularity: 'MONTHLY',\n          Metrics: ['AmortizedCost'],\n          Filter: filter,\n        })\n      );\n\n      // Get year-to-date forecast (from now to end of year)\n      const endOfYear = new Date(today.getFullYear(), 11, 31);\n      const ytdForecast = await this.costExplorerClient.send(\n        new GetCostForecastCommand({\n          TimePeriod: {\n            Start: formatDate(today),\n            End: formatDate(endOfYear),\n          },\n          Metric: 'AMORTIZED_COST',\n          Granularity: 'MONTHLY',\n          Filter: filter,\n        })\n      );\n\n      // Calculate year-to-date actual total\n      let ytdActualTotal = 0;\n      for (const result of ytdActual.ResultsByTime || []) {\n        ytdActualTotal += parseFloat(result.Total?.AmortizedCost?.Amount || '0');\n      }\n\n      // Extract next month forecast\n      const nextMonthAmount = parseFloat(nextMonthForecast.Total?.Amount || '0');\n      const nextMonthLower = parseFloat(nextMonthForecast.ForecastResultsByTime?.[0]?.MeanValue || '0');\n      const nextMonthUpper = parseFloat(nextMonthForecast.ForecastResultsByTime?.[0]?.MeanValue || '0');\n\n      // Extract 3-month forecast\n      let next3MonthsTotal = 0;\n      for (const result of next3MonthsForecast.ForecastResultsByTime || []) {\n        next3MonthsTotal += parseFloat(result.MeanValue || '0');\n      }\n\n      // Extract YTD forecast\n      let ytdForecastTotal = 0;\n      for (const result of ytdForecast.ForecastResultsByTime || []) {\n        ytdForecastTotal += parseFloat(result.MeanValue || '0');\n      }\n\n      return {\n        nextMonth: {\n          amount: Math.round(nextMonthAmount * 100), // Convert to cents\n          startDate: formatDate(nextMonthStart),\n          endDate: formatDate(next2MonthStart),\n          confidence: {\n            lower: Math.round(nextMonthLower * 0.9 * 100), // Approximate lower bound\n            upper: Math.round(nextMonthUpper * 1.1 * 100), // Approximate upper bound\n          },\n        },\n        next3Months: {\n          amount: Math.round(next3MonthsTotal * 100),\n          startDate: formatDate(nextMonthStart),\n          endDate: formatDate(next4MonthStart),\n        },\n        yearToDateActual: Math.round(ytdActualTotal * 100),\n        yearToDateForecast: Math.round((ytdActualTotal + ytdForecastTotal) * 100),\n      };\n    } catch (error: any) {\n      console.error('Error fetching cost forecast:', error);\n      \n      if (error.name === 'AccessDeniedException') {\n        throw new Error('AWS credentials do not have permission to access Cost Explorer forecasts. Please ensure your IAM user has ce:GetCostForecast permission.');\n      }\n      \n      if (error.name === 'DataUnavailableException') {\n        throw new Error('Cost forecast data is not available yet. It may take 24 hours for data to appear after enabling Cost Explorer.');\n      }\n      \n      throw new Error(`Failed to fetch cost forecast: ${error.message}`);\n    }\n  }\n\n  /**\n   * Get all services with costs (not just top 5)\n   * @param includeCredits - If false, excludes AWS credits and refunds\n   */\n  async getAllServicesCosts(includeCredits: boolean = true): Promise<ServiceBreakdown[]> {\n    const today = new Date();\n    const currentMonthStart = new Date(today.getFullYear(), today.getMonth(), 1);\n    const nextMonthStart = new Date(today.getFullYear(), today.getMonth() + 1, 1);\n    \n    const formatDate = (date: Date) => date.toISOString().split('T')[0];\n    \n    const filter = includeCredits ? undefined : {\n      Not: {\n        Dimensions: {\n          Key: 'RECORD_TYPE' as const,\n          Values: ['Credit', 'Refund', 'Tax']\n        }\n      }\n    } as any;\n\n    try {\n      const response = await this.costExplorerClient.send(\n        new GetCostAndUsageCommand({\n          TimePeriod: {\n            Start: formatDate(currentMonthStart),\n            End: formatDate(nextMonthStart),\n          },\n          Granularity: 'MONTHLY',\n          Metrics: ['AmortizedCost'],\n          GroupBy: [\n            {\n              Type: 'DIMENSION',\n              Key: 'SERVICE',\n            },\n          ],\n          Filter: filter,\n        })\n      );\n\n      const serviceGroups = response.ResultsByTime?.[0]?.Groups || [];\n      const services: ServiceBreakdown[] = serviceGroups\n        .map(group => {\n          const serviceCode = group.Keys?.[0] || 'Unknown';\n          const amount = parseFloat(group.Metrics?.AmortizedCost?.Amount || '0');\n          \n          return {\n            serviceCode,\n            serviceName: serviceCode, // Will be mapped to friendly names in frontend\n            amount: Math.round(amount * 100), // Convert to cents\n          };\n        })\n        .filter(service => service.amount > 0) // Only services with costs\n        .sort((a, b) => b.amount - a.amount); // Sort by cost descending\n\n      return services;\n    } catch (error: any) {\n      console.error('Error fetching all services costs:', error);\n      throw new Error(`Failed to fetch services costs: ${error.message}`);\n    }\n  }\n\n  /**\n   * Get resource-level cost breakdown for a specific service\n   * @param serviceCode - AWS service code (e.g., \"Amazon Elastic Compute Cloud\")\n   * @param includeCredits - If false, excludes AWS credits\n   */\n  async getServiceResourceCosts(serviceCode: string, includeCredits: boolean = true): Promise<ServiceResources> {\n    const today = new Date();\n    const currentMonthStart = new Date(today.getFullYear(), today.getMonth(), 1);\n    const nextMonthStart = new Date(today.getFullYear(), today.getMonth() + 1, 1);\n    \n    const formatDate = (date: Date) => date.toISOString().split('T')[0];\n    \n    const baseFilter = {\n      Dimensions: {\n        Key: 'SERVICE' as const,\n        Values: [serviceCode]\n      }\n    };\n\n    const filter = includeCredits ? baseFilter : {\n      And: [\n        baseFilter,\n        {\n          Not: {\n            Dimensions: {\n              Key: 'RECORD_TYPE' as const,\n              Values: ['Credit', 'Refund', 'Tax']\n            }\n          }\n        }\n      ]\n    } as any;\n\n    try {\n      // Get costs grouped by region and usage type\n      const response = await this.costExplorerClient.send(\n        new GetCostAndUsageCommand({\n          TimePeriod: {\n            Start: formatDate(currentMonthStart),\n            End: formatDate(nextMonthStart),\n          },\n          Granularity: 'MONTHLY',\n          Metrics: ['AmortizedCost'],\n          GroupBy: [\n            {\n              Type: 'DIMENSION',\n              Key: 'REGION',\n            },\n            {\n              Type: 'DIMENSION',\n              Key: 'USAGE_TYPE',\n            },\n          ],\n          Filter: filter,\n        })\n      );\n\n      const groups = response.ResultsByTime?.[0]?.Groups || [];\n      \n      // Organize by region\n      const byRegionMap = new Map<string, any[]>();\n      let totalAmount = 0;\n\n      for (const group of groups) {\n        const keys = group.Keys || [];\n        const region = keys[0] || 'Unknown';\n        const usageType = keys[1] || 'Unknown';\n        const amount = parseFloat(group.Metrics?.AmortizedCost?.Amount || '0');\n        \n        if (amount <= 0) continue;\n\n        totalAmount += amount;\n\n        if (!byRegionMap.has(region)) {\n          byRegionMap.set(region, []);\n        }\n\n        byRegionMap.get(region)!.push({\n          resourceId: usageType, // Using usage type as identifier since we can't get actual resource IDs from Cost Explorer\n          resourceType: usageType,\n          region,\n          usageType,\n          amount: Math.round(amount * 100), // Convert to cents\n        });\n      }\n\n      // Convert map to array format\n      const byRegion = Array.from(byRegionMap.entries()).map(([region, resources]) => {\n        const regionTotal = resources.reduce((sum, r) => sum + r.amount, 0);\n        return {\n          region,\n          amount: regionTotal,\n          resources: resources.sort((a, b) => b.amount - a.amount), // Sort by cost\n        };\n      }).sort((a, b) => b.amount - a.amount); // Sort regions by cost\n\n      return {\n        serviceCode,\n        serviceName: serviceCode,\n        totalAmount: Math.round(totalAmount * 100), // Convert to cents\n        byRegion,\n      };\n    } catch (error: any) {\n      console.error('Error fetching service resource costs:', error);\n      throw new Error(`Failed to fetch resource costs for ${serviceCode}: ${error.message}`);\n    }\n  }\n\n  /**\n   * Get actual cost for a specific resource over the last N days\n   * Uses Cost Explorer GetCostAndUsageWithResources API (limited to last 14 days)\n   * \n   * @param resourceId - AWS resource ID (e.g., i-1234567890abcdef0, vol-abc123, bucket-name)\n   * @param serviceCode - AWS service (e.g., AmazonEC2, AmazonRDS, AmazonS3)\n   * @param days - Number of days to query (max 14, default 7)\n   * @returns Daily cost in cents, or null if not available\n   */\n  async getResourceCost(\n    resourceId: string, \n    serviceCode: string = 'AmazonEC2',\n    days: number = 7\n  ): Promise<number | null> {\n    try {\n      // Calculate date range (must be within last 14 days)\n      const endDate = new Date();\n      const startDate = new Date();\n      startDate.setDate(startDate.getDate() - Math.min(days, 14));\n\n      const response = await this.costExplorerClient.send(\n        new GetCostAndUsageWithResourcesCommand({\n          TimePeriod: {\n            Start: startDate.toISOString().split('T')[0],\n            End: endDate.toISOString().split('T')[0],\n          },\n          Granularity: 'DAILY',\n          Filter: {\n            And: [\n              {\n                Dimensions: {\n                  Key: 'RESOURCE_ID',\n                  Values: [resourceId],\n                }\n              },\n              {\n                Dimensions: {\n                  Key: 'SERVICE',\n                  Values: [serviceCode],\n                }\n              }\n            ]\n          },\n          Metrics: ['UnblendedCost'],\n        })\n      );\n\n      // Sum up the costs across all days\n      let totalCost = 0;\n      let daysWithData = 0;\n\n      for (const result of response.ResultsByTime || []) {\n        const amount = parseFloat(result.Total?.UnblendedCost?.Amount || '0');\n        if (amount > 0) {\n          totalCost += amount;\n          daysWithData++;\n        }\n      }\n\n      // Return average daily cost in cents, or null if no data\n      if (daysWithData === 0) return null;\n      return Math.round((totalCost / daysWithData) * 100);\n\n    } catch (error: any) {\n      console.error(`Error fetching resource cost for ${resourceId}:`, error);\n      // Return null instead of throwing to allow graceful fallback\n      return null;\n    }\n  }\n\n  /**\n   * Get cost optimization recommendations from AWS Cost Explorer\n   */\n  async getCostRecommendations(): Promise<CostRecommendations> {\n    try {\n      // Fetch Reserved Instance recommendations\n      const riRecommendations: any[] = [];\n      try {\n        const riResponse = await this.costExplorerClient.send(\n          new GetReservationPurchaseRecommendationCommand({\n            Service: 'Amazon Elastic Compute Cloud - Compute',\n            PaymentOption: 'NO_UPFRONT',\n            TermInYears: 'ONE_YEAR',\n            LookbackPeriodInDays: 'THIRTY_DAYS',\n          })\n        );\n\n        const recommendations = riResponse.Recommendations || [];\n        for (const rec of recommendations) {\n          const details = rec.RecommendationDetails?.[0];\n          if (!details) continue;\n\n          riRecommendations.push({\n            serviceCode: 'AmazonEC2',\n            instanceType: details.InstanceDetails?.EC2InstanceDetails?.InstanceType || 'Unknown',\n            region: details.InstanceDetails?.EC2InstanceDetails?.Region || 'Unknown',\n            paymentOption: 'NO_UPFRONT',\n            term: 'ONE_YEAR',\n            estimatedMonthlySavings: Math.round(\n              parseFloat(rec.RecommendationSummary?.TotalEstimatedMonthlySavingsAmount || '0') * 100\n            ),\n            estimatedSavingsPercentage: parseFloat(\n              rec.RecommendationSummary?.TotalEstimatedMonthlySavingsPercentage || '0'\n            ),\n            upfrontCost: Math.round(\n              parseFloat(details.RecommendedNormalizedUnitsToPurchase || '0') * \n              parseFloat(details.RecurringStandardMonthlyCost || '0') * 100\n            ),\n            recommendedQuantity: parseFloat(details.RecommendedNormalizedUnitsToPurchase || '0'),\n          });\n        }\n      } catch (error) {\n        console.log('No RI recommendations available or error fetching:', error);\n      }\n\n      // Fetch Savings Plans recommendations\n      const spRecommendations: any[] = [];\n      try {\n        const spResponse = await this.costExplorerClient.send(\n          new GetSavingsPlansPurchaseRecommendationCommand({\n            SavingsPlansType: 'COMPUTE_SP',\n            PaymentOption: 'NO_UPFRONT',\n            TermInYears: 'ONE_YEAR',\n            LookbackPeriodInDays: 'THIRTY_DAYS',\n          })\n        );\n\n        const recommendations = spResponse.SavingsPlansPurchaseRecommendation?.SavingsPlansPurchaseRecommendationDetails || [];\n        for (const rec of recommendations) {\n          spRecommendations.push({\n            planType: 'COMPUTE_SP',\n            paymentOption: 'NO_UPFRONT',\n            term: 'ONE_YEAR',\n            hourlyCommitment: Math.round(parseFloat(rec.HourlyCommitmentToPurchase || '0') * 100),\n            estimatedMonthlySavings: Math.round(parseFloat(rec.EstimatedMonthlySavingsAmount || '0') * 100),\n            estimatedSavingsPercentage: parseFloat(rec.EstimatedSavingsPercentage || '0'),\n            upfrontCost: Math.round(parseFloat(rec.UpfrontCost || '0') * 100),\n          });\n        }\n      } catch (error) {\n        console.log('No Savings Plans recommendations available or error fetching:', error);\n      }\n\n      // Fetch Rightsizing recommendations\n      const rightsizingRecommendations: any[] = [];\n      try {\n        const rightSizeResponse = await this.costExplorerClient.send(\n          new GetRightsizingRecommendationCommand({\n            Service: 'AmazonEC2',\n          })\n        );\n\n        const recommendations = rightSizeResponse.RightsizingRecommendations || [];\n        for (const rec of recommendations) {\n          // Type-safe check for Modify type\n          if (rec.RightsizingType?.toLowerCase() !== 'modify') continue;\n\n          const current = rec.CurrentInstance;\n          const target = rec.ModifyRecommendationDetail?.TargetInstances?.[0];\n\n          if (!current || !target) continue;\n\n          // Extract tag value safely\n          const nameTag = current.Tags?.find(t => t.Key === 'Name');\n          const resourceName = nameTag?.Values?.[0];\n\n          // Get instance types safely\n          const currentType = current.ResourceDetails?.EC2ResourceDetails?.InstanceType || 'Unknown';\n          const targetType = (target as any).DefaultTargetInstance?.InstanceType || 'Unknown';\n\n          // Calculate savings percentage from available data\n          const monthlySavings = parseFloat(target.EstimatedMonthlySavings || '0');\n          const monthlyCost = parseFloat(target.EstimatedMonthlyCost || '0');\n          const savingsPercentage = monthlyCost > 0 \n            ? ((monthlySavings / monthlyCost) * 100) \n            : 0;\n\n          rightsizingRecommendations.push({\n            resourceId: current.ResourceId || 'Unknown',\n            resourceName: resourceName,\n            currentInstanceType: currentType,\n            recommendedInstanceType: targetType,\n            region: current.ResourceDetails?.EC2ResourceDetails?.Region || 'Unknown',\n            estimatedMonthlySavings: Math.round(monthlySavings * 100),\n            estimatedSavingsPercentage: savingsPercentage,\n            reason: `Instance is underutilized. Current average CPU: ${\n              current.ResourceUtilization?.EC2ResourceUtilization?.MaxCpuUtilizationPercentage || 'Unknown'\n            }%`,\n            cpuUtilization: parseFloat(\n              current.ResourceUtilization?.EC2ResourceUtilization?.MaxCpuUtilizationPercentage || '0'\n            ),\n          });\n        }\n      } catch (error) {\n        console.log('No rightsizing recommendations available or error fetching:', error);\n      }\n\n      // Calculate total estimated savings\n      const totalEstimatedMonthlySavings = \n        riRecommendations.reduce((sum, r) => sum + r.estimatedMonthlySavings, 0) +\n        spRecommendations.reduce((sum, r) => sum + r.estimatedMonthlySavings, 0) +\n        rightsizingRecommendations.reduce((sum, r) => sum + r.estimatedMonthlySavings, 0);\n\n      return {\n        reservedInstances: riRecommendations,\n        savingsPlans: spRecommendations,\n        rightsizing: rightsizingRecommendations,\n        totalEstimatedMonthlySavings,\n      };\n    } catch (error: any) {\n      console.error('Error fetching cost recommendations:', error);\n      throw new Error(`Failed to fetch cost recommendations: ${error.message}`);\n    }\n  }\n}\n","size_bytes":52143},"client/src/components/CostSummary.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Label } from \"@/components/ui/label\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { TrendingUp, TrendingDown, DollarSign, Minus } from \"lucide-react\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\nimport type { CostSummary } from \"@shared/schema\";\n\ninterface CostSummaryProps {\n  includeCredits?: boolean;\n  onIncludeCreditsChange?: (value: boolean) => void;\n  showToggle?: boolean;\n}\n\nexport default function CostSummary({ \n  includeCredits: externalIncludeCredits,\n  onIncludeCreditsChange,\n  showToggle = true \n}: CostSummaryProps) {\n  const [internalIncludeCredits, setInternalIncludeCredits] = useState(true);\n  \n  // Use external state if provided, otherwise use internal state\n  const includeCredits = externalIncludeCredits ?? internalIncludeCredits;\n  const setIncludeCredits = onIncludeCreditsChange ?? setInternalIncludeCredits;\n\n  const { data: costData, isLoading, error } = useQuery<CostSummary>({\n    queryKey: [\"/api/costs/summary\", { includeCredits }],\n    queryFn: async () => {\n      const response = await fetch(`/api/costs/summary?includeCredits=${includeCredits}`, {\n        credentials: 'include'\n      });\n      if (!response.ok) {\n        const errorData = await response.json();\n        throw new Error(errorData.message || 'Failed to fetch cost summary');\n      }\n      return response.json();\n    },\n  });\n\n  const formatCurrency = (cents: number) => {\n    return `$${(cents / 100).toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;\n  };\n\n  const formatDate = (dateString: string) => {\n    const date = new Date(dateString);\n    return date.toLocaleDateString('en-US', { month: 'short', year: 'numeric' });\n  };\n\n  if (error) {\n    return (\n      <Alert data-testid=\"alert-cost-error\">\n        <AlertDescription>\n          {(error as Error).message}\n        </AlertDescription>\n      </Alert>\n    );\n  }\n\n  if (isLoading) {\n    return (\n      <Card>\n        <CardHeader className=\"flex flex-row items-center justify-between gap-4 space-y-0 pb-4\">\n          <Skeleton className=\"h-6 w-48\" />\n          <Skeleton className=\"h-6 w-32\" />\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n            <Skeleton className=\"h-24 w-full\" />\n            <Skeleton className=\"h-24 w-full\" />\n            <Skeleton className=\"h-24 w-full\" />\n          </div>\n          <Skeleton className=\"h-48 w-full\" />\n        </CardContent>\n      </Card>\n    );\n  }\n\n  if (!costData) {\n    return null;\n  }\n\n  const isIncrease = costData.costDifference > 0;\n  const isDecrease = costData.costDifference < 0;\n  const percentageChangeAbs = Math.abs(costData.percentageChange);\n\n  return (\n    <Card data-testid=\"card-cost-summary\">\n      <CardHeader className=\"flex flex-row flex-wrap items-center justify-between gap-4 space-y-0 pb-4\">\n        <CardTitle className=\"text-lg font-semibold\">AWS Cost Comparison</CardTitle>\n        {showToggle && (\n          <div className=\"flex items-center gap-2\">\n            <Switch\n              id=\"cost-summary-credits\"\n              checked={includeCredits}\n              onCheckedChange={setIncludeCredits}\n              data-testid=\"switch-cost-summary-credits\"\n            />\n            <Label htmlFor=\"cost-summary-credits\" className=\"text-sm cursor-pointer\">\n              {includeCredits ? 'With Credits' : 'Without Credits'}\n            </Label>\n          </div>\n        )}\n      </CardHeader>\n      <CardContent className=\"space-y-6\">\n        {/* Cost Comparison Cards */}\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n          {/* Current Month */}\n          <div className=\"space-y-2\">\n            <p className=\"text-sm text-muted-foreground\">\n              Current Month ({formatDate(costData.currentMonth.startDate)})\n            </p>\n            <div className=\"text-3xl font-bold\" data-testid=\"text-current-cost\">\n              {formatCurrency(costData.currentMonth.amount)}\n            </div>\n            <p className=\"text-xs text-muted-foreground\">\n              as of {formatDate(costData.currentMonth.endDate)}\n            </p>\n          </div>\n\n          {/* Previous Month */}\n          <div className=\"space-y-2\">\n            <p className=\"text-sm text-muted-foreground\">\n              Previous Month ({formatDate(costData.previousMonth.startDate)})\n            </p>\n            <div className=\"text-3xl font-bold\" data-testid=\"text-previous-cost\">\n              {formatCurrency(costData.previousMonth.amount)}\n            </div>\n            <p className=\"text-xs text-muted-foreground\">\n              full month\n            </p>\n          </div>\n\n          {/* Change */}\n          <div className=\"space-y-2\">\n            <p className=\"text-sm text-muted-foreground\">Month-over-Month Change</p>\n            <div className=\"flex items-center gap-2\">\n              <div \n                className={`text-3xl font-bold ${isIncrease ? 'text-destructive' : isDecrease ? 'text-primary' : ''}`}\n                data-testid=\"text-cost-change\"\n              >\n                {isIncrease ? '+' : ''}{formatCurrency(costData.costDifference)}\n              </div>\n              {isIncrease && <TrendingUp className=\"h-6 w-6 text-destructive\" data-testid=\"icon-trending-up\" />}\n              {isDecrease && <TrendingDown className=\"h-6 w-6 text-primary\" data-testid=\"icon-trending-down\" />}\n              {!isIncrease && !isDecrease && <Minus className=\"h-6 w-6 text-muted-foreground\" data-testid=\"icon-no-change\" />}\n            </div>\n            <p className={`text-xs font-medium ${isIncrease ? 'text-destructive' : isDecrease ? 'text-primary' : 'text-muted-foreground'}`}>\n              {isIncrease ? '+' : isDecrease ? '-' : ''}{percentageChangeAbs.toFixed(1)}% {isIncrease ? 'increase' : isDecrease ? 'decrease' : 'no change'}\n            </p>\n          </div>\n        </div>\n\n        {/* Top Services */}\n        {costData.topServices.length > 0 && (\n          <div className=\"space-y-3\">\n            <h3 className=\"text-sm font-medium\">Top 5 Services by Cost</h3>\n            <div className=\"space-y-2\">\n              {costData.topServices.map((service, index) => {\n                const percentage = costData.currentMonth.amount > 0 \n                  ? (service.amount / costData.currentMonth.amount) * 100 \n                  : 0;\n                \n                return (\n                  <div key={service.service} className=\"space-y-1\" data-testid={`service-${index}`}>\n                    <div className=\"flex items-center justify-between text-sm\">\n                      <span className=\"font-medium\">{service.service}</span>\n                      <span className=\"text-muted-foreground\">{formatCurrency(service.amount)}</span>\n                    </div>\n                    <div className=\"w-full bg-muted rounded-full h-2\">\n                      <div \n                        className=\"bg-primary rounded-full h-2 transition-all\" \n                        style={{ width: `${Math.min(percentage, 100)}%` }}\n                      />\n                    </div>\n                    <p className=\"text-xs text-muted-foreground\">\n                      {percentage.toFixed(1)}% of total\n                    </p>\n                  </div>\n                );\n              })}\n            </div>\n          </div>\n        )}\n\n        {costData.topServices.length === 0 && (\n          <div className=\"text-center py-6 text-muted-foreground\">\n            <DollarSign className=\"h-12 w-12 mx-auto mb-2 opacity-50\" />\n            <p>No service cost data available yet</p>\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}\n","size_bytes":7891},"server/steampipe-service.ts":{"content":"import { exec } from 'child_process';\nimport { promisify } from 'util';\nimport path from 'path';\n\nconst execAsync = promisify(exec);\n\nconst STEAMPIPE_BIN = path.join(process.cwd(), '.local/bin/steampipe');\nconst POWERPIPE_BIN = path.join(process.cwd(), '.local/bin/powerpipe');\nconst POWERPIPE_WORKSPACE = path.join(process.env.HOME || '/home/runner', 'steampipe-workspace');\n\nexport interface SteampipeControl {\n  name: string;\n  status: 'ok' | 'alarm' | 'error' | 'skip' | 'info';\n  reason: string;\n  resource: string;\n  dimensions?: Record<string, string>;\n}\n\nexport interface SteampipeBenchmarkResult {\n  name: string;\n  title: string;\n  description: string;\n  summary: {\n    status: {\n      ok: number;\n      alarm: number;\n      error: number;\n      skip: number;\n      info: number;\n    };\n  };\n  controls: SteampipeControl[];\n}\n\nexport class SteampipeService {\n  private static instance: SteampipeService;\n  \n  private constructor() {}\n  \n  static getInstance(): SteampipeService {\n    if (!SteampipeService.instance) {\n      SteampipeService.instance = new SteampipeService();\n    }\n    return SteampipeService.instance;\n  }\n\n  async runBenchmark(\n    benchmarkName: string,\n    awsAccessKeyId: string,\n    awsSecretAccessKey: string,\n    awsRegion: string = 'us-east-1'\n  ): Promise<SteampipeBenchmarkResult> {\n    try {\n      const env = {\n        ...process.env,\n        AWS_ACCESS_KEY_ID: awsAccessKeyId,\n        AWS_SECRET_ACCESS_KEY: awsSecretAccessKey,\n        AWS_REGION: awsRegion,\n        STEAMPIPE_INSTALL_DIR: path.dirname(STEAMPIPE_BIN),\n      };\n\n      const command = `cd ${POWERPIPE_WORKSPACE} && ${POWERPIPE_BIN} benchmark run ${benchmarkName} --output json`;\n      \n      const { stdout, stderr } = await execAsync(command, {\n        env,\n        maxBuffer: 10 * 1024 * 1024, // 10MB buffer\n        timeout: 300000, // 5 minute timeout\n      });\n\n      if (stderr && !stderr.includes('Warning')) {\n        console.error('Steampipe stderr:', stderr);\n      }\n\n      return this.parseBenchmarkOutput(stdout);\n    } catch (error: any) {\n      console.error('Error running Steampipe benchmark:', error);\n      throw new Error(`Failed to run benchmark ${benchmarkName}: ${error.message}`);\n    }\n  }\n\n  private parseBenchmarkOutput(jsonOutput: string): SteampipeBenchmarkResult {\n    try {\n      const lines = jsonOutput.trim().split('\\n');\n      const lastLine = lines[lines.length - 1];\n      const result = JSON.parse(lastLine);\n\n      return {\n        name: result.name || result.benchmark?.name || 'unknown',\n        title: result.title || result.benchmark?.title || 'Unknown Benchmark',\n        description: result.description || result.benchmark?.description || '',\n        summary: {\n          status: {\n            ok: result.summary?.status?.ok || 0,\n            alarm: result.summary?.status?.alarm || 0,\n            error: result.summary?.status?.error || 0,\n            skip: result.summary?.status?.skip || 0,\n            info: result.summary?.status?.info || 0,\n          },\n        },\n        controls: this.extractControls(result),\n      };\n    } catch (error: any) {\n      console.error('Error parsing benchmark output:', error);\n      throw new Error(`Failed to parse benchmark output: ${error.message}`);\n    }\n  }\n\n  private extractControls(result: any): SteampipeControl[] {\n    const controls: SteampipeControl[] = [];\n\n    const processNode = (node: any) => {\n      if (node.control_results) {\n        for (const control of node.control_results) {\n          controls.push({\n            name: control.control?.title || control.title || 'Unknown Control',\n            status: control.status || 'skip',\n            reason: control.reason || '',\n            resource: control.resource || '',\n            dimensions: control.dimensions || {},\n          });\n        }\n      }\n\n      if (node.children) {\n        for (const child of node.children) {\n          processNode(child);\n        }\n      }\n    };\n\n    processNode(result);\n    return controls;\n  }\n\n  async runEC2Benchmark(accessKeyId: string, secretAccessKey: string, region: string) {\n    return this.runBenchmark('aws_thrifty.benchmark.ec2', accessKeyId, secretAccessKey, region);\n  }\n\n  async runRDSBenchmark(accessKeyId: string, secretAccessKey: string, region: string) {\n    return this.runBenchmark('aws_thrifty.benchmark.rds', accessKeyId, secretAccessKey, region);\n  }\n\n  async runS3Benchmark(accessKeyId: string, secretAccessKey: string, region: string) {\n    return this.runBenchmark('aws_thrifty.benchmark.s3', accessKeyId, secretAccessKey, region);\n  }\n\n  async runDynamoDBBenchmark(accessKeyId: string, secretAccessKey: string, region: string) {\n    return this.runBenchmark('aws_thrifty.benchmark.dynamodb', accessKeyId, secretAccessKey, region);\n  }\n\n  async runElastiCacheBenchmark(accessKeyId: string, secretAccessKey: string, region: string) {\n    return this.runBenchmark('aws_thrifty.benchmark.elasticache', accessKeyId, secretAccessKey, region);\n  }\n\n  async runRedshiftBenchmark(accessKeyId: string, secretAccessKey: string, region: string) {\n    return this.runBenchmark('aws_thrifty.benchmark.redshift', accessKeyId, secretAccessKey, region);\n  }\n\n  async runLambdaBenchmark(accessKeyId: string, secretAccessKey: string, region: string) {\n    return this.runBenchmark('aws_thrifty.benchmark.lambda', accessKeyId, secretAccessKey, region);\n  }\n\n  async runAllBenchmarks(accessKeyId: string, secretAccessKey: string, region: string) {\n    const benchmarks = [\n      'ec2',\n      'rds',\n      's3',\n      'dynamodb',\n      'elasticache',\n      'redshift',\n      'lambda',\n    ];\n\n    const results: Record<string, SteampipeBenchmarkResult> = {};\n\n    for (const benchmark of benchmarks) {\n      try {\n        console.log(`Running ${benchmark} benchmark...`);\n        results[benchmark] = await this.runBenchmark(\n          `aws_thrifty.benchmark.${benchmark}`,\n          accessKeyId,\n          secretAccessKey,\n          region\n        );\n      } catch (error: any) {\n        console.error(`Failed to run ${benchmark} benchmark:`, error.message);\n        results[benchmark] = {\n          name: benchmark,\n          title: `${benchmark.toUpperCase()} Benchmark`,\n          description: 'Failed to run',\n          summary: {\n            status: { ok: 0, alarm: 0, error: 1, skip: 0, info: 0 },\n          },\n          controls: [],\n        };\n      }\n    }\n\n    return results;\n  }\n\n  async calculateSavingsFromControls(\n    controls: SteampipeControl[],\n    pricingService: any\n  ): Promise<number> {\n    let totalSavings = 0;\n\n    for (const control of controls) {\n      if (control.status === 'ok') {\n        continue; // No savings for passing controls\n      }\n\n      try {\n        // Extract resource ID from the control resource field\n        // Format is typically \"arn:aws:service:region:account:resource/id\"\n        const resourceId = this.extractResourceId(control.resource);\n        const resourceType = this.extractResourceType(control.resource);\n\n        // Calculate savings based on control type\n        const savings = await pricingService.calculateSavingsForControl(\n          control.name,\n          resourceId,\n          resourceType\n        );\n\n        totalSavings += savings;\n      } catch (error) {\n        console.error(`Error calculating savings for control ${control.name}:`, error);\n        // Continue with other controls\n      }\n    }\n\n    return totalSavings;\n  }\n\n  private extractResourceId(resourceArn: string): string {\n    if (!resourceArn) return '';\n    \n    // Try to extract ID from ARN format\n    const arnParts = resourceArn.split('/');\n    if (arnParts.length > 1) {\n      return arnParts[arnParts.length - 1];\n    }\n    \n    // If not an ARN, return the whole string\n    return resourceArn;\n  }\n\n  private extractResourceType(resourceArn: string): string {\n    if (!resourceArn) return 'Unknown';\n    \n    // Extract service from ARN: arn:aws:SERVICE:region:account:resource\n    const arnParts = resourceArn.split(':');\n    if (arnParts.length >= 3 && arnParts[0] === 'arn') {\n      const service = arnParts[2];\n      \n      // Map AWS service names to our resource types\n      const serviceMap: Record<string, string> = {\n        'ec2': 'EC2',\n        'rds': 'RDS',\n        's3': 'S3',\n        'dynamodb': 'DynamoDB',\n        'elasticache': 'ElastiCache',\n        'redshift': 'Redshift',\n        'lambda': 'Lambda',\n      };\n      \n      return serviceMap[service] || service.toUpperCase();\n    }\n    \n    return 'Unknown';\n  }\n}\n\nexport const steampipeService = SteampipeService.getInstance();\n","size_bytes":8555},"client/src/components/CostRecommendations.tsx":{"content":"import { useQuery } from '@tanstack/react-query';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Badge } from '@/components/ui/badge';\nimport { Loader2, TrendingDown, Server, Zap, Scale } from 'lucide-react';\nimport type { CostRecommendations } from '@shared/schema';\n\nexport function CostRecommendationsPanel() {\n  const { data: recommendations, isLoading, error } = useQuery<CostRecommendations>({\n    queryKey: ['/api/costs/recommendations'],\n    queryFn: async () => {\n      const response = await fetch('/api/costs/recommendations', {\n        credentials: 'include'\n      });\n      if (!response.ok) {\n        const errorData = await response.json();\n        throw new Error(errorData.message || 'Failed to fetch cost recommendations');\n      }\n      return response.json();\n    },\n  });\n\n  const formatCurrency = (cents: number) => {\n    return new Intl.NumberFormat('en-US', {\n      style: 'currency',\n      currency: 'USD',\n      minimumFractionDigits: 2,\n      maximumFractionDigits: 2,\n    }).format(cents / 100);\n  };\n\n  const formatPercentage = (value: number) => {\n    return `${value.toFixed(1)}%`;\n  };\n\n  if (isLoading) {\n    return (\n      <Card data-testid=\"card-recommendations\">\n        <CardHeader>\n          <CardTitle>Cost Optimization Recommendations</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"flex items-center justify-center py-8\">\n            <Loader2 className=\"h-8 w-8 animate-spin text-muted-foreground\" />\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  if (error) {\n    return (\n      <Card data-testid=\"card-recommendations\">\n        <CardHeader>\n          <CardTitle>Cost Optimization Recommendations</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <p className=\"text-sm text-destructive\" data-testid=\"text-error\">\n            {error instanceof Error ? error.message : 'Failed to load recommendations'}\n          </p>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  if (!recommendations) {\n    return null;\n  }\n\n  const hasRecommendations = \n    recommendations.reservedInstances.length > 0 ||\n    recommendations.savingsPlans.length > 0 ||\n    recommendations.rightsizing.length > 0;\n\n  if (!hasRecommendations) {\n    return (\n      <Card data-testid=\"card-recommendations\">\n        <CardHeader>\n          <CardTitle>Cost Optimization Recommendations</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"text-center py-8\">\n            <p className=\"text-muted-foreground\">\n              No recommendations available at this time. This could mean:\n            </p>\n            <ul className=\"mt-4 space-y-2 text-sm text-muted-foreground text-left max-w-md mx-auto\">\n              <li> Your resources are already optimally configured</li>\n              <li> Insufficient usage data (AWS needs 30 days of data)</li>\n              <li> Cost Explorer recommendations are not enabled</li>\n            </ul>\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <Card data-testid=\"card-recommendations\">\n      <CardHeader>\n        <div className=\"flex flex-wrap items-center justify-between gap-4\">\n          <div>\n            <CardTitle>Cost Optimization Recommendations</CardTitle>\n            <p className=\"text-sm text-muted-foreground mt-1\">\n              AWS-powered insights to reduce your infrastructure costs\n            </p>\n          </div>\n          {recommendations.totalEstimatedMonthlySavings > 0 && (\n            <div className=\"flex items-center gap-2\">\n              <TrendingDown className=\"h-5 w-5 text-primary\" />\n              <div className=\"text-right\">\n                <p className=\"text-xs text-muted-foreground\">Potential Monthly Savings</p>\n                <p className=\"text-2xl font-bold text-primary\" data-testid=\"text-total-savings\">\n                  {formatCurrency(recommendations.totalEstimatedMonthlySavings)}\n                </p>\n              </div>\n            </div>\n          )}\n        </div>\n      </CardHeader>\n      <CardContent>\n        <Tabs defaultValue=\"savings-plans\" className=\"w-full\">\n          <TabsList className=\"grid w-full grid-cols-3\">\n            <TabsTrigger value=\"savings-plans\" data-testid=\"tab-savings-plans\">\n              <Zap className=\"h-4 w-4 mr-2\" />\n              Savings Plans ({recommendations.savingsPlans.length})\n            </TabsTrigger>\n            <TabsTrigger value=\"reserved-instances\" data-testid=\"tab-reserved-instances\">\n              <Server className=\"h-4 w-4 mr-2\" />\n              Reserved Instances ({recommendations.reservedInstances.length})\n            </TabsTrigger>\n            <TabsTrigger value=\"rightsizing\" data-testid=\"tab-rightsizing\">\n              <Scale className=\"h-4 w-4 mr-2\" />\n              Rightsizing ({recommendations.rightsizing.length})\n            </TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"savings-plans\" className=\"space-y-4 mt-4\">\n            {recommendations.savingsPlans.length === 0 ? (\n              <p className=\"text-sm text-muted-foreground py-4\">\n                No Savings Plans recommendations available.\n              </p>\n            ) : (\n              <div className=\"space-y-3\">\n                {recommendations.savingsPlans.map((plan, idx) => (\n                  <div \n                    key={idx}\n                    className=\"border rounded-md p-4 space-y-3 hover-elevate\"\n                    data-testid={`savings-plan-${idx}`}\n                  >\n                    <div className=\"flex flex-wrap items-start justify-between gap-4\">\n                      <div className=\"space-y-1\">\n                        <div className=\"flex items-center gap-2\">\n                          <Badge variant=\"secondary\">{plan.planType}</Badge>\n                          <Badge variant=\"outline\">{plan.term}</Badge>\n                          <Badge variant=\"outline\">{plan.paymentOption}</Badge>\n                        </div>\n                        <p className=\"text-sm text-muted-foreground\">\n                          Commit to {formatCurrency(plan.hourlyCommitment)}/hour\n                        </p>\n                      </div>\n                      <div className=\"text-right\">\n                        <p className=\"text-xs text-muted-foreground\">Estimated Monthly Savings</p>\n                        <p className=\"text-xl font-bold text-primary\">\n                          {formatCurrency(plan.estimatedMonthlySavings)}\n                        </p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          {formatPercentage(plan.estimatedSavingsPercentage)} savings\n                        </p>\n                      </div>\n                    </div>\n                    {plan.upfrontCost > 0 && (\n                      <div className=\"pt-2 border-t\">\n                        <p className=\"text-xs text-muted-foreground\">\n                          Upfront cost: <span className=\"font-medium\">{formatCurrency(plan.upfrontCost)}</span>\n                        </p>\n                      </div>\n                    )}\n                  </div>\n                ))}\n              </div>\n            )}\n          </TabsContent>\n\n          <TabsContent value=\"reserved-instances\" className=\"space-y-4 mt-4\">\n            {recommendations.reservedInstances.length === 0 ? (\n              <p className=\"text-sm text-muted-foreground py-4\">\n                No Reserved Instance recommendations available.\n              </p>\n            ) : (\n              <div className=\"space-y-3\">\n                {recommendations.reservedInstances.map((ri, idx) => (\n                  <div \n                    key={idx}\n                    className=\"border rounded-md p-4 space-y-3 hover-elevate\"\n                    data-testid={`reserved-instance-${idx}`}\n                  >\n                    <div className=\"flex flex-wrap items-start justify-between gap-4\">\n                      <div className=\"space-y-1\">\n                        <div className=\"flex items-center gap-2\">\n                          <Badge variant=\"secondary\">{ri.instanceType}</Badge>\n                          <Badge variant=\"outline\">{ri.region}</Badge>\n                        </div>\n                        <p className=\"text-sm text-muted-foreground\">\n                          {ri.term}  {ri.paymentOption}  Qty: {ri.recommendedQuantity}\n                        </p>\n                      </div>\n                      <div className=\"text-right\">\n                        <p className=\"text-xs text-muted-foreground\">Estimated Monthly Savings</p>\n                        <p className=\"text-xl font-bold text-primary\">\n                          {formatCurrency(ri.estimatedMonthlySavings)}\n                        </p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          {formatPercentage(ri.estimatedSavingsPercentage)} savings\n                        </p>\n                      </div>\n                    </div>\n                    {ri.upfrontCost > 0 && (\n                      <div className=\"pt-2 border-t\">\n                        <p className=\"text-xs text-muted-foreground\">\n                          Estimated upfront cost: <span className=\"font-medium\">{formatCurrency(ri.upfrontCost)}</span>\n                        </p>\n                      </div>\n                    )}\n                  </div>\n                ))}\n              </div>\n            )}\n          </TabsContent>\n\n          <TabsContent value=\"rightsizing\" className=\"space-y-4 mt-4\">\n            {recommendations.rightsizing.length === 0 ? (\n              <p className=\"text-sm text-muted-foreground py-4\">\n                No rightsizing recommendations available. Your instances appear to be appropriately sized.\n              </p>\n            ) : (\n              <div className=\"space-y-3\">\n                {recommendations.rightsizing.map((rec, idx) => (\n                  <div \n                    key={idx}\n                    className=\"border rounded-md p-4 space-y-3 hover-elevate\"\n                    data-testid={`rightsizing-${idx}`}\n                  >\n                    <div className=\"flex flex-wrap items-start justify-between gap-4\">\n                      <div className=\"space-y-1 flex-1\">\n                        <div className=\"flex items-center gap-2\">\n                          <Badge variant=\"destructive\">{rec.currentInstanceType}</Badge>\n                          <span className=\"text-muted-foreground\"></span>\n                          <Badge variant=\"secondary\">{rec.recommendedInstanceType}</Badge>\n                        </div>\n                        <p className=\"text-sm text-muted-foreground\">\n                          {rec.resourceId}  {rec.region}\n                        </p>\n                        {rec.resourceName && (\n                          <p className=\"text-xs text-muted-foreground\">\n                            {rec.resourceName}\n                          </p>\n                        )}\n                      </div>\n                      <div className=\"text-right\">\n                        <p className=\"text-xs text-muted-foreground\">Estimated Monthly Savings</p>\n                        <p className=\"text-xl font-bold text-primary\">\n                          {formatCurrency(rec.estimatedMonthlySavings)}\n                        </p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          {formatPercentage(rec.estimatedSavingsPercentage)} savings\n                        </p>\n                      </div>\n                    </div>\n                    <div className=\"pt-2 border-t space-y-1\">\n                      <p className=\"text-xs text-muted-foreground\">{rec.reason}</p>\n                      {rec.cpuUtilization !== undefined && (\n                        <p className=\"text-xs text-muted-foreground\">\n                          Average CPU: {formatPercentage(rec.cpuUtilization)}\n                        </p>\n                      )}\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n          </TabsContent>\n        </Tabs>\n      </CardContent>\n    </Card>\n  );\n}\n","size_bytes":12314},"client/src/components/AllServicesCosts.tsx":{"content":"import { useState } from 'react';\nimport { useQuery } from '@tanstack/react-query';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { ChevronDown, ChevronRight, Loader2 } from 'lucide-react';\nimport type { ServiceBreakdown, ServiceResources } from '@shared/schema';\n\ninterface AllServicesCostsProps {\n  includeCredits: boolean;\n}\n\nexport function AllServicesCosts({ includeCredits }: AllServicesCostsProps) {\n  const [expandedService, setExpandedService] = useState<string | null>(null);\n\n  const { data: services, isLoading, error } = useQuery<ServiceBreakdown[]>({\n    queryKey: ['/api/costs/services', { includeCredits }],\n    queryFn: async () => {\n      const response = await fetch(`/api/costs/services?includeCredits=${includeCredits}`, {\n        credentials: 'include'\n      });\n      if (!response.ok) {\n        const errorData = await response.json();\n        throw new Error(errorData.message || 'Failed to fetch services costs');\n      }\n      return response.json();\n    },\n  });\n\n  const formatCurrency = (cents: number) => {\n    return new Intl.NumberFormat('en-US', {\n      style: 'currency',\n      currency: 'USD',\n      minimumFractionDigits: 2,\n      maximumFractionDigits: 2,\n    }).format(cents / 100);\n  };\n\n  const toggleService = (serviceCode: string) => {\n    setExpandedService(expandedService === serviceCode ? null : serviceCode);\n  };\n\n  if (isLoading) {\n    return (\n      <Card data-testid=\"card-services-costs\">\n        <CardHeader>\n          <CardTitle>All Services Costs</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"flex items-center justify-center py-8\">\n            <Loader2 className=\"h-8 w-8 animate-spin text-muted-foreground\" />\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  if (error) {\n    return (\n      <Card data-testid=\"card-services-costs\">\n        <CardHeader>\n          <CardTitle>All Services Costs</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <p className=\"text-sm text-destructive\" data-testid=\"text-error\">\n            {error instanceof Error ? error.message : 'Failed to load services costs'}\n          </p>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  if (!services || services.length === 0) {\n    return (\n      <Card data-testid=\"card-services-costs\">\n        <CardHeader>\n          <CardTitle>All Services Costs</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <p className=\"text-sm text-muted-foreground\">\n            No services with costs found for this month.\n          </p>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <Card data-testid=\"card-services-costs\">\n      <CardHeader>\n        <CardTitle>All Services Costs</CardTitle>\n        <p className=\"text-sm text-muted-foreground\">\n          {services.length} service{services.length !== 1 ? 's' : ''} with costs this month\n        </p>\n      </CardHeader>\n      <CardContent>\n        <div className=\"space-y-2\">\n          {services.map((service) => (\n            <div key={service.serviceCode} className=\"border rounded-md\">\n              <Button\n                variant=\"ghost\"\n                className=\"w-full justify-between p-4 h-auto hover-elevate\"\n                onClick={() => toggleService(service.serviceCode)}\n                data-testid={`button-service-${service.serviceCode}`}\n              >\n                <div className=\"flex items-center gap-3 flex-1 text-left\">\n                  {expandedService === service.serviceCode ? (\n                    <ChevronDown className=\"h-4 w-4 flex-shrink-0\" />\n                  ) : (\n                    <ChevronRight className=\"h-4 w-4 flex-shrink-0\" />\n                  )}\n                  <div className=\"flex-1 min-w-0\">\n                    <p className=\"font-medium truncate\" data-testid={`text-service-name-${service.serviceCode}`}>\n                      {service.serviceName}\n                    </p>\n                    <p className=\"text-xs text-muted-foreground truncate\">\n                      {service.serviceCode}\n                    </p>\n                  </div>\n                </div>\n                <div className=\"font-semibold text-right\" data-testid={`text-service-amount-${service.serviceCode}`}>\n                  {formatCurrency(service.amount)}\n                </div>\n              </Button>\n              {expandedService === service.serviceCode && (\n                <ServiceResourcesDetail \n                  serviceCode={service.serviceCode}\n                  includeCredits={includeCredits}\n                />\n              )}\n            </div>\n          ))}\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n\ninterface ServiceResourcesDetailProps {\n  serviceCode: string;\n  includeCredits: boolean;\n}\n\nfunction ServiceResourcesDetail({ serviceCode, includeCredits }: ServiceResourcesDetailProps) {\n  const { data: resources, isLoading, error } = useQuery<ServiceResources>({\n    queryKey: ['/api/costs/services', serviceCode, 'resources', { includeCredits }],\n    queryFn: async () => {\n      const response = await fetch(\n        `/api/costs/services/${encodeURIComponent(serviceCode)}/resources?includeCredits=${includeCredits}`,\n        { credentials: 'include' }\n      );\n      if (!response.ok) {\n        const errorData = await response.json();\n        throw new Error(errorData.message || 'Failed to fetch service resources');\n      }\n      return response.json();\n    },\n  });\n\n  const formatCurrency = (cents: number) => {\n    return new Intl.NumberFormat('en-US', {\n      style: 'currency',\n      currency: 'USD',\n      minimumFractionDigits: 2,\n      maximumFractionDigits: 2,\n    }).format(cents / 100);\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"p-4 border-t bg-muted/20\">\n        <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n          <Loader2 className=\"h-4 w-4 animate-spin\" />\n          Loading resource details...\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"p-4 border-t bg-muted/20\">\n        <p className=\"text-sm text-destructive\">\n          {error instanceof Error ? error.message : 'Failed to load resource details'}\n        </p>\n      </div>\n    );\n  }\n\n  if (!resources || resources.byRegion.length === 0) {\n    return (\n      <div className=\"p-4 border-t bg-muted/20\">\n        <p className=\"text-sm text-muted-foreground\">\n          No detailed resource information available for this service.\n        </p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"p-4 border-t bg-muted/20 space-y-4\" data-testid={`detail-service-${serviceCode}`}>\n      <div className=\"space-y-3\">\n        {resources.byRegion.map((regionData) => (\n          <div key={regionData.region} className=\"space-y-2\">\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-2\">\n                <div className=\"h-2 w-2 rounded-full bg-primary\" />\n                <span className=\"font-medium text-sm\" data-testid={`text-region-${regionData.region}`}>\n                  {regionData.region}\n                </span>\n              </div>\n              <span className=\"text-sm font-semibold\" data-testid={`text-region-amount-${regionData.region}`}>\n                {formatCurrency(regionData.amount)}\n              </span>\n            </div>\n            \n            <div className=\"ml-4 space-y-1\">\n              {regionData.resources.slice(0, 10).map((resource, idx) => (\n                <div \n                  key={`${resource.resourceId}-${idx}`}\n                  className=\"flex items-center justify-between text-xs py-1 px-2 rounded-md hover-elevate\"\n                  data-testid={`resource-${resource.resourceId}`}\n                >\n                  <div className=\"flex-1 min-w-0\">\n                    <p className=\"font-mono truncate text-muted-foreground\">\n                      {resource.usageType}\n                    </p>\n                    {resource.resourceName && (\n                      <p className=\"text-xs text-muted-foreground truncate\">\n                        {resource.resourceName}\n                      </p>\n                    )}\n                  </div>\n                  <span className=\"ml-2 font-medium whitespace-nowrap\">\n                    {formatCurrency(resource.amount)}\n                  </span>\n                </div>\n              ))}\n              {regionData.resources.length > 10 && (\n                <p className=\"text-xs text-muted-foreground italic px-2\">\n                  ... and {regionData.resources.length - 10} more resource{regionData.resources.length - 10 !== 1 ? 's' : ''}\n                </p>\n              )}\n            </div>\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n}\n","size_bytes":8813},"server/pricing-service.ts":{"content":"import { AwsService, type AwsCredentials } from \"./aws-service\";\n\n/**\n * Service to calculate AWS resource costs and potential savings\n * Uses actual AWS Cost Explorer data for accurate calculations\n */\nexport class PricingService {\n  private awsService: AwsService;\n\n  constructor(credentials: AwsCredentials) {\n    this.awsService = new AwsService(credentials);\n  }\n\n  /**\n   * Get actual monthly cost for a resource using Cost Explorer\n   * Returns cost in cents, or null if data not available\n   */\n  private async getResourceMonthlyCost(\n    resourceId: string,\n    serviceCode: string\n  ): Promise<number | null> {\n    // Query last 7 days of actual costs\n    const dailyCost = await this.awsService.getResourceCost(resourceId, serviceCode, 7);\n    \n    if (dailyCost === null) {\n      return null;\n    }\n\n    // Extrapolate to monthly cost (30 days)\n    return dailyCost * 30;\n  }\n\n  /**\n   * Get total monthly cost for a service using Cost Explorer\n   * Returns cost in cents, or null if data not available\n   */\n  private async getServiceMonthlyCost(\n    serviceCode: string\n  ): Promise<number | null> {\n    try {\n      // Get service costs for last 30 days\n      const costs = await this.awsService.getAllServicesCosts(false); // Don't include credits\n      \n      // Find the service in the costs\n      const serviceCost = costs.find((c: { serviceCode: string; amount: number }) => c.serviceCode === serviceCode);\n      \n      if (!serviceCost || serviceCost.amount === 0) {\n        return null;\n      }\n      \n      // Return monthly cost in cents\n      return serviceCost.amount;\n    } catch (error) {\n      console.error(`Error fetching service cost for ${serviceCode}:`, error);\n      return null;\n    }\n  }\n\n  /**\n   * Calculate savings with explicit service code (preferred method)\n   * Uses actual Cost Explorer data when available\n   * \n   * @param resourceCount - Optional: total number of resources in the service (for better cost distribution)\n   */\n  async calculateSavingsForControlWithService(\n    controlName: string,\n    resourceId: string,\n    serviceCode: string,\n    resourceCount?: number\n  ): Promise<number> {\n    const lowerControlName = controlName.toLowerCase();\n\n    try {\n      // Try to get resource-level cost first\n      let monthlyCost = await this.getResourceMonthlyCost(resourceId, serviceCode);\n\n      // For S3, DynamoDB, and other services that don't support resource-level queries,\n      // fall back to service-level cost estimation\n      if (monthlyCost === null || monthlyCost === 0) {\n        // Check if this is a service that doesn't support resource-level queries\n        const noResourceLevelServices = [\n          'Amazon Simple Storage Service',\n          'Amazon DynamoDB',\n          'AmazonS3',\n          'AmazonDynamoDB'\n        ];\n        \n        if (noResourceLevelServices.some(s => serviceCode.includes(s))) {\n          // Get total service cost\n          const serviceCost = await this.getServiceMonthlyCost(serviceCode);\n          \n          if (serviceCost && serviceCost > 0) {\n            // If we know the resource count, distribute cost evenly across resources\n            // Otherwise, use a conservative 3% estimate (assumes ~33 resources)\n            const distributionFactor = resourceCount && resourceCount > 0 \n              ? (1 / resourceCount) \n              : 0.03; // 3% conservative default\n            \n            monthlyCost = Math.round(serviceCost * distributionFactor);\n            console.log(`Using service-level cost estimation for ${resourceId}: $${(monthlyCost / 100).toFixed(2)}/month (${(distributionFactor * 100).toFixed(1)}% of $${(serviceCost / 100).toFixed(2)} total ${serviceCode} cost${resourceCount ? `, distributed across ${resourceCount} resources` : ''})`);\n          } else {\n            console.warn(`No cost data found for resource ${resourceId} in service ${serviceCode}`);\n            return 0;\n          }\n        } else {\n          console.warn(`No cost data found for resource ${resourceId} in service ${serviceCode}`);\n          return 0;\n        }\n      }\n\n      // Determine savings percentage based on optimization type\n      let savingsPercentage = 1.0; // Default: 100% savings for stopped/unused resources\n\n      if (lowerControlName.includes('low utilization') || lowerControlName.includes('idle')) {\n        savingsPercentage = 0.6; // 60% savings for idle resources\n      } else if (lowerControlName.includes('upgrade') || lowerControlName.includes('graviton')) {\n        savingsPercentage = 0.3; // 30% savings for right-sizing/upgrades\n      } else if (lowerControlName.includes('lifecycle') || lowerControlName.includes('versioning')) {\n        savingsPercentage = 0.3; // 30% savings for storage optimizations\n      }\n\n      // Calculate savings (in cents)\n      const savings = Math.round(monthlyCost * savingsPercentage);\n      console.log(`Savings for ${resourceId}: $${(savings / 100).toFixed(2)}/month (${(savingsPercentage * 100)}% of $${(monthlyCost / 100).toFixed(2)})`);\n      return savings;\n\n    } catch (error) {\n      console.error(`Error calculating savings for ${resourceId}:`, error);\n      return 0;\n    }\n  }\n\n  /**\n   * Generic savings calculator based on control name and resource (legacy method)\n   * Uses actual Cost Explorer data when available\n   * @deprecated Use calculateSavingsForControlWithService instead\n   */\n  async calculateSavingsForControl(\n    controlName: string,\n    resourceId: string,\n    resourceType: string\n  ): Promise<number> {\n    const lowerControlName = controlName.toLowerCase();\n    const upperResourceType = resourceType.toUpperCase();\n\n    try {\n      // Map to Cost Explorer service names using both resourceType (from ARN) and control name\n      let serviceCode = 'Amazon Elastic Compute Cloud - Compute'; // default (EC2 instances)\n      \n      // Check resourceType first (more reliable than control name parsing)\n      if (upperResourceType === 'RDS' || lowerControlName.includes('rds') || lowerControlName.includes('database')) {\n        serviceCode = 'Amazon Relational Database Service';\n      } \n      // EBS volumes and snapshots use \"EC2 - Other\" service\n      else if (upperResourceType === 'EBS' || lowerControlName.includes('ebs') || lowerControlName.includes('volume') || lowerControlName.includes('snapshot')) {\n        serviceCode = 'EC2 - Other';\n      }\n      // Elastic IPs also use \"EC2 - Other\"\n      else if (lowerControlName.includes('elastic ip') || lowerControlName.includes('eip') || lowerControlName.includes('address')) {\n        serviceCode = 'EC2 - Other';\n      }\n      // Load balancers\n      else if (upperResourceType === 'ELB' || upperResourceType === 'ELASTICLOADBALANCING' || \n               lowerControlName.includes('load balancer') || lowerControlName.includes('elb') || lowerControlName.includes('alb')) {\n        serviceCode = 'Amazon Elastic Load Balancing';\n      }\n      // ElastiCache - handle plural from ARN (ELASTICACHES)\n      else if (upperResourceType.includes('ELASTICACHE') || lowerControlName.includes('elasticache') || lowerControlName.includes('cache cluster')) {\n        serviceCode = 'Amazon ElastiCache';\n      }\n      // Redshift\n      else if (upperResourceType === 'REDSHIFT' || lowerControlName.includes('redshift')) {\n        serviceCode = 'Amazon Redshift';\n      }\n      // Lambda\n      else if (upperResourceType === 'LAMBDA' || lowerControlName.includes('lambda')) {\n        serviceCode = 'AWS Lambda';\n      }\n      // S3 and DynamoDB: GetCostAndUsageWithResources doesn't support resource-level queries well\n      // Return 0 for now (can add alternative estimation logic later)\n      else if (upperResourceType === 'S3' || upperResourceType === 'DYNAMODB' || \n               lowerControlName.includes('s3') || lowerControlName.includes('dynamodb')) {\n        console.warn(`Cost Explorer resource-level data not available for ${resourceType}, returning $0`);\n        return 0;\n      }\n\n      // Get actual monthly cost from Cost Explorer\n      const monthlyCost = await this.getResourceMonthlyCost(resourceId, serviceCode);\n\n      // If Cost Explorer data not available, return 0 with warning\n      if (monthlyCost === null) {\n        console.warn(`Cost Explorer data not available for resource ${resourceId}`);\n        return 0;\n      }\n\n      // Calculate savings based on optimization type\n      let savingsPercentage = 0;\n\n      // Stopped/idle resources: save 100% by terminating\n      if (lowerControlName.includes('stopped') || lowerControlName.includes('idle')) {\n        savingsPercentage = 1.0;\n      }\n      // Unattached volumes/IPs: save 100% by deleting\n      else if (lowerControlName.includes('unattached') || lowerControlName.includes('elastic ip')) {\n        savingsPercentage = 1.0;\n      }\n      // Old snapshots: save 100% by deleting\n      else if (lowerControlName.includes('snapshot') && lowerControlName.includes('old')) {\n        savingsPercentage = 1.0;\n      }\n      // Underutilized/rightsizing: save 50-70%\n      else if (lowerControlName.includes('low utilization') || lowerControlName.includes('rightsize')) {\n        savingsPercentage = 0.6;\n      }\n      // Old generation instances: save ~30% by upgrading\n      else if (lowerControlName.includes('old') || lowerControlName.includes('generation')) {\n        savingsPercentage = 0.3;\n      }\n      // Lifecycle/versioning/on-demand: save ~30%\n      else if (lowerControlName.includes('lifecycle') || lowerControlName.includes('versioning') || \n               lowerControlName.includes('on-demand') || lowerControlName.includes('provisioned')) {\n        savingsPercentage = 0.3;\n      }\n      // Default: 20% savings for generic optimizations\n      else {\n        savingsPercentage = 0.2;\n      }\n\n      return Math.floor(monthlyCost * savingsPercentage);\n    } catch (error) {\n      console.error(`Error calculating savings for ${resourceId}:`, error);\n      return 0;\n    }\n  }\n}\n","size_bytes":9921},"server/customAuth.ts":{"content":"import bcrypt from \"bcrypt\";\nimport session from \"express-session\";\nimport type { Express, RequestHandler } from \"express\";\nimport connectPg from \"connect-pg-simple\";\nimport { storage } from \"./storage\";\nimport type { UserWithoutPassword } from \"@shared/schema\";\n\nconst SALT_ROUNDS = 10;\n\nexport function getSession() {\n  const sessionTtl = 7 * 24 * 60 * 60 * 1000; // 1 week\n  const pgStore = connectPg(session);\n  const sessionStore = new pgStore({\n    conString: process.env.DATABASE_URL,\n    createTableIfMissing: false,\n    ttl: sessionTtl,\n    tableName: \"sessions\",\n  });\n  \n  return session({\n    secret: process.env.SESSION_SECRET || 'dev-secret-change-in-production',\n    store: sessionStore,\n    resave: false,\n    saveUninitialized: false,\n    cookie: {\n      httpOnly: true,\n      secure: process.env.NODE_ENV === 'production',\n      maxAge: sessionTtl,\n    },\n  });\n}\n\nexport async function hashPassword(password: string): Promise<string> {\n  return bcrypt.hash(password, SALT_ROUNDS);\n}\n\nexport async function verifyPassword(password: string, hash: string): Promise<boolean> {\n  return bcrypt.compare(password, hash);\n}\n\ndeclare global {\n  namespace Express {\n    interface User extends UserWithoutPassword {}\n  }\n}\n\ndeclare module 'express-session' {\n  interface SessionData {\n    userId: string;\n  }\n}\n\nexport function setupAuth(app: Express) {\n  app.set(\"trust proxy\", 1);\n  app.use(getSession());\n}\n\nexport const isAuthenticated: RequestHandler = async (req, res, next) => {\n  if (!req.session.userId) {\n    return res.status(401).json({ message: \"Unauthorized\" });\n  }\n  \n  try {\n    const user = await storage.getUser(req.session.userId);\n    if (!user) {\n      req.session.destroy(() => {});\n      return res.status(401).json({ message: \"Unauthorized\" });\n    }\n    \n    // Attach user to request (without password)\n    const { password: _, ...userWithoutPassword } = user;\n    req.user = userWithoutPassword as Express.User;\n    next();\n  } catch (error) {\n    return res.status(401).json({ message: \"Unauthorized\" });\n  }\n};\n","size_bytes":2049},"client/src/pages/Signup.tsx":{"content":"import { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { z } from \"zod\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Input } from \"@/components/ui/input\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport type { SignupInput } from \"@shared/schema\";\n\nconst signupSchema = z.object({\n  email: z.string().email(\"Invalid email address\"),\n  password: z.string().min(8, \"Password must be at least 8 characters\"),\n  confirmPassword: z.string().min(1, \"Please confirm your password\"),\n  firstName: z.string().optional(),\n  lastName: z.string().optional(),\n}).refine((data) => data.password === data.confirmPassword, {\n  message: \"Passwords don't match\",\n  path: [\"confirmPassword\"],\n});\n\ntype SignupFormData = z.infer<typeof signupSchema>;\n\nexport default function Signup() {\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const [isLoading, setIsLoading] = useState(false);\n\n  const form = useForm<SignupFormData>({\n    resolver: zodResolver(signupSchema),\n    defaultValues: {\n      email: \"\",\n      password: \"\",\n      confirmPassword: \"\",\n      firstName: \"\",\n      lastName: \"\",\n    },\n  });\n\n  const signupMutation = useMutation({\n    mutationFn: async (data: SignupInput) => {\n      const response = await apiRequest(\"POST\", \"/api/auth/signup\", data);\n      return response.json();\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Account created!\",\n        description: \"Welcome to CostlyAgent\",\n      });\n      setLocation(\"/\");\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Signup failed\",\n        description: error.message || \"Failed to create account\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: SignupFormData) => {\n    setIsLoading(true);\n    const { confirmPassword, ...signupData } = data;\n    signupMutation.mutate(signupData, {\n      onSettled: () => setIsLoading(false),\n    });\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background flex items-center justify-center p-6\">\n      <Card className=\"w-full max-w-md\">\n        <CardHeader className=\"space-y-2\">\n          <CardTitle className=\"text-2xl\">Create an account</CardTitle>\n          <CardDescription>\n            Enter your details to get started with CostlyAgent\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n              <FormField\n                control={form.control}\n                name=\"email\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Email</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"email\"\n                        placeholder=\"your@email.com\"\n                        data-testid=\"input-email\"\n                        {...field}\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <div className=\"grid grid-cols-2 gap-4\">\n                <FormField\n                  control={form.control}\n                  name=\"firstName\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>First Name</FormLabel>\n                      <FormControl>\n                        <Input\n                          type=\"text\"\n                          placeholder=\"John\"\n                          data-testid=\"input-firstname\"\n                          {...field}\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"lastName\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Last Name</FormLabel>\n                      <FormControl>\n                        <Input\n                          type=\"text\"\n                          placeholder=\"Doe\"\n                          data-testid=\"input-lastname\"\n                          {...field}\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <FormField\n                control={form.control}\n                name=\"password\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Password</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"password\"\n                        placeholder=\"\"\n                        data-testid=\"input-password\"\n                        {...field}\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"confirmPassword\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Confirm Password</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"password\"\n                        placeholder=\"\"\n                        data-testid=\"input-confirm-password\"\n                        {...field}\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <div className=\"space-y-4\">\n                <Button\n                  type=\"submit\"\n                  className=\"w-full\"\n                  disabled={isLoading}\n                  data-testid=\"button-signup\"\n                >\n                  {isLoading ? \"Creating account...\" : \"Sign Up\"}\n                </Button>\n\n                <div className=\"text-center text-sm text-muted-foreground\">\n                  Already have an account?{\" \"}\n                  <button\n                    type=\"button\"\n                    className=\"text-primary underline-offset-4 hover:underline\"\n                    onClick={() => setLocation(\"/login\")}\n                    data-testid=\"link-login\"\n                  >\n                    Log in\n                  </button>\n                </div>\n              </div>\n            </form>\n          </Form>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":7051},"client/src/pages/Login.tsx":{"content":"import { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { z } from \"zod\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Input } from \"@/components/ui/input\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport type { LoginInput } from \"@shared/schema\";\n\nconst loginSchema = z.object({\n  email: z.string().email(\"Invalid email address\"),\n  password: z.string().min(1, \"Password is required\"),\n});\n\ntype LoginFormData = z.infer<typeof loginSchema>;\n\nexport default function Login() {\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const [isLoading, setIsLoading] = useState(false);\n\n  const form = useForm<LoginFormData>({\n    resolver: zodResolver(loginSchema),\n    defaultValues: {\n      email: \"\",\n      password: \"\",\n    },\n  });\n\n  const loginMutation = useMutation({\n    mutationFn: async (data: LoginInput) => {\n      const response = await apiRequest(\"POST\", \"/api/auth/login\", data);\n      return response.json();\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Welcome back!\",\n        description: \"You've been logged in successfully\",\n      });\n      setLocation(\"/\");\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Login failed\",\n        description: error.message || \"Invalid email or password\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: LoginFormData) => {\n    setIsLoading(true);\n    loginMutation.mutate(data, {\n      onSettled: () => setIsLoading(false),\n    });\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background flex items-center justify-center p-6\">\n      <Card className=\"w-full max-w-md\">\n        <CardHeader className=\"space-y-2\">\n          <CardTitle className=\"text-2xl\">Welcome back</CardTitle>\n          <CardDescription>\n            Sign in to your CostlyAgent account\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n              <FormField\n                control={form.control}\n                name=\"email\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Email</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"email\"\n                        placeholder=\"your@email.com\"\n                        data-testid=\"input-email\"\n                        {...field}\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"password\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Password</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"password\"\n                        placeholder=\"\"\n                        data-testid=\"input-password\"\n                        {...field}\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <div className=\"space-y-4\">\n                <Button\n                  type=\"submit\"\n                  className=\"w-full\"\n                  disabled={isLoading}\n                  data-testid=\"button-login\"\n                >\n                  {isLoading ? \"Signing in...\" : \"Log In\"}\n                </Button>\n\n                <div className=\"text-center text-sm text-muted-foreground\">\n                  Don't have an account?{\" \"}\n                  <button\n                    type=\"button\"\n                    className=\"text-primary underline-offset-4 hover:underline\"\n                    onClick={() => setLocation(\"/signup\")}\n                    data-testid=\"link-signup\"\n                  >\n                    Sign up\n                  </button>\n                </div>\n              </div>\n            </form>\n          </Form>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":4576},"client/src/components/CostForecast.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { TrendingUp, Calendar, DollarSign } from \"lucide-react\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\nimport type { CostForecast } from \"@shared/schema\";\n\ninterface CostForecastProps {\n  includeCredits: boolean;\n}\n\nexport default function CostForecast({ includeCredits }: CostForecastProps) {\n  const { data: forecast, isLoading, error } = useQuery<CostForecast>({\n    queryKey: [\"/api/costs/forecast\", { includeCredits }],\n    queryFn: async () => {\n      const response = await fetch(`/api/costs/forecast?includeCredits=${includeCredits}`, {\n        credentials: 'include'\n      });\n      if (!response.ok) {\n        const errorData = await response.json();\n        throw new Error(errorData.message || 'Failed to fetch cost forecast');\n      }\n      return response.json();\n    },\n  });\n\n  const formatCurrency = (cents: number) => {\n    return `$${(cents / 100).toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;\n  };\n\n  const formatDate = (dateString: string) => {\n    const date = new Date(dateString);\n    return date.toLocaleDateString('en-US', { month: 'short', year: 'numeric' });\n  };\n\n  if (error) {\n    return (\n      <Alert data-testid=\"alert-forecast-error\">\n        <AlertDescription>\n          {(error as Error).message}\n        </AlertDescription>\n      </Alert>\n    );\n  }\n\n  if (isLoading) {\n    return (\n      <Card data-testid=\"card-forecast\">\n        <CardHeader className=\"flex flex-row items-center justify-between gap-4 space-y-0 pb-4\">\n          <Skeleton className=\"h-6 w-48\" />\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <Skeleton className=\"h-20 w-full\" />\n          <Skeleton className=\"h-20 w-full\" />\n        </CardContent>\n      </Card>\n    );\n  }\n\n  if (!forecast) {\n    return null;\n  }\n\n  return (\n    <Card data-testid=\"card-forecast\">\n      <CardHeader className=\"flex flex-row items-center justify-between gap-4 space-y-0 pb-4\">\n        <CardTitle className=\"flex items-center gap-2\">\n          <TrendingUp className=\"h-5 w-5 text-primary\" />\n          Cost Forecast\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"space-y-6\">\n        {/* Next Month Forecast */}\n        <div className=\"space-y-2\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n              <Calendar className=\"h-4 w-4\" />\n              <span>Next Month ({formatDate(forecast.nextMonth.startDate)})</span>\n            </div>\n          </div>\n          <div className=\"flex items-baseline gap-2\">\n            <span className=\"text-3xl font-bold\" data-testid=\"text-forecast-next-month\">\n              {formatCurrency(forecast.nextMonth.amount)}\n            </span>\n            {forecast.nextMonth.confidence && (\n              <span className=\"text-sm text-muted-foreground\">\n                ({formatCurrency(forecast.nextMonth.confidence.lower)} - {formatCurrency(forecast.nextMonth.confidence.upper)})\n              </span>\n            )}\n          </div>\n          <p className=\"text-xs text-muted-foreground\">\n            Forecasted cost for next month with 80% confidence\n          </p>\n        </div>\n\n        {/* Next 3 Months Forecast */}\n        {forecast.next3Months && (\n          <div className=\"space-y-2\">\n            <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n              <Calendar className=\"h-4 w-4\" />\n              <span>Next 3 Months</span>\n            </div>\n            <div className=\"text-2xl font-semibold\" data-testid=\"text-forecast-next-3months\">\n              {formatCurrency(forecast.next3Months.amount)}\n            </div>\n            <p className=\"text-xs text-muted-foreground\">\n              Total forecasted cost for the next quarter\n            </p>\n          </div>\n        )}\n\n        {/* Year to Date */}\n        <div className=\"border-t pt-4 space-y-3\">\n          <div className=\"flex items-center gap-2 text-sm font-medium\">\n            <DollarSign className=\"h-4 w-4\" />\n            <span>Year to Date</span>\n          </div>\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div className=\"space-y-1\">\n              <p className=\"text-xs text-muted-foreground\">Actual Spend</p>\n              <p className=\"text-xl font-bold\" data-testid=\"text-ytd-actual\">\n                {formatCurrency(forecast.yearToDateActual)}\n              </p>\n            </div>\n            <div className=\"space-y-1\">\n              <p className=\"text-xs text-muted-foreground\">Projected Total</p>\n              <p className=\"text-xl font-bold\" data-testid=\"text-ytd-forecast\">\n                {formatCurrency(forecast.yearToDateForecast)}\n              </p>\n            </div>\n          </div>\n          <p className=\"text-xs text-muted-foreground\">\n            Forecasted total cost by end of year\n          </p>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n","size_bytes":5139}},"version":2}